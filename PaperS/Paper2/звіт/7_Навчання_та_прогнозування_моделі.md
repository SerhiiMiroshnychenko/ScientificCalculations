# 7. Навчання та прогнозування моделі

Процес навчання статистичної моделі прогнозування успішності замовлень та подальшого використання її для прогнозування є ключовим етапом, що трансформує статистичний аналіз у практично корисний інструмент підтримки прийняття рішень. Даний розділ детально описує методологію навчання моделі, алгоритм прогнозування та особливості їх реалізації у запропонованій системі.

### Навчання статистичної моделі

Навчання моделі у запропонованій системі суттєво відрізняється від традиційних підходів машинного навчання тим, що базується не на оптимізації параметрів за допомогою градієнтних методів чи інших алгоритмів оптимізації, а на статистичному аналізі відмінностей між групами успішних та неуспішних замовлень. Цей підхід дозволяє отримати повністю інтерпретовану модель, де кожен параметр має чітке статистичне обґрунтування.

Процес навчання моделі включає наступні етапи:

#### 1. Аналіз статистичної значущості факторів

На цьому етапі для кожної числової ознаки в навчальній вибірці проводиться аналіз її статистичної значущості для розрізнення успішних та неуспішних замовлень. Процес аналізу включає:

- Оцінку нормальності розподілу ознаки окремо для групи успішних та групи неуспішних замовлень
- Вибір відповідного статистичного тесту (параметричного чи непараметричного) на основі результатів оцінки нормальності
- Проведення статистичного тесту та оцінка статистичної значущості відмінностей між групами
- Обчислення розміру ефекту (d Коена для параметричних тестів або AUC для непараметричних)
- Визначення напрямку впливу ознаки на успішність замовлення

Формально, для кожної ознаки $f_i$ обчислюється p-значення $p_i$, що визначає статистичну значущість відмінностей, та розмір ефекту $e_i$ (d Коена або AUC), що визначає силу впливу. Ознака вважається статистично значущою, якщо $p_i \leq \alpha$, де $\alpha$ — встановлений рівень значущості (зазвичай 0.05).

#### 2. Визначення порогових значень

Для кожної статистично значущої ознаки визначається порогове значення, яке оптимально розділяє групи успішних та неуспішних замовлень. У параметричному випадку порогове значення обчислюється як середнє арифметичне середніх значень двох груп:

$$t_i = \frac{\mu_{1i} + \mu_{2i}}{2}$$

де $\mu_{1i}$ та $\mu_{2i}$ — середні значення ознаки $f_i$ у групі успішних та неуспішних замовлень відповідно.

У непараметричному випадку порогове значення визначається як середнє арифметичне медіан двох груп:

$$t_i = \frac{median_{1i} + median_{2i}}{2}$$

де $median_{1i}$ та $median_{2i}$ — медіани ознаки $f_i$ у групі успішних та неуспішних замовлень відповідно.

Такий підхід до визначення порогових значень є інтуїтивно зрозумілим та забезпечує хорошу роздільну здатність для факторів, де центральні тенденції груп відрізняються. Порогові значення разом із напрямком впливу формують правила прийняття рішень для кожної окремої ознаки.

#### 3. Розрахунок вагових коефіцієнтів

Для кожної статистично значущої ознаки обчислюється ваговий коефіцієнт, що відображає її відносну важливість у моделі. Методика розрахунку вагових коефіцієнтів детально описана у попередньому розділі та базується на нормалізації розміру ефекту з використанням гіперболічного тангенса для параметричних факторів та масштабування відхилення від 0.5 для непараметричних.

Вагові коефіцієнти забезпечують диференційований вплив різних факторів на кінцевий прогноз, пропорційний їхній статистичній значущості та розміру ефекту. Це підвищує точність та надійність прогнозування.

#### 4. Формування моделі

Кінцевим результатом процесу навчання є статистична модель, що представляє собою структуру даних, яка містить для кожного значущого фактора наступні параметри:
- Назва фактора
- Порогове значення
- Напрямок впливу (більші значення асоціюються з успішністю чи навпаки)
- Ваговий коефіцієнт
- Тип використаного статистичного тесту
- Розмір ефекту
- P-значення

Додатково модель включає метадані, такі як загальна кількість аналізованих факторів, кількість значущих факторів, дата та час навчання, тощо.

Таким чином, навчена модель є повністю інтерпретованою та містить усю інформацію, необхідну для прогнозування успішності нових замовлень та пояснення прийнятих рішень.

### Прогнозування з використанням статистичної моделі

Прогнозування успішності нових замовлень з використанням навченої моделі базується на принципі зваженого голосування значущих факторів. Цей підхід забезпечує не лише бінарну класифікацію (успішне/неуспішне), а й оцінку ймовірності успішності, що дозволяє ранжувати замовлення за потенційною успішністю.

Алгоритм прогнозування включає наступні кроки:

#### 1. Аналіз значень факторів

Для кожного спостереження (потенційного замовлення) та кожного значущого фактора у моделі проводиться порівняння значення фактора з відповідним пороговим значенням:

$$c_i = 
\begin{cases} 
1 & \text{якщо } (x[f_i] > t_i \text{ і } d_i = 1) \text{ або } (x[f_i] < t_i \text{ і } d_i = -1) \\
0 & \text{в іншому випадку}
\end{cases}$$

де $c_i$ — результат порівняння для i-го фактора, $x[f_i]$ — значення i-го фактора для спостереження x, $t_i$ — порогове значення i-го фактора, $d_i$ — напрямок впливу i-го фактора.

Результат порівняння $c_i$ можна інтерпретувати як "голос" i-го фактора за успішність (1) чи неуспішність (0) замовлення.

#### 2. Зважування голосів

Кожен голос зважується відповідним ваговим коефіцієнтом, що відображає статистичну значущість та силу впливу фактора:

$$v_i = c_i \times w_i$$

де $v_i$ — зважений голос i-го фактора, $c_i$ — результат порівняння для i-го фактора, $w_i$ — ваговий коефіцієнт i-го фактора.

#### 3. Агрегація та нормалізація

Зважені голоси всіх факторів сумуються та нормалізуються для отримання оцінки ймовірності успішності замовлення:

$$p = \frac{\sum_{i=1}^{n} v_i}{\sum_{i=1}^{n} w_i}$$

де $p$ — оцінка ймовірності успішності замовлення, $n$ — кількість значущих факторів у моделі.

Нормалізація забезпечує, що отримана оцінка лежить у діапазоні від 0 до 1, де 0 відповідає повній впевненості у неуспішності, а 1 — повній впевненості в успішності замовлення. Значення близько 0.5 свідчать про невизначеність прогнозу.

#### 4. Бінарна класифікація

Для отримання бінарного прогнозу оцінка ймовірності порівнюється з пороговим значенням (зазвичай 0.5):

$$y_{pred} = 
\begin{cases} 
1 & \text{якщо } p \geq 0.5 \\
0 & \text{якщо } p < 0.5
\end{cases}$$

де $y_{pred}$ — бінарний прогноз успішності замовлення (1 — успішне, 0 — неуспішне).

Поріг класифікації може бути адаптований залежно від вартості помилок різного типу. Наприклад, якщо вартість хибнопозитивного прогнозу (False Positive) вища за вартість хибнонегативного (False Negative), поріг може бути збільшений для зниження кількості хибнопозитивних прогнозів.

### Переваги запропонованого підходу до навчання та прогнозування

Запропонований підхід до навчання статистичної моделі та використання її для прогнозування має ряд суттєвих переваг порівняно з традиційними методами машинного навчання:

1. **Повна інтерпретованість**: Кожен параметр моделі має чітке статистичне обґрунтування, а результат прогнозування можна пояснити через внесок кожного фактора.

2. **Відсутність перенавчання**: Модель базується на статистичних закономірностях, а не на оптимізації параметрів під навчальну вибірку, що знижує ризик перенавчання.

3. **Ефективність на малих вибірках**: Статистичні тести зберігають надійність навіть на відносно малих вибірках, де традиційні методи машинного навчання можуть бути ненадійними.

4. **Адаптивність до характеру даних**: Автоматичний вибір параметричних чи непараметричних методів забезпечує адаптацію до характеристик розподілу кожного фактора.

5. **Робастність до викидів**: Особливо у випадку використання непараметричних методів, модель є стійкою до наявності викидів та аномальних спостережень у даних.

6. **Можливість оновлення**: Модель можна легко оновлювати при надходженні нових даних, пересобираючи статистику для кожного фактора.

7. **Низькі обчислювальні вимоги**: Як навчання, так і прогнозування вимагають мінімальних обчислювальних ресурсів порівняно з методами глибокого навчання чи ансамблевими методами.

Зазначені переваги роблять запропонований підхід особливо цінним для практичних бізнес-застосувань, де важливими є не лише точність прогнозів, а й їх інтерпретованість, надійність та можливість пояснити прийняті рішення.
