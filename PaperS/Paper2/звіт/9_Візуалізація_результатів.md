# 9. Візуалізація результатів моделювання

Візуальне представлення результатів прогнозування відіграє важливу роль у розумінні характеристик моделі, інтерпретації її поведінки та комунікації отриманих результатів. Ефективна візуалізація допомагає виявити закономірності та патерни у даних, оцінити якість моделі, обґрунтувати прийняті рішення та представити результати у формі, доступній для розуміння широким колом зацікавлених осіб, включаючи осіб, що приймають рішення, але не мають спеціальних статистичних знань. У даному розділі розглядаються методи візуалізації, що використовуються у запропонованій системі прогнозування успішності замовлень, їхні особливості та інформаційна цінність.

### ROC-крива та AUC

Одним із ключових інструментів візуалізації якості бінарного класифікатора є ROC-крива (Receiver Operating Characteristic curve), яка відображає залежність між часткою правильно класифікованих позитивних випадків (True Positive Rate, TPR) та часткою неправильно класифікованих негативних випадків (False Positive Rate, FPR) при різних порогових значеннях класифікації.

Математично ROC-крива визначається як параметрична крива у просторі $(FPR, TPR)$:

$$ROC = \{(FPR(t), TPR(t)), t \in (-\infty, \infty)\}$$

де $t$ — порогове значення класифікації, а $FPR(t)$ та $TPR(t)$ — значення FPR та TPR, відповідні цьому порогу:

$$TPR(t) = \frac{\sum_{i=1}^{n} \mathbf{1}\{y_i = 1 \land s_i > t\}}{\sum_{i=1}^{n} \mathbf{1}\{y_i = 1\}}$$

$$FPR(t) = \frac{\sum_{i=1}^{n} \mathbf{1}\{y_i = 0 \land s_i > t\}}{\sum_{i=1}^{n} \mathbf{1}\{y_i = 0\}}$$

де $y_i$ — фактичний клас $i$-го спостереження, $s_i$ — прогнозована ймовірність належності до позитивного класу, а $\mathbf{1}\{\cdot\}$ — індикаторна функція.

На ROC-кривій також відображається діагональна лінія $TPR = FPR$, що відповідає випадковому класифікатору. Чим вище розташована ROC-крива над цією діагоналлю, тим краща якість класифікатора. Площа під ROC-кривою (AUC) є агрегованою мірою якості класифікатора, що не залежить від конкретного порогу класифікації.

Візуалізація ROC-кривої дозволяє:
- Оцінити загальну якість моделі (шляхом порівняння з діагональною лінією випадкового вгадування)
- Визначити оптимальний поріг класифікації (зазвичай відповідає точці на кривій, що є найближчою до точки (0, 1))
- Порівняти різні моделі між собою
- Оцінити компроміс між чутливістю (TPR) та специфічністю (1 - FPR) при різних порогах

У запропонованій системі ROC-крива візуалізується з використанням бібліотеки matplotlib, з додаванням інформації про значення AUC безпосередньо на графіку для зручності інтерпретації.

### Матриця помилок

Матриця помилок (confusion matrix) є важливим інструментом для оцінки якості класифікатора, що відображає співвідношення між фактичними та прогнозованими класами. Для бінарної класифікації матриця помилок представляється у вигляді таблиці 2×2, де рядки відповідають фактичним класам, а стовпці — прогнозованим.

Для підвищення наочності матриця помилок візуалізується у вигляді теплокарти (heatmap), де кожна комірка забарвлюється відповідно до кількості спостережень, що потрапили у відповідну категорію. Додатково на кожній комірці відображається як абсолютне число спостережень, так і відсоток від загальної кількості спостережень.

Така візуалізація дозволяє швидко оцінити:
- Загальну точність моделі (частка спостережень на головній діагоналі)
- Баланс між помилками першого та другого роду
- Специфіку помилок моделі (чи є систематичний зсув у бік певного класу)

У запропонованій системі для візуалізації матриці помилок використовується бібліотека seaborn, із застосуванням кольорової схеми, де темніші відтінки відповідають більшій кількості спостережень.

### Гістограма розподілу прогнозованих ймовірностей

Гістограма розподілу прогнозованих ймовірностей є потужним інструментом для аналізу характеристик моделі та її здатності розрізняти класи. На цій візуалізації відображається частота різних значень прогнозованої ймовірності успішності замовлення, окремо для фактично успішних та фактично неуспішних замовлень.

Математично гістограма розподілу ймовірностей представляє собою набір інтервалів (бінів) з відображенням кількості спостережень, що потрапили у кожний інтервал:

$$h_j = \sum_{i=1}^{n} \mathbf{1}\{y_i = j \land b_k \leq s_i < b_{k+1}\}$$

де $h_j$ — кількість спостережень класу $j$ у $k$-му біні, $y_i$ — фактичний клас $i$-го спостереження, $s_i$ — прогнозована ймовірність, а $b_k$ та $b_{k+1}$ — нижня та верхня межі $k$-го біну відповідно.

Аналіз гістограми розподілу ймовірностей дозволяє:
- Оцінити роздільну здатність моделі (чим менше перекриття між розподілами, тим краща роздільна здатність)
- Виявити проблемні області (діапазони ймовірностей, де модель має низьку роздільну здатність)
- Оцінити калібрування моделі (наскільки добре прогнозовані ймовірності відповідають фактичним частотам класів)
- Визначити оптимальний поріг класифікації (зазвичай відповідає точці перетину двох розподілів)

У запропонованій системі гістограми розподілу прогнозованих ймовірностей будуються з використанням бібліотеки matplotlib, з відображенням окремо розподілів для успішних та неуспішних замовлень, із застосуванням напівпрозорого заповнення для кращої візуалізації перекриття та вертикальної лінії, що позначає поріг класифікації.

### Візуалізація важливості факторів

Важливою перевагою запропонованої статистичної моделі є її повна інтерпретованість, що підкріплюється візуалізацією важливості факторів, включених до моделі. Ця візуалізація представляється у вигляді горизонтальної стовпчикової діаграми, де кожен стовпчик відповідає певному фактору, а його довжина — важливості (ваговому коефіцієнту) цього фактора у моделі.

Фактори на діаграмі впорядковуються за важливістю (від найбільш до найменш важливих), що дозволяє швидко ідентифікувати ключові фактори, що мають найбільший вплив на прогнозування успішності замовлень.

Додатково на діаграмі може відображатися інформація про тип статистичного тесту, використаного для кожного фактора (параметричний чи непараметричний), та напрямок впливу (чи асоціюються більші значення фактора з успішністю чи з неуспішністю замовлень).

Така візуалізація дозволяє:
- Ідентифікувати ключові фактори, що визначають успішність замовлень
- Зрозуміти відносну важливість різних факторів
- Виявити патерни та закономірності у впливі факторів
- Обґрунтувати прийняті рішення на основі статистично значущих факторів

У запропонованій системі візуалізація важливості факторів реалізована з використанням бібліотеки matplotlib, із застосуванням кольорового кодування для відображення типу тесту та напрямку впливу.

### Інтеграція візуалізацій у процес аналізу

Усі розглянуті вище візуалізації інтегруються у єдину систему аналізу та прогнозування успішності замовлень. Результати візуалізації зберігаються у вигляді графічних файлів, які можуть бути включені у звіти, презентації та інші матеріали для комунікації результатів аналізу.

Важливою особливістю системи є автоматичне створення візуалізацій у процесі аналізу, що не вимагає додаткових зусиль від користувача. Система також забезпечує можливість налаштування параметрів візуалізації (кольорових схем, розмірів графіків, тощо) відповідно до потреб конкретної задачі.

Запропонований комплексний підхід до візуалізації результатів моделювання забезпечує всебічне розуміння характеристик моделі, її поведінки та прогностичних здатностей, що є критично важливим для обґрунтування прийнятих рішень та комунікації результатів аналізу широкому колу зацікавлених осіб.
