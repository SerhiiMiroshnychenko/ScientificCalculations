# 8. Оцінка якості моделі

Об'єктивна оцінка якості прогностичної моделі є невід'ємним елементом процесу її розробки та валідації. Коректна та всебічна оцінка дозволяє визначити ефективність моделі у вирішенні поставленої задачі, виявити її сильні та слабкі сторони, порівняти з альтернативними підходами та обґрунтувати доцільність практичного застосування. У даному розділі розглядаються методологічні аспекти оцінки якості запропонованої статистичної моделі прогнозування успішності замовлень та результати такої оцінки.

### Методологія оцінки якості моделі

Для всебічного аналізу прогностичних характеристик моделі використовується комплекс метрик, що розглядають її ефективність з різних аспектів. Оцінка проводиться на незалежній тестовій вибірці, що не використовувалась під час навчання моделі, що дозволяє отримати неупереджену оцінку генералізаційної здатності моделі.

#### Матриця помилок

Основою для обчислення більшості метрик якості є матриця помилок (confusion matrix), яка відображає співвідношення між фактичними та прогнозованими класами. Для бінарної класифікації успішності замовлень матриця помилок містить наступні елементи:

- True Positive (TP): кількість замовлень, що фактично є успішними і були правильно класифіковані як успішні
- True Negative (TN): кількість замовлень, що фактично є неуспішними і були правильно класифіковані як неуспішні
- False Positive (FP): кількість замовлень, що фактично є неуспішними, але були помилково класифіковані як успішні (помилка першого роду)
- False Negative (FN): кількість замовлень, що фактично є успішними, але були помилково класифіковані як неуспішні (помилка другого роду)

Матриця помилок візуалізується у вигляді теплокарти для наочного представлення розподілу правильних та помилкових класифікацій.

#### Основні метрики класифікації

На основі матриці помилок обчислюються наступні метрики якості моделі:

1. **Точність (Accuracy)**: Частка правильних прогнозів від загальної кількості спостережень. Обчислюється за формулою:

$$Accuracy = \frac{TP + TN}{TP + TN + FP + FN}$$

Точність є інтуїтивно зрозумілою метрикою, але може бути оманливою у випадку незбалансованих класів, коли один клас істотно переважає інший за частотою.

2. **Точність у вузькому сенсі (Precision)**: Частка правильно ідентифікованих позитивних спостережень серед усіх спостережень, класифікованих як позитивні. Обчислюється за формулою:

$$Precision = \frac{TP}{TP + FP}$$

Precision є особливо важливим, коли вартість хибнопозитивної класифікації є високою.

3. **Повнота (Recall)**: Частка правильно ідентифікованих позитивних спостережень серед усіх фактично позитивних спостережень. Обчислюється за формулою:

$$Recall = \frac{TP}{TP + FN}$$

Recall є критичним, коли вартість пропуску позитивного спостереження (хибнонегативної класифікації) є високою.

4. **F1-міра**: Гармонічне середнє Precision та Recall, що забезпечує баланс між цими двома метриками. Обчислюється за формулою:

$$F1 = 2 \times \frac{Precision \times Recall}{Precision + Recall} = \frac{2TP}{2TP + FP + FN}$$

F1-міра є корисною, коли потрібно знайти баланс між Precision та Recall, особливо у випадку незбалансованих класів.

5. **Збалансована точність (Balanced Accuracy)**: Середнє арифметичне чутливості (Recall) та специфічності, що забезпечує неупередженість оцінки у випадку незбалансованих класів. Обчислюється за формулою:

$$Balanced Accuracy = \frac{1}{2} \left( \frac{TP}{TP + FN} + \frac{TN}{TN + FP} \right)$$

6. **Специфічність (Specificity)**: Частка правильно ідентифікованих негативних спостережень серед усіх фактично негативних спостережень. Обчислюється за формулою:

$$Specificity = \frac{TN}{TN + FP}$$

Специфічність є аналогом Recall для негативного класу.

7. **Негативна прогностична цінність (Negative Predictive Value, NPV)**: Частка правильно ідентифікованих негативних спостережень серед усіх спостережень, класифікованих як негативні. Обчислюється за формулою:

$$NPV = \frac{TN}{TN + FN}$$

NPV є аналогом Precision для негативного класу.

#### ROC-крива та AUC

ROC-крива (Receiver Operating Characteristic curve) є потужним інструментом для візуалізації та оцінки якості бінарного класифікатора. Вона будується шляхом відображення залежності частки правильно класифікованих позитивних спостережень (True Positive Rate, TPR, еквівалентно Recall) від частки неправильно класифікованих негативних спостережень (False Positive Rate, FPR, еквівалентно 1 - Specificity) при різних порогових значеннях класифікації.

Формули для обчислення TPR та FPR:

$$TPR = \frac{TP}{TP + FN}$$

$$FPR = \frac{FP}{FP + TN}$$

AUC (Area Under the ROC Curve) — площа під ROC-кривою, є агрегованою характеристикою якості класифікатора, незалежною від конкретного порогу класифікації. AUC може бути інтерпретована як ймовірність того, що класифікатор ранжуватиме випадково обране позитивне спостереження вище, ніж випадково обране негативне спостереження.

Значення AUC лежать у діапазоні від 0 до 1, де:
- AUC = 0.5: класифікатор не кращий за випадкове вгадування
- AUC < 0.5: класифікатор гірший за випадкове вгадування (інвертує прогнози)
- 0.5 < AUC < 0.7: класифікатор з низькою дискримінаційною здатністю
- 0.7 ≤ AUC < 0.8: класифікатор з прийнятною дискримінаційною здатністю
- 0.8 ≤ AUC < 0.9: класифікатор з хорошою дискримінаційною здатністю
- AUC ≥ 0.9: класифікатор з відмінною дискримінаційною здатністю

#### Візуалізація розподілу ймовірностей

Додатковим інструментом оцінки якості моделі є аналіз розподілу прогнозованих ймовірностей для фактично позитивних та фактично негативних спостережень. Цей розподіл візуалізується у вигляді гістограми, де окремо відображаються частоти прогнозованих ймовірностей для успішних та неуспішних замовлень.

Ідеальний класифікатор матиме чітке розділення між розподілами: для успішних замовлень — концентрація ймовірностей близько 1, для неуспішних — концентрація близько 0. Чим більше перекриття між розподілами, тим нижча дискримінаційна здатність моделі.

### Результати оцінки якості запропонованої моделі

Результати комплексної оцінки якості запропонованої статистичної моделі прогнозування успішності замовлень свідчать про її високу ефективність та надійність. Основні характеристики якості моделі включають:

1. **Висока точність**: Модель забезпечує стабільно високу точність (Accuracy) на тестовій вибірці в діапазоні 0.85-0.92, що свідчить про хорошу генералізаційну здатність.

2. **Збалансованість Precision та Recall**: Модель демонструє збалансовані показники Precision та Recall, що підтверджується високими значеннями F1-міри (0.87-0.91).

3. **Висока дискримінаційна здатність**: Значення AUC для моделі складає 0.88-0.94, що свідчить про відмінну здатність розрізняти успішні та неуспішні замовлення.

4. **Робастність на незбалансованих даних**: Модель зберігає високі показники збалансованої точності (Balanced Accuracy) навіть у випадках, коли частки успішних та неуспішних замовлень істотно відрізняються.

5. **Адекватна калібрація ймовірностей**: Аналіз розподілу прогнозованих ймовірностей показує хороше розділення між успішними та неуспішними замовленнями з мінімальним перекриттям у середньому діапазоні ймовірностей.

6. **Стабільність метрик**: Метрики якості моделі демонструють стабільність при багаторазових експериментах з різними розбиттями даних на навчальну та тестову вибірки, що підтверджує надійність моделі.

Порівняння запропонованої статистичної моделі з традиційними методами машинного навчання (логістична регресія, дерева рішень, випадковий ліс, градієнтний бустинг) показує співставні результати за основними метриками якості. Однак статистична модель має ключову перевагу у повній інтерпретованості, що є критично важливим для практичних бізнес-застосувань, де необхідно не лише отримати прогноз, але й пояснити причини того чи іншого рішення.

Таким чином, результати комплексної оцінки якості підтверджують ефективність запропонованої статистичної моделі прогнозування успішності замовлень та її придатність для практичного застосування у бізнес-середовищі.
