@startuml
title Принципова схема (врахування розміру вибірки у тестах нормальності)

start
:Дані з ціллю is_successful ∈ {0,1};

while (є ще числова ознака?) is (так)
  :Взяти ознаку X;

  partition "Оцінка нормальності (окремо для груп 0 і 1)" {
    :Обчислити n_g для кожної групи;

    if (Тест Шапіро–Вілка) then (правила)
      if (n_g > 5000?) then (так)
        :Використати випадкову підвибірку\nрозміру 5000;
      else (ні)
        :Використати всі спостереження;
      endif
      :Запустити Shapiro–Wilk;
    endif

    if (Тест Д’Агостіно–Пірсона) then (умова n)
      if (n_g ≥ 20?) then (так)
        :Запустити normaltest (D’Agostino–Pearson);
      else (ні)
        :Пропустити тест (замало спостережень);
      endif
    endif

    :Запустити Андерсон–Дарлінг (без обмеження n);
    :Агрегувати висновок: «нормальний»,\nякщо ≥ 2 тести підтвердили;
  }

  if (Обидві групи ~ нормальні?) then (так)
    :ПАРАМЕТРИЧНО:\nWelch t-test;\nРозмір ефекту: Cohen's d;
  else (ні)
    :НЕПАРАМЕТРИЧНО:\nMann–Whitney U;\nРозмір ефекту: AUC;
  endif

  :Оцінити p-значення (α=0.05);
  if (Ознака значуща?) then (так)
    :Визначити напрямок впливу (↑/↓ → успіх);
    :Встановити поріг між центрами груп\n(середні або медіани);
    :Перетворити розмір ефекту → вагу (нормалізувати);
    :Додати правило (ознака, поріг, напрямок, вага)\nдо моделі;
  else (ні)
    :Пропустити ознаку;
  endif
endwhile (ні)

:Сформована модель = набір правил із вагами;
:Для кожного об'єкта обчислити зважений скор [0..1]\nта порівняти з класифікаційним порогом;

stop
@enduml