# МЕТОДИ

## Методика статистичного прогнозування на основі порівняльних тестів

У рамках дослідження розроблено комплексну методику статистичного прогнозування з автоматичним вибором методів аналізу та розрахунком статистичної значущості факторів для максимальної адаптації моделі до характеристик вхідних даних.

### Підготовка та попередня обробка даних

Процес підготовки даних включає завантаження з CSV-формату, перевірку на пропущені значення, їх обробку та нормалізацію від'ємних числових значень шляхом заміни нулями. Особлива увага приділяється обробці викидів, що можуть значно викривити статистичні оцінки та знизити якість моделі. Методика передбачає три підходи до виявлення викидів: метод міжквартильного розмаху, метод Z-оцінки та персентильний метод. Для виявлення викидів за замовчуванням використовується метод міжквартильного розмаху (IQR), при якому значення, що виходять за межі [Q1-1.5×IQR; Q3+1.5×IQR], де Q1 та Q3 - перший та третій квартилі розподілу, а IQR = Q3-Q1, вважаються викидами. Для обробки виявлених викидів у системі імплементовано три методи: обмеження значень на рівні граничних порогів, заміна медіанними значеннями та видалення спостережень з викидами. При цьому за замовчуванням застосовується метод обмеження значень (cap), коли значення викидів замінюються на граничні порогові значення, що зберігає кількість спостережень, але зменшує вплив екстремальних даних на статистичні розрахунки.

### Оцінка нормальності розподілу та вибір статистичних тестів

Важливим етапом аналізу є автоматичне визначення типу розподілу даних для вибору оптимальних статистичних тестів. Методика передбачає комплексну оцінку нормальності розподілу для кожної числової змінної з використанням тестів Шапіро-Уілка та Д'Агостіно-Пірсона. На основі результатів тестування приймається рішення про використання параметричних методів (t-тест Стьюдента) для нормально розподілених даних або непараметричних методів (U-тест Манна-Уітні) для даних, що відхиляються від нормального розподілу.

### Оцінка статистичної значущості ознак та розрахунок їх ваг

Для кожної ознаки проводиться оцінка її статистичної значущості для розмежування груп за цільовою змінною. Разом із p-значенням розраховується розмір ефекту (d Коена для параметричних тестів та AUC для непараметричних тестів), який відображає практичну значущість виявлених відмінностей. На основі розміру ефекту розраховується вага кожної ознаки за нелінійною функцією, що посилює вплив ознак з високим розміром ефекту та знижує вплив ознак з незначним ефектом.

### Прогнозування та формування ймовірнісних оцінок

Основним результатом роботи моделі є прогнозована ймовірність належності спостереження до цільової групи. Розрахунок ймовірності базується на зваженому усередненні значень ознак із урахуванням їхньої статистичної значущості та напрямку впливу. Математично це представлено формулою:

$$P(success) = \frac{1}{1 + e^{-z}}$$

де $z$ обчислюється як:

$$z = \sum_{i=1}^{n} w_i \cdot \text{sign}_i \cdot \frac{x_i - \mu_{0i}}{\sigma_{0i}}$$

У цій формулі $w_i$ - вага i-тої ознаки, розрахована на основі розміру ефекту; $\text{sign}_i$ - напрямок впливу ознаки (+1, якщо більше значення ознаки асоціюється з цільовою групою, -1 в протилежному випадку); $x_i$ - значення i-тої ознаки для прогнозованого спостереження; $\mu_{0i}$ - середнє значення i-тої ознаки для контрольної групи; $\sigma_{0i}$ - стандартне відхилення i-тої ознаки для контрольної групи. Функція сигмоїди трансформує зважену суму в ймовірність у діапазоні від 0 до 1.

### Оцінка якості моделі

Для валідації моделі використовується комплекс метрик: точність (accuracy), precision, recall (чутливість), F1-score та ROC AUC. Додатково проводиться аналіз важливості ознак для інтерпретації роботи моделі та виявлення ключових факторів, що впливають на цільову змінну. Запропонована методика статистичного прогнозування забезпечує автоматичний вибір оптимальних статистичних тестів відповідно до характеристик даних, комбінування різних підходів до виявлення значущих факторів, формування інтерпретованої прогностичної моделі з прозорим механізмом прийняття рішень та можливість оцінити внесок кожної ознаки у формування прогнозу.
