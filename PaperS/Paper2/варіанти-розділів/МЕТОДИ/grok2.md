### Методи

У даному дослідженні розроблено статистичну модель для прогнозування успішності замовлень на основі порівняльних статистичних тестів, що автоматично обирає методи аналізу та визначає статистичну значущість факторів, які впливають на результат. Методологія охоплює кілька етапів: завантаження та підготовку даних, обробку викидів, розподіл даних на тренувальну та тестову вибірки, оцінку нормальності розподілу даних, вибір відповідного статистичного тесту для аналізу значущості ознак, навчання моделі, прогнозування та оцінку її ефективності.

Дані завантажуються з CSV-файлу, де цільова змінна `is_successful` перетворюється на бінарні значення (0 для неуспішних і 1 для успішних замовлень). Числові колонки ідентифікуються автоматично, від’ємні значення замінюються нулями, а пропущені значення фіксуються без подальшої обробки на цьому етапі. Для обробки викидів застосовується метод міжквартильного розмаху (IQR), де значення, що виходять за межі діапазону $[Q1 - 1.5 \times \text{IQR}, Q3 + 1.5 \times \text{IQR}]$, обмежуються граничними значеннями цього діапазону, причому $Q1$ і $Q3$ є першим і третім квартилями, а $\text{IQR} = Q3 - Q1$. Дані розподіляються на тренувальну та тестову вибірки у співвідношенні 70:30 із застосуванням стратифікованого розбиття для збереження пропорцій цільової змінної.

Оцінка нормальності розподілу проводиться для кожної числової ознаки окремо в групах успішних і неуспішних замовлень за допомогою трьох тестів: Шапіро-Вілка, Д’Агостіно-Пірсона та Андерсона-Дарлінга. Ознака вважається нормально розподіленою, якщо принаймні два тести підтверджують нормальність із p-значенням більше 0.05. На основі результатів оцінки нормальності обирається статистичний тест для аналізу значущості ознак. Для нормально розподілених даних застосовується параметричний t-тест із корекцією Уелча, а розмір ефекту обчислюється за Cohen’s d. У разі ненормального розподілу використовується непараметричний тест Манна-Уітні, де розмір ефекту оцінюється через площу під ROC-кривою (AUC).

Навчання моделі базується на визначенні статистично значущих ознак (p-значення ≤ 0.05). Для кожної такої ознаки розраховується порогове значення як середнє арифметичне між середніми (або медіанами) груп успішних і неуспішних замовлень (Якщо розподіл нормальний для обох груп, використовуються середні значення. Якщо ж розподіл хоча б для однієї з груп не є нормальним, використовуються медіани), визначається напрямок впливу (чи більші значення асоціюються з успішністю) та обчислюється вага ознаки. Вага для параметричного тесту визначається як $w = 0.5 + 0.5 \times \tanh\left(\frac{\text{Cohen’s d}}{2}\right)$, а для непараметричного — як $w = 2 \times |\text{AUC} - 0.5|$, якщо $\text{AUC} \geq 0.5$, інакше 0. Прогнозування здійснюється шляхом обчислення "голосу" кожної значущої ознаки для спостереження: голос дорівнює вазі ознаки, якщо значення перевищує (або не перевищує) поріг залежно від напрямку впливу, інакше 0. Сумарний голос нормалізується до ймовірності успішності, а прогнозований клас визначається як 1, якщо ймовірність перевищує 0.5, інакше 0.

Ефективність моделі оцінюється за низкою метрик, включаючи точність, збалансовану точність, precision, recall, специфічність, F1-міру, ROC AUC та негативне предиктивне значення, з подальшим аналізом матриці помилок.

Прогнозована ймовірність успішності обчислюється за наступною формулою. Нехай $\mathcal{F}$ — множина значущих ознак, $w_f$ — вага ознаки $f \in \mathcal{F}$, $\theta_f$ — порогове значення для ознаки $f$, $d_f$ — напрямок впливу (1, якщо більші значення асоціюються з успішністю, -1 інакше), $x_f$ — значення ознаки $f$ для спостереження. Тоді голос для ознаки $f$ визначається як:

$$
v_f = 
\begin{cases}
w_f, & \text{якщо } (x_f > \theta_f \text{ і } d_f = 1) \text{ або } (x_f < \theta_f \text{ і } d_f = -1), \\
0, & \text{інакше},
\end{cases}
$$

сумарний голос:

$$
V = \sum_{f \in \mathcal{F}} v_f,
$$

максимально можливий голос:

$$
V_{\text{max}} = \sum_{f \in \mathcal{F}} w_f,
$$

а прогнозована ймовірність:

$$
p = \frac{V}{V_{\text{max}}}.
$$

Ця методологія забезпечує структурований підхід до аналізу даних і прогнозування, що дозволяє ідентифікувати ключові фактори успішності замовлень із високою статистичною достовірністю.