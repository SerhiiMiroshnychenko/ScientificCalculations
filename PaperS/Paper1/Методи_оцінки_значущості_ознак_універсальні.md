# Методи оцінки значущості ознак для прогнозування успішності замовлень у B2B-сегменті

## Вступ

Дослідження значущості ознак є критично важливим етапом аналізу даних та розробки прогностичних моделей. У контексті аналізу B2B-замовлень, де бінарна цільова змінна вказує на успішність чи неуспішність транзакції, правильний вибір методів оцінки значущості ознак має суттєвий вплив на якість та інтерпретованість кінцевої моделі. Даний документ представляє науковий аналіз п'яти обраних методів оцінки значущості ознак, які найкраще відповідають специфіці наявного набору даних.

Набір даних дослідження включає 86794 замовлень від 7849 клієнтів у B2B-сегменті за період близько 9 років. З цих замовлень 32031 класифіковані як неуспішні та 54763 як успішні. Важливою особливістю даного дослідження є необхідність оцінки значущості як для числових, так і для категоріальних ознак після їх відповідного кодування. Обрані методи дозволяють провести комплексний аналіз з різних аспектів: від одновимірного статистичного аналізу до складних моделей машинного навчання, що враховують взаємодію між ознаками.

## AUC (Area Under the Curve)

Метод AUC ґрунтується на оцінці площі під ROC-кривою (Receiver Operating Characteristic). В контексті оцінки значущості ознак, AUC застосовується як міра здатності окремої ознаки розділяти позитивні та негативні класи (успішні та неуспішні замовлення). Математично AUC можна представити як імовірність того, що випадково обране спостереження з позитивного класу отримає вищий прогнозований ранг, ніж випадково обране спостереження з негативного класу.

Формально для бінарної цільової змінної та однієї ознаки X, AUC розраховується як:

```
AUC = P(X_i > X_j | y_i = 1, y_j = 0)
```

де X_i та X_j – значення ознаки для спостережень i та j, y_i та y_j – відповідні значення цільової змінної.

Обґрунтування вибору: AUC обраний як метод оцінки значущості через його здатність ефективно працювати з бінарними цільовими змінними, нечутливість до масштабу ознак та здатність оцінювати монотонний зв'язок між ознакою та цільовою змінною. Перевага методу полягає в тому, що він не потребує припущень про розподіл даних та ефективно працює як з числовими, так і з категоріальними ознаками після кодування. У контексті даного дослідження AUC дозволяє виявити ознаки, які найкраще розділяють успішні та неуспішні замовлення без врахування складних взаємодій між ознаками.

## Mutual Information (Взаємна інформація)

Взаємна інформація є метрикою з теорії інформації, яка вимірює кількість інформації, отриманої про одну випадкову змінну шляхом спостереження за іншою випадковою змінною. У контексті оцінки значущості ознак, взаємна інформація вимірює, наскільки знання значення ознаки зменшує невизначеність щодо значення цільової змінної.

Для дискретних випадкових змінних X (ознака) та Y (цільова змінна) взаємна інформація визначається як:

```
MI(X;Y) = ∑∑ p(x,y) * log(p(x,y) / (p(x) * p(y)))
```

де p(x,y) – спільна ймовірність X та Y, p(x) та p(y) – маргінальні ймовірності.

Для неперервних змінних використовується аналогічне визначення з інтегралами замість сум. На практиці часто застосовують методи дискретизації або оцінки густини для обчислення взаємної інформації для неперервних змінних.

Обґрунтування вибору: Взаємна інформація є потужним методом оцінки значущості ознак, оскільки здатна виявляти як лінійні, так і нелінійні залежності між ознаками та цільовою змінною. На відміну від кореляційних методів, взаємна інформація може виявляти складні статистичні залежності. Цей метод обрано через його універсальність – він однаково ефективно працює з числовими та категоріальними ознаками, що відповідає вимогам даного дослідження. У контексті аналізу B2B-замовлень взаємна інформація дозволяє виявити неочевидні зв'язки між характеристиками замовлень та їх успішністю, які могли б бути пропущені при використанні методів, орієнтованих лише на лінійні залежності.

## Distance Correlation (Кореляція відстаней)

Кореляція відстаней є мірою залежності між випадковими векторами. Вона була розроблена для подолання обмежень коефіцієнта кореляції Пірсона, який виявляє лише лінійні залежності. Ключовою особливістю кореляції відстаней є те, що вона дорівнює нулю тоді і тільки тоді, коли змінні статистично незалежні.

Для обчислення кореляції відстаней спочатку визначаються матриці попарних відстаней для змінних X та Y, а потім обчислюються відцентровані ("double-centered") матриці відстаней. Кореляція відстаней визначається як:

```
dCor(X,Y) = √(dCov(X,Y) / √(dVar(X) * dVar(Y)))
```

де dCov – коваріація відстаней, dVar – дисперсія відстаней.

Обґрунтування вибору: Кореляція відстаней обрана як метод оцінки значущості ознак через її здатність виявляти широкий спектр статистичних залежностей, включаючи нелінійні, без специфічних припущень про форму цих залежностей. Цей метод особливо цінний для аналізу складних бізнес-даних, де взаємозв'язки між ознаками та цільовою змінною можуть бути нетривіальними. Перевага кореляції відстаней полягає в тому, що вона забезпечує статистично обґрунтований тест на незалежність, який працює з різними типами даних. У контексті даного дослідження кореляція відстаней дозволяє виявити ознаки, які мають будь-який тип статистичного зв'язку з успішністю замовлень, доповнюючи інші методи, які можуть пропустити певні типи залежностей.

## Логістична регресія

Логістична регресія є статистичною моделлю, яка використовується для прогнозування ймовірності бінарної події за допомогою логістичної функції. У контексті оцінки значущості ознак, коефіцієнти логістичної регресії та їх статистична значущість використовуються для визначення впливу ознак на цільову змінну.

Модель логістичної регресії визначається як:

```
log(p/(1-p)) = β₀ + β₁X₁ + β₂X₂ + ... + βₙXₙ
```

де p – ймовірність позитивного результату, βᵢ – коефіцієнти, Xᵢ – ознаки.

Для оцінки значущості ознак використовуються:
- Абсолютні значення коефіцієнтів (для стандартизованих даних)
- Відношення шансів (odds ratio): exp(βᵢ)
- p-значення коефіцієнтів
- Зміна в якості моделі при видаленні ознаки

Обґрунтування вибору: Логістична регресія є природним вибором для оцінки значущості ознак у задачах бінарної класифікації. На відміну від лінійної регресії, логістична регресія безпосередньо моделює ймовірності бінарних результатів, що робить її більш відповідною для аналізу успішності замовлень. Цей метод дозволяє оцінити як силу, так і напрямок впливу кожної ознаки на ймовірність успіху, а також забезпечує статистичні тести значущості цього впливу. У контексті даного дослідження логістична регресія надає інтерпретовані результати, які можуть бути безпосередньо використані для прийняття бізнес-рішень. Одночасно вона забезпечує більш надійні оцінки значущості для бінарної цільової змінної порівняно з методами, розробленими для неперервних змінних.

## Decision Tree (Дерево рішень)

Дерево рішень є непараметричним методом машинного навчання, який створює модель прогнозування шляхом вивчення правил прийняття рішень, виведених з даних. У контексті оцінки значущості ознак, дерево рішень дозволяє визначити важливість ознак на основі їх внеску у зменшення неоднорідності (impurity) або збільшення інформаційного приросту.

Важливість ознаки в дереві рішень можна обчислити як зважену суму зменшення неоднорідності, яке забезпечує ця ознака в усіх вузлах, де вона використовується для розщеплення. Для бінарної класифікації часто використовується індекс Джині або ентропія як міра неоднорідності.

Формула важливості ознаки Xi може бути представлена як:

```
Importance(Xi) = ∑(nodes where Xi is used) (weighted impurity decrease)
```

Обґрунтування вибору: Дерево рішень обрано як метод оцінки значущості ознак через його здатність враховувати нелінійні взаємодії між ознаками та автоматично виявляти найбільш дискримінативні ознаки. На відміну від статистичних методів, які оцінюють кожну ознаку окремо, дерево рішень розглядає ознаки в контексті їх взаємодії, що особливо важливо для складних бізнес-даних. Цей метод не потребує припущень про розподіл даних і однаково ефективно працює з різними типами ознак, що відповідає вимогам даного дослідження. У контексті аналізу B2B-замовлень дерево рішень дозволяє виявити ключові фактори, які впливають на успішність замовлень, та конкретні порогові значення цих факторів, що забезпечує практичну цінність результатів аналізу.

## Обґрунтування комплексного підходу

Обраний набір методів оцінки значущості ознак забезпечує комплексний підхід до аналізу даних B2B-замовлень з різних перспектив. Кожен метод має свої сильні сторони та обмеження, і їх комбінація дозволяє отримати більш повне розуміння факторів, що впливають на успішність замовлень.

AUC забезпечує базову оцінку здатності кожної окремої ознаки розділяти успішні та неуспішні замовлення. Взаємна інформація та кореляція відстаней виявляють різні типи статистичних залежностей, включаючи нелінійні, які можуть бути пропущені при використанні лише лінійних методів. Логістична регресія надає інтерпретовані коефіцієнти та статистичні тести значущості, які враховують одночасний вплив усіх ознак. Дерево рішень доповнює аналіз, враховуючи взаємодії між ознаками та визначаючи специфічні шаблони, які впливають на успішність замовлень.

Таким чином, використання цих п'яти методів дозволяє провести всебічний аналіз значущості ознак, уникаючи обмежень, притаманних окремим методам, та забезпечуючи надійну основу для подальшої розробки прогностичних моделей та прийняття бізнес-рішень.

## Висновки

Правильний вибір методів оцінки значущості ознак є критично важливим для ефективного аналізу та моделювання бізнес-даних. Обрані методи – AUC, взаємна інформація, кореляція відстаней, логістична регресія та дерево рішень – забезпечують комплексний аналіз значущості ознак з різних перспектив, враховуючи специфіку набору даних B2B-замовлень та бінарної цільової змінної.

Комбінація цих методів дозволяє виявити як прості, так і складні взаємозв'язки між характеристиками замовлень та їх успішністю, забезпечуючи глибше розуміння факторів, що впливають на бізнес-процеси. Результати такого аналізу можуть бути використані для оптимізації бізнес-процесів, покращення прогностичних моделей та, в кінцевому підсумку, підвищення ефективності бізнесу.
