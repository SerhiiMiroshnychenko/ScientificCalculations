Методи агрегації рангів для Інтернету
Синтія Дворк 1 , Раві Кумар 2 , Моні Наор 3 ,  Д. Сівакумар 2
1: Дослідницький центр Compaq Systems , Пало-Альто, Каліфорнія, США.
2: Дослідницький центр IBM Almaden , Сан-Хосе, Каліфорнія, США.
3: Інститут науки Вейцмана , Реховот, Ізраїль.
(Відвідування IBM Almaden та Стенфордського університету )
 
Анотація
Ми розглядаємо проблему об'єднання результатів ранжування з різних джерел. В контексті Інтернету основні застосування включають створення метапошукових систем, об'єднання функцій ранжування, вибір документів на основі кількох критеріїв та покращення точності пошуку за допомогою асоціацій слів. Ми розробляємо набір методів для задачі агрегації рангів та порівнюємо їхню ефективність з відомими методами. Основною метою нашої роботи є розробка методів агрегації рангів, які можуть ефективно боротися зі "спамом" – серйозною проблемою в веб-пошуку. Експерименти показують, що наші методи є простими, ефективними та результативними.
Ключові слова: агрегація рангів, функції ранжування, метапошук, багатословні запити, спам

1 Вступ
Завдання ранжування списку з кількох альтернатив на основі одного або кількох критеріїв зустрічається в багатьох ситуаціях. Однією з основних цілей цієї справи є визначення найкращих альтернатив, або просто оголошення їх найкращими (наприклад, у спорті), або використання їх для певної мети. Коли існує лише один критерій (або «суддя») для ранжування, завдання є відносно простим і просто відображає думки та упередження судді. (Якби простота була єдиним бажаним критерієм, диктатура перемогла б над демократією.) На противагу цьому, у цій статті розглядається проблема обчислення «консенсусного» ранжування альтернатив, враховуючи індивідуальні уподобання кількох суддів щодо ранжування. Ми називаємо це проблемою агрегації рангів. Зокрема, ми вивчаємо проблему агрегації рангів у контексті Інтернету, де вона ускладнюється безліччю проблем. Ми починаємо з підкреслення важливості агрегації рангів для веб-застосунків та уточнення різних характеристик цієї проблеми в контексті Інтернету. Ми надаємо теоретичні основи для встановлення критеріїв для «хороших» методів агрегації рангів та оцінки конкретних пропозицій, а також пропонуємо нові алгоритмічні рішення. Наші експерименти надають перші докази успішності наших методів, які, на нашу думку, значно покращать різноманітні пошукові програми в Інтернеті.
1.1 Мотивація
Станом на лютий 2001 року існувало щонайменше 24 пошукові системи загального призначення (див. Огляд пошукових систем ), а також численні пошукові системи спеціального призначення. Сам факт наявності такої великої кількості варіантів свідчить про те, що жодна пошукова система не виявилася задовільною для всіх користувачів Інтернету. Існує низка вагомих причин, чому це так, навіть якщо обмежити увагу пошуковими системами, які призначені для «загального призначення». Дві досить очевидні причини полягають у тому, що жоден алгоритм ранжування не може вважатися загальноприйнятним, і жодна пошукова система не є достатньо повноцінною у своєму охопленні Інтернету. Однак проблеми дещо глибші.
По-перше, існує питання «спаму» – хитрих маніпуляцій авторами веб-сторінок у спробі досягти незаслужено високого рейтингу. Жодній окремій функції ранжування не можна довіряти, щоб вона добре працювала для всіх запитів. Кілька років тому частота пошукових термінів була єдиним основним евристичним методом ранжування веб-сторінок; з моменту впливової роботи Кляйнберга [Kleinberg 1998, 1999] та Бріна та Пейджа [Brin and Page 1998] , аналіз посилань став визначатися як дуже потужний метод ранжування веб-сторінок та інших документів з гіперпосиланнями. Було додано кілька інших евристик, включаючи аналіз тексту прив'язки [Chakrabarti et al. 1998] , аналіз структури сторінки (заголовки тощо), використання списків ключових слів та самого тексту URL-адреси тощо. Ці добре мотивовані евристики використовують величезну кількість інформації, але часто схильні до маніпуляцій з боку хитрих сторін.

По-друге, у світі, яким керують (часто змінювані) комерційні інтереси та альянси, незрозуміло, чи мають користувачі якусь форму захисту від упереджень/інтересів окремих пошукових систем. Як приклад, зазначимо, що платне розміщення та платне включення (див. [Стаття в Search Engine Watch] ) набирають популярності серед пошукових систем.

У деяких випадках окремі функції ранжування є неадекватними з більш фундаментальної причини: дані, що ранжуються, просто не піддаються простим функціям ранжування. Це стосується запитів щодо мультимедійних документів, наприклад, «знайти документ, який містить інформацію про грецькі острови із зображеннями прекрасних блакитних пляжів». Це проблема, яку традиційно вивчають у проміжному програмному забезпеченні баз даних (див. [Fagin 1999] ). Для цієї мети було винайдено кілька нових підходів, але цю проблему не можна вважати добре вирішеною за жодним показником. Природно, ці проблеми належать до сфери агрегації рангів.

Таким чином, нашою першою мотивацією для вивчення агрегації рангів у контексті Інтернету є забезпечення користувачам певного ступеня надійності пошуку, враховуючи різні недоліки та упередження – зловмисні чи інші – окремих пошукових систем. Тобто, знайти надійні методи для метапошуку .

Існує другий дуже широкий набір сценаріїв, де потрібна агрегація рангів. Якщо коротко, то це випадки, коли уподобання користувача включають різноманітні критерії, а логіка класифікації документа як прийнятного або неприйнятного є занадто складною або занадто туманною, щоб її можна було закодувати в будь-якій простій формі запиту. Як прототипні приклади, ми перерахуємо деякі випадки, з якими часто стикаються веб-користувачі. У загальному випадку їх можна класифікувати як запити на багатокритеріальний вибір та запити на асоціацію слів . Приклади багатокритеріального вибору виникають під час спроби вибрати продукт з бази даних продуктів, таких як ресторани або плани подорожей. Приклади запитів на асоціацію слів виникають, коли користувач бажає знайти хороший документ на певну тему; користувач знає список ключових слів, які разом описують тему, але не впевнений, що найкращий документ на цю тему обов'язково містить їх усі. (Див. розділ 5 для конкретних прикладів обох категорій.) Це дуже знайома дилема для користувачів веб-пошуку: коли ми надаємо список ключових слів пошуковій системі, чи запитуємо ми документи, які містять усі ключові слова, чи запитуємо ми документи, які містять будь-яке з ключових слів? Зверніть увагу, що перший варіант може не створити жодного корисного документа або ж його може бути забагато, тоді як другий може створити величезний список документів, де незрозуміло, який з них обрати як найкращий. Ми пропонуємо наступний природний підхід до цієї проблеми:

Ранжування асоціацій.
Ранжуйте базу даних відносно кількох невеликих підмножин запитів та агрегуйте ці рейтинги.
1.2 Виклики
Ідеальний сценарій для агрегації рангів полягає в тому, що кожен суддя (пошукова система у випадку метапошуку, окремий критерій для багатокритеріального відбору та підмножини запитів у випадку запитів на асоціації слів) надає повне впорядкування всіх альтернатив у всесвіті альтернатив. Однак це надто нереалістично з двох основних причин.
Перша причина — це особливо гостра проблема у метапошуку: охоплення різних пошукових систем різне; малоймовірно, що всі пошукові системи (зрештою) зможуть ранжувати всю колекцію сторінок в Інтернеті, яка зростає дуже швидкими темпами. По-друге, пошукові системи регулярно обмежують доступ приблизно до перших кількох сотень сторінок у своєму ранжуванні. Це робиться як для забезпечення конфіденційності їхнього алгоритму ранжування, так і в інтересах ефективності. Питання ефективності також є серйозним вузьким місцем у виконанні агрегації рангів для запитів багатокритеріального вибору та асоціації слів.

Отже, будь-який метод агрегації рангів для вебзастосунків повинен бути здатним враховувати той факт, що доступні лише кілька сотень перших записів кожного рейтингу. Звичайно, якщо між цими записами немає абсолютно жодного перекриття, жоден алгоритм мало що може зробити; завдання полягає в тому, щоб розробити алгоритми агрегації рангів, які працюють, коли є обмежене, але нетривіальне перекриття між кількома сотнями або тисячами перших записів у кожному рейтингу. Зрештою, з огляду на обсяг даних, неминуче слід зазначити, що будь-який метод агрегації рангів має бути обчислювально ефективним.

1.3 Наші результати
Ми пропонуємо математичне середовище для вивчення проблеми агрегації рангів та пропонуємо кілька алгоритмів. Спираючись на літературу з теорії соціального вибору, статистики та комбінаторної оптимізації, ми точно формулюємо, що означає обчислити гарне консенсусне впорядкування альтернатив, враховуючи кілька (часткових) ранжування альтернатив. Зокрема, ми визначаємо метод Кемені, спочатку запропонований у контексті теорії соціального вибору, як особливо бажаний підхід, оскільки він мінімізує загальну невідповідність (формалізовану нижче) між кількома вхідними ранжуваннями та їх агрегацією. На жаль, ми показуємо, що обчислення оптимальних рішень на основі підходу Кемені є NP-складним, навіть коли кількість ранжування, що підлягають агрегації, становить лише 4. Тому ми пропонуємо кілька евристичних алгоритмів для агрегації рангів та оцінюємо їх у контексті веб-додатків. Окрім евристики, ми визначаємо ключову властивість оптимальних рішень Кемені, яка особливо корисна в боротьбі зі спамом, та пропонуємо ефективний алгоритм для мінімальної модифікації будь-якої початкової агрегації, щоб скористатися цією властивістю. Ця властивість називається «розширеним критерієм Кондорсе», а ефективний процес, який гарантовано його досягне, ми називаємо «локальною кеменізацією».
Наші алгоритми початкової агрегації базуються на двох широких принципах. Перший принцип полягає в досягненні оптимальності не відносно рекомендацій Кемені, а відносно іншої, тісно пов'язаної міри, для якої можна знайти ефективне рішення. Другий принцип полягає у використанні ланцюгів Маркова як засобу об'єднання інформації часткового порівняння, отриманої з окремих ранжування, у загальне впорядкування. Хоча немає гарантії якості результату, останні методи є надзвичайно ефективними та зазвичай відповідають або перевершують перший метод.

Ми повідомляємо про експерименти та кількісні вимірювання якості для задачі метапошуку, а також наводимо кілька ілюстрацій наших методів, застосованих для задач стійкості до спаму та запитів на асоціації слів.

1.4 Організація
У розділі 2 ми описуємо нашу структуру, включаючи поняття ранжування , мір відстані та оптимальної агрегації . Цей розділ також містить короткий опис концепцій з теорії графів та ланцюгів Маркова , які нам потрібні для цієї статті. У розділі 3 обговорюється спам, розширений принцип Кондорсе та локальна кеменізація. У розділі 4 описано різні методи агрегації рангів, включаючи відомий метод Борди та кілька інших нових методів. У розділі 5 представлено п'ять основних застосувань наших методів, а в розділі 6 представлено експериментальне дослідження деяких з них. Нарешті, у розділі 7 наведено деякі зауваження щодо майбутньої роботи.
2 Попередні матчі
2.1 Рейтинг
Для заданого універсуму U впорядкований список ( або просто список) t відносно U є впорядкуванням (або ранжуванням) підмножини S набору U , тобто t = [ x1 > x2 > ... > xd ] , де кожне xi в S , а > — деяке відношення впорядкування на S. Також, якщо i в U присутнє в t , нехай t ( i ) позначає позицію або ранг i (високорейтинговий або переважний елемент має позицію з низьким номером у списку). Для списку t нехай | t | позначає кількість елементів. Призначаючи унікальний ідентифікатор кожному елементу в U , ми можемо припустити без втрати загальності, що U = {1, 2, ..., |U| }.
Залежно від типу інформації, присутньої в t , виникають три ситуації:

(1) Якщо t містить усі елементи в U , то він називається повним списком . Повні списки насправді є повними впорядкуваннями (перестановками) U. Наприклад, якщо U — це множина всіх сторінок, проіндексованих пошуковою системою, легко побачити, що повний список виникає, коли ми ранжуємо сторінки (скажімо, відносно запиту) за фіксованим алгоритмом.

(2) Існують ситуації, коли повні списки незручні або навіть можливі. Наприклад, нехай U позначає множину всіх веб-сторінок у світі. Нехай t позначає результати пошукової системи у відповідь на деякий фіксований запит. Навіть якщо запит може викликати повне впорядкування сторінок, проіндексованих пошуковою системою, оскільки індексний набір пошукової системи майже напевно є лише підмножиною U , ми маємо сувору нерівність | t | < |U| . Іншими словами, у світі є сторінки, які не ранжуються цією пошуковою системою відносно запиту. Такі списки, які ранжують лише деякі елементи в U, називаються частковими списками .

(3) Окремим випадком часткових списків є наступний. Якщо S – це множина всіх сторінок, проіндексованих певною пошуковою системою, і якщо t відповідає 100 першим результатам пошукової системи за запитом, очевидно, що сторінки, яких немає у списку t, можна вважати ранжованими пошуковою системою нижче 100. Такі списки, які ранжують лише підмножину S і де неявно є, що кожен ранжований елемент знаходиться вище за всі неранжовані елементи, називаються d першими списками , де d – розмір списку. Природна операція проекції буде корисною. Враховуючи список t та підмножину T універсуму U , проекція t відносно T (позначена t |T) буде новим списком, який містить лише елементи з T. Зауважте, що якщо t містить усі елементи в T , то t |T – це повний список відносно T. 

2.1.1 Вимірювання відстані
Як виміряти відстань між двома повними списками відносно множини S ? Дві популярні міри відстані (див. [Diaconis 1988] ): (1) Відстань за правилом Спірмена — це сума абсолютної різниці між рангом i згідно з двома списками за всіма елементами i в S. Формально, для двох повних списків s та t їхня відстань за правилом Спірмена визначається як
F ( s , t ) = Si | s ( i ) - t ( i ) |.  
Після ділення цього числа на максимальне значення (1/2) |S| 2 , можна отримати нормалізоване значення відстані між нижніми лініями, яке завжди знаходиться між 0 та 1. Відстань між нижніми лініями між двома списками можна обчислити за лінійний час.
(2) Тау-відстань Кендалла підраховує кількість попарних розбіжностей між двома списками; тобто відстань між двома повними списками s та t дорівнює

K ( s , t ) = |{( i, j ): i < j , s ( i ) < s ( j ), але t ( i ) > t ( j )|.
Поділивши це число на максимально можливе значення (1/2) S ( S - 1), ми отримуємо нормалізовану версію відстані Кендалла. Відстань Кендалла для повних списків - це відстань "бульбашкового сортування", тобто кількість попарно суміжних транспозицій, необхідних для перетворення з одного списку в інший. Відстань Кендалла між двома списками довжини n можна обчислити за n log n часу, використовуючи прості структури даних.
Вищезазначені міри є метриками та природним чином поширюються на кілька списків. Наприклад, для кількох повних списків s , t1 , ..., tk нормалізована відстань Footrule від s до t1 , ... , tk задається як

F ( s , t1 , ... tk ) = ( 1 / k ) SiF ( s , t1 ) .  
Можна визначити узагальнення цих мір відстані до часткових списків. Якщо t1 , ..., tk – часткові списки, нехай U позначає об'єднання елементів у t1 , ..., tk , а s – повний список відносно U. Тепер, враховуючи s , ідея полягає в тому, щоб розглянути відстань між t1 та проекцією s відносно t1 . Тоді, наприклад, ми маємо індуковану відстань за правилом підніжжя:
F ( s , t1 , ..., tk ) = ( 1 / k ) S та F ( s | ti , ti ) .  
Аналогічним чином можна визначити індуковану тау-відстань Кендалла. Нарешті, ми визначаємо третє поняття відстані, яке вимірює відстань між повним списком та частковим списком в одному всесвіті:
(3) Враховуючи один повний список та один частковий список, масштабована відстань футрула зважує внески елементів на основі довжини списків, у яких вони присутні. Більш формально, якщо s — повний список, а t — частковий список, тоді:

SF ( s , t ) = Si in t |     ( s ( i )/| s |) - ( t ( i )/| t |)|.
Ми нормалізуємо SF , поділивши його на | t |/2.
Зауважте, що ці відстані не обов'язково є метриками.

Значною мірою наші інтерпретації експериментальних результатів будуть здійснюватися з точки зору цих вимірювань відстані. Хоча ці вимірювання відстані здаються природними, чому вони є хорошими, невідомо. Ми не будемо заглиблюватися в такі дискусії тут; зацікавлений читач може знайти такі аргументи в книгах Діаконіса [Diaconis 1988] , Крітчлоу [Critchlow 1985] або Мардена [Marden] .

2.1.2 Оптимальне агрегування рангів
У загальному контексті агрегації рангів поняття «кращого» залежить від того, яку міру відстані ми прагнемо оптимізувати. Припустимо, що ми хочемо оптимізувати відстань Кендалла, тоді питання таке: для заданих (повних або часткових) списків t1, ..., tk знайти s таке , що s є повним списком відносно об'єднання елементів t1 , ..., tk , і s мінімізує K ( s , t1 , ..., tk ). Агрегація, отримана шляхом оптимізації відстані Кендалла, називається оптимальною агрегацією Кемені і в точному сенсі відповідає геометричній медіані вхідних даних. Ми показуємо, що обчислення оптимальної агрегації Кемені є NP-важким навіть тоді, коли k = 4 ( див . Додаток B ). (Зауважте, що на відміну від сценарію соціального вибору, де є багато виборців і відносно мало кандидатів, у сценарії веб-агрегації ми маємо багато кандидатів (сторінок) і відносно мало виборців (пошукових систем).)
Оптимальні агрегації Кемені мають інтерпретацію максимальної правдоподібності. Припустимо , що існує базовий «правильний» порядок s для S , і кожен порядок t1 , ..., tk отримується з s шляхом заміни двох елементів з деякою ймовірністю менше 1/2. Таким чином, t є «шумними» версіями s . Оптимальна агрегація Кемені t1 , ..., tk — це та, яка з максимальною ймовірністю породила t ( вона не обов'язково має бути унікальною) [Young 1988] . З інших міркувань, оптимальна агрегація Кемені має властивість усувати шум з різних схем ранжування. Крім того, оптимальні агрегації Кемені є по суті єдиними, які одночасно задовольняють природні та важливі властивості функцій рангової агрегації, які називаються нейтральністю та узгодженістю в літературі з соціального вибору, та так званою властивістю Кондорсе [Young and Levenglick 1978] . Дійсно, оптимальні агрегації Кемені задовольняють розширений критерій Кондорсе . У розділі 3 ми встановлюємо тісний зв'язок між виконанням розширеного критерію Кондорсе та боротьбою зі спамом пошукових систем.

Враховуючи, що оптимальна агрегація Кемені є корисною, але обчислювально складною, як її обчислити? Наступне співвідношення показує, що відстань Кендалла можна дуже добре апроксимувати за допомогою відстані за правилом Спірмена.

Твердження 1 [ Діаконіс-Грем ]
Для будь-яких двох повних списків s , t , K ( s , t ) < F ( s , t ) < 2K ( s , t ) .
Це підводить нас до проблеми оптимальної агрегації правил футів . Це те саме, що й раніше, за винятком того, що критерієм оптимізації є відстань правила футів. У розділі 4 ми демонструємо алгоритм поліноміального часу для обчислення оптимальної агрегації правил футів (масштабована агрегація правил футів для часткових списків). Таким чином, ми маємо:
Твердження 2.
Якщо s є оптимальною агрегацією Кемені повних списків t1 , ..., tk , і s ' оптимізує агрегацію футправил, тоді K ( s ' , t1 , ... , tk ) < 2K ( s , t1 , ... , tk ) .
Пізніше, у розділі 4 , ми розробимо методи агрегації рангів, які не оптимізують жодних очевидних критеріїв, але виявляються дуже ефективними на практиці.
2.2 Основні поняття
Читачі, знайомі з поняттями теорії графів та ланцюгів Маркова, можуть пропустити цей розділ .
2.2.1 Деякі поняття з теорії графів
Граф G = ( V , E ) складається з множини вузлів V та множини ребер E. Кожен елемент e в E є невпорядкованою парою ( u , v ) інцидентних вузлів, що представляє зв'язок між вузлами u та v . Граф називається зв'язним , якщо множину вузлів не можна розбити на компоненти таким чином, що немає ребер, інцидентні вузли яких знаходяться в різних компонентах.
Двочастковий граф G = ( U , V , E ) складається з двох непересічних множин вузлів U , V таких, що кожне ребро e в E має один вузол з U , а інший вузол з V. Двочастковий граф є повним, якщо кожен вузол в U з'єднаний з кожним вузлом у V. Збіг - це підмножина ребер така, що для кожного ребра в збігу немає іншого ребра, яке має спільний з ним вузол. Максимальний збіг - це збіг найбільшої потужності. Зважений граф - це граф з (невід'ємною) вагою для кожного ребра e . Для зваженого графа мінімальна вага максимальна збіг - це максимальна збіг з мінімальною вагою. Задачу мінімальної ваги максимальної збігу для двочасткових графів можна вирішити за час O ( n 2.5 ), де n - кількість вузлів.

Орієнтований граф складається з вузлів та ребер, але цього разу ребро — це впорядкована пара вузлів ( u , v ), що представляє з'єднання від u до v . Орієнтований шлях називається існуючим від u до v , якщо існує послідовність вузлів u = w0 , ..., wk = v така, що ( wi , wi + 1 — ребро для всіх i = 0, ..., k - 1). Орієнтований цикл — це нетривіальний орієнтований шлях від вузла до себе. Сильно зв'язна компонента графа — це набір вузлів, такий що для кожної пари вузлів у компоненті існує орієнтований шлях від одного до іншого. Орієнтований ациклічний граф (DAG) — це орієнтований граф без орієнтованих циклів. У DAG вузол- сток — це вузол, який не має орієнтованого шляху до жодного іншого вузла.

2.2.2 Ланцюги Маркова
(Однорідний) ланцюг Маркова для системи визначається набором станів S = {1, 2, ..., n } та невід'ємною, стохастичною (тобто сума кожного рядка дорівнює 1) матрицею M розміром n на n . Система починає роботу в деякому початковому стані в S і на кожному кроці переходить з одного стану в інший. Цей перехід керується M : на кожному кроці, якщо система знаходиться в стані i , вона переходить у стан j з ймовірністю M ij . Якщо поточний стан задано як розподіл ймовірностей, розподіл ймовірностей наступного стану задається добутком вектора, що представляє розподіл поточних станів, та M. Загалом, початковий стан системи вибирається відповідно до деякого розподілу x (зазвичай, рівномірного розподілу) на S. Після t кроків стан системи розподіляється відповідно до xM t . За деяких умов зручності ланцюга Маркова (деталі якого ми не обговорюватимемо), незалежно від початкового розподілу x , система зрештою досягає єдиної фіксованої точки, де розподіл станів не змінюється. Цей розподіл називається стаціонарним розподілом . Можна показати, що стаціонарний розподіл задається головним лівим власним вектором y матриці M , тобто yM = ly . На практиці простий алгоритм степеневої ітерації може швидко отримати прийнятне наближення до y .
Важливим спостереженням тут є те, що елементи в y визначають природне впорядкування на S. Ми називаємо таке впорядкування впорядкуванням ланцюга Маркова M. Технічний момент, який слід врахувати під час використання ланцюгів Маркова для ранжування, полягає в наступному. Ланцюг Маркова M визначає зважений граф з n вузлами, такий що вага на ребрі ( u , v ) задається як M uv . Сильно зв'язані компоненти цього графа утворюють DAG. Якщо цей DAG має вузол-сток, то стаціонарний розподіл ланцюга буде повністю зосереджений у сильно зв'язному компоненті, що відповідає вузлу-стоку. У цьому випадку ми отримуємо лише впорядкування альтернатив, присутніх у цьому компоненті; якщо це трапляється, природна розширена процедура полягає у видаленні цих станів з ланцюга та повторенні процесу для ранжування решти вузлів. Звичайно, якщо цей компонент має достатньо альтернатив, можна зупинити процес агрегації та вивести частковий список, що містить деякі з найкращих альтернатив. Якщо DAG зв'язних компонентів є (слабко) зв'язним і має більше одного вузла-стоку, то ми отримаємо два або більше кластерів альтернатив, які можна відсортувати за загальною масою ймовірностей компонентів. Якщо DAG має кілька слабозв'язних компонентів, ми отримаємо непорівнянні кластери альтернатив. Таким чином, коли ми говоримо про впорядкування ланцюга Маркова, ми маємо на увазі впорядкування, отримане за допомогою цієї розширеної процедури.

3. Стійкість до спаму та критерії Кондорсе
У 1785 році Марі Жан Каріта, маркіз де Кондорсе, запропонувала, що якщо існує деякий елемент S , відомий зараз як альтернатива Кондорсе , який перемагає всі інші при попарному простому більшостному голосуванні, то цей елемент має бути ранжований першим [Кондорсе 1785] . Природне розширення, надане Трушоном [Трюшоном 1998] (див. також [Сміт 1973] ), вимагає, щоб якщо існує розбиття ( C , D ) S таке, що для будь-якого x в C та y в D більшість віддає перевагу x перед y , то x має бути ранжованим вище за y . Це називається розширеним критерієм Кондорсе (ECC). Ми покажемо, що ECC не тільки може бути досягнутий ефективно, але й має чудові властивості "боротьби зі спамом" при використанні в контексті метапошуку.
Інтуїтивно, пошукова система зазнала спаму зі сторінки в своєму індексі за певним запитом, якщо вона ранжує сторінку "занадто високо" порівняно з іншими сторінками в індексі, на думку "типового" користувача. Дійсно, відповідно до цієї інтуїції, пошукові системи як оцінюються (див. [Media Metrix] ), так і навчаються людьми- оцінювачами . Такий підхід до визначення спаму: (1) дозволяє автору підвищити рейтинг своєї сторінки, покращуючи контент; (2) надає користувачам основну інформацію про відносну цінність сторінок --- іншими словами, визначення не передбачає існування абсолютного порядку, який дає "справжню" відносну цінність пари сторінок за запитом; (3) не передбачає одностайності думок користувачів або узгодженості думок одного користувача; та (4) пропонує деякі природні способи автоматизації навчання пошукових систем для врахування корисних упереджень, таких як географічне упередження.

Ми вважаємо, що покладатися на оцінювачів у визначенні спаму неминуче. (Якщо оцінювачі – люди, що є типовим сценарієм під час проектування та навчання пошукових систем, то кінцевий продукт враховуватиме упередження оцінювачів, які навчають їх.) Ми моделюємо оцінювачів за допомогою функцій ранжування пошукових систем. Тобто, ми робимо спрощене припущення, що для будь-якої пари сторінок відносне впорядкування більшістю пошукових систем, які їх порівнюють, таке ж, як і відносне впорядкування більшістю оцінювачів. Наша інтуїція підказує, що якщо сторінка заспамлює всі або навіть більшість пошукових систем для певного запиту, то жодна комбінація цих пошукових систем не зможе перемогти спам. Це розумно: виправити запит; якщо для деякої пари сторінок більшість пошукових систем заспамлені, то функція агрегації працює з надмірно поганими даними – сміття на вході, сміття на виході. З іншого боку, якщо сторінка заспамлює лише менше половини пошукових систем, то більшість пошукових систем віддадуть перевагу «хорошій» сторінці перед сторінкою спаму. Іншими словами, згідно з цим визначенням спаму, сторінки зі спамом є тими, хто програв за шкалою Кондорсе, і займатимуть нижній розділ будь-якого агрегованого рейтингу, який відповідає розширеному критерію Кондорсе. Аналогічно, якщо припустити, що більшість віддає перевагу хорошим сторінкам над посередніми, вони будуть переможцями Кондорсе і тому матимуть високий рейтинг.

Багато існуючих методів агрегації (див. розділ 4 ) не гарантують обрання переможця Кондорсе, якщо такий існує. Наша мета — отримати простий метод модифікації будь-якої початкової агрегації вхідних списків таким чином, щоб переможці Кондорсе (спам) під час цього процесу були переміщені вниз рейтингу. Ця процедура називається локальною кеменізацією та описана далі.

3.1 Локальна кеменізація
Ми вводимо поняття локально оптимальної агрегації Кемені, релаксації оптимальності Кемені, яка забезпечує задоволення розширеного принципу Кондорсе та водночас залишається обчислювально придатною. Як випливає з назви, локальний оптимум Кемені – це «локальне» поняття, яке має деякі властивості оптимальної агрегації Кемені.
Повний список p — це локально оптимальна за Кемені агрегація часткових списків t1 , t2 , ..., tk , якщо не існує повного списку p ', який можна отримати з p шляхом виконання однієї транспозиції суміжної пари елементів, і для якого K ( p ' , t1 , t2 , ... , tk ) < K ( p , t1 , t2 , ..., tk ) . Іншими словами, неможливо зменшити загальну відстань до p , перевертаючи суміжну пару.

Кожна оптимальна агрегація Кемені також є локально оптимальною за Кемені, але обернене твердження хибне. Тим не менш, ми показуємо, що локально оптимальна агрегація Кемені задовольняє розширену властивість Кондорсе та може бути обчислена (див. Додаток А ) за час O ( kn log n ).

Ми обговорили цінність розширеного критерію Кондорсе для підвищення стійкості до спаму пошукових систем та забезпечення того, щоб елементи у верхніх розділах залишалися високо ранжованими. Однак, специфічні методи агрегації можуть додати значну цінність, окрім простого задоволення цього критерію; зокрема, вони можуть забезпечити хороші рейтинги альтернатив у заданому розділі (як зазначалося вище, розширений критерій Кондорсе не дає жодних вказівок у межах розділу). Тепер ми покажемо, як, використовуючи будь-яку початкову агрегацію m часткових списків t1, t2 , ... , tk --- таку , що не обов'язково є списком Кондорсе --- ми можемо ефективно побудувати локально оптимальну за Кемені агрегацію t , яка в чітко визначеному сенсі максимально узгоджується з m . Наприклад, якщо t є повними списками, то m може бути впорядкуванням Борди для альтернатив (див. розділ 4.1 для методу Борди). Навіть якщо переможець Кондорсе існує, впорядкування Борди може не ранжувати його на перше місце. Однак, застосовуючи нашу процедуру «локальної кеменізації» (описану нижче), ми можемо отримати рейтинг, який максимально відповідає впорядкуванню Борда, але в якому переможці Кондорсе знаходяться на вершині списку.

Локальна кеменізація (ЛК) повного списку m відносно t1 , ..., tk — це процедура, яка обчислює локально оптимальну за Кемені агрегацію t1 , ..., tk , яка (у точному сенсі) максимально узгоджується з m . Інтуїтивно зрозуміло , що цей підхід також зберігає сильні сторони початкової агрегації m . Таким чином:

(1) переможені за Кондорсе отримують низький ранг, тоді як переможці за Кондорсе отримують високий ранг (це випливає з локальної оптимальності Кемені)

(2) результат не погоджується з m щодо порядку будь-якої заданої пари ( i , j ) елементів лише тоді, коли більшість тих, хто висловлює думку, не погоджується з m щодо ( i , j ).

(3) для кожного d між 1 та | m |, префікс довжини d виводу є локальною кеменізацією d верхніх елементів в m .

Таким чином, якщо m є початковим результатом метапошуку, і ми маємо певну впевненість у тому, що, скажімо, 100 перших елементів m містять достатньо хороших сторінок, тоді ми можемо побудувати локально оптимальну за Кемені агрегацію проекцій t на 100 перших елементів у m .

Процедура локальної кеменізації — це проста індуктивна конструкція. Без обмеження спільності, нехай m = (1, 2, ..., | m |). Припустимо індуктивно, що для цього ми побудували p , локальну кеменізацію проекції t на елементи 1, ..., l -1. Вставимо елемент l у найнижчерангову «допустиму» позицію в p : трохи нижче елемента y з найнижчим рангом у p таким чином, що (a) жодна більшість серед (вихідних) t не віддає перевагу x перед y та (b) для всіх наступників z після y в p існує більшість, яка віддає перевагу x перед z . Іншими словами, ми намагаємося вставити x в кінець (знизу) списку p ; ми піднімаємо його до початку списку, поки більшість t наполягає на цьому.

Строгий розгляд локальної оптимальності Кемені та локальної кеменізації наведено в Додатку А , де ми також показуємо, що локальна кеменізація агрегації є унікальною. На основі цих результатів ми пропонуємо наступний загальний підхід до рангової агрегації:

Враховуючи t1 , ..., tk , використовуйте ваш улюблений метод агрегації, щоб отримати повний список m .
Виведіть (унікальну) локальну кеменізацію m відносно t1 , ..., tk .
4 Методи агрегації рангів
4.1 Метод Борди
Метод Борди [Borda 1781] є «позиційним» методом, оскільки він призначає бал, що відповідає позиціям, на яких кандидат з'являється у рейтингу вподобань кожного виборця, а кандидати сортуються за їхнім загальним балом. Основною перевагою позиційних методів є те, що вони дуже обчислювально прості: їх можна реалізувати за лінійний час. Вони також мають властивості, які називаються анонімністю, нейтральністю та узгодженістю в літературі з соціального вибору [Young 1974] . Однак вони не можуть задовольнити критерій Кондорсе. Фактично, можна показати, що жоден метод, який призначає ваги кожній позиції, а потім сортує результати, застосовуючи функцію до ваг, пов'язаних з кожним кандидатом, не задовольняє критерій Кондорсе (див. [Young 1974] ).
Повні списки. Враховуючи повні списки t1 , ..., tk , для кожного кандидата c в S та списку t i , метод Борди спочатку призначає бал B i ( c ) = кількість кандидатів, ранжованих нижче c в t i, а загальний бал Борди B ( c ) визначається як S i B i ( c ) . Потім кандидати сортуються в порядку спадання загального балу Борди. 

Зазначимо, що метод Борди можна розглядати як присвоєння кожному кандидату вектора позицій k -елементів (позиції кандидата в k списках) та сортування кандидатів за нормою L1 цих векторів. Звичайно, існує багато інших можливостей з такими векторами позицій: сортування за нормами Lp для p > 1, сортування за медіаною значень k , сортування за середнім геометричним значень k тощо. Ця інтуїція підводить нас до кількох підходів на основі ланцюгів Маркова, описаних у розділі 4.3 .

Часткові списки. Було запропоновано (наприклад, у нещодавній статті, опублікованій у журналі The Economist [Saari, 2000] ), що правильний спосіб поширення методу Борди на часткові списки полягає в рівномірному розподілі всіх надлишкових балів між усіма кандидатами без рейтингу. Ця ідея випливає з мети неупередженості ; однак легко показати, що для будь-якого методу присвоєння балів кандидатам без рейтингу існують випадки часткової інформації, в яких виникають небажані результати.

4.2 Правило футів та масштабоване правило футів
Оскільки оптимальна агрегація за правилом футів є добрим наближенням оптимальної агрегації Кемені (за твердженням 2 ), вона заслуговує на дослідження.
Повні списки. Оптимальна агрегація за допомогою правила футів пов'язана з медіаною значень у векторі позицій:

Твердження 3. Для
повних списків t1 , ..., tk , якщо медіанні позиції кандидатів у списках утворюють перестановку, то ця перестановка є оптимальною агрегацією за футправилом.
Тепер ми отримуємо алгоритм для оптимальної агрегації за допомогою наступного твердження:
Твердження 4.
Оптимальну агрегацію повних списків за правилом Footrule можна обчислити за поліноміальний час, зокрема, за час, необхідний для знаходження ідеального збігу з мінімальною вартістю в двочастковому графі.
Доведення (ескіз): Нехай
об'єднання t1 , ..., tk буде S з n елементами. Тепер ми визначимо зважений повний двочастковий граф ( C , P , W ) наступним чином. Перший набір вузлів C = {1, ..., n } позначає набір елементів, які потрібно ранжувати (сторінки). Другий набір вузлів P = {1, ..., n } позначає n доступних позицій. Вага W ( c , p ) - це загальна відстань між нижніми елементами (від t i ) ранжування, яке розміщує елемент c у позиції p , що задається як W ( c , p ) = Si | t i ( c ) - p |. Можна показати, що перестановка, яка мінімізує загальну відстань між нижніми елементами до   t i , задається ідеальним збігом мінімальної вартості в двочастковому графі.
Часткові списки. Обчислення агрегації, оптимальної для правил футів, для часткових списків є більш проблематичним. Фактично, можна показати, що це еквівалентно NP-складній задачі обчислення мінімальної кількості ребер, які потрібно видалити, щоб перетворити орієнтований граф на DAG.
Пам'ятаючи, що оптимальну агрегацію за правилами футів для повних списків можна переосмислити як задачу двочастинкового зіставлення з мінімальною вартістю, ми тепер опишемо метод, який зберігає обчислювальні переваги випадку повного списку та є досить близьким до нього за духом. Ми визначаємо двочастинковий граф, як і раніше, за винятком того, що ваги визначаються по-іншому. Вага W ( c , p ) - це масштабована відстань до правила футів (від t i ) ранжування, яке розміщує елемент c у позиції p , що задається формулою W ( c , p ) = Si |   ( ti ( c )/| ti | ) - ( p / n )|. Як і раніше, ми можемо розв'язати задачу максимального зіставлення з мінімальною вартістю на цьому двочастинковому графі , щоб отримати алгоритм агрегації правил футів для часткових списків. Ми назвали цей метод масштабованою агрегацією правил футів (SFO).

4.3 Методи ланцюгів Маркова
Ми пропонуємо загальний метод отримання початкової агрегації часткових списків, використовуючи ланцюги Маркова. Стани ланцюга відповідають n кандидатам, яких потрібно ранжувати, ймовірності переходів певним чином залежать від заданих (часткових) списків, а впорядкування ланцюгів Маркова є агрегованим впорядкуванням. Існує кілька причин для використання ланцюгів Маркова:
Обробка часткових списків та списків d найкращих. Замість того, щоб вимагати, щоб кожна пошукова система (виборець) порівнювала
кожну пару сторінок (кандидатів) i та j , ми тепер можемо використовувати доступні порівняння між i та j для визначення ймовірності переходу між i та j , а також використовувати зв'язність ланцюга для (транзитивного) "виведення" результатів порівняння між парами, які не були явно ранжовані жодною з пошукових систем. Інтуїція полягає в тому, що ланцюги Маркова забезпечують більш цілісну точку зору на порівняння всіх n кандидатів один з одним --- значно більш змістовну, ніж спеціальні та локальні висновки, такі як "якщо більшість віддає перевагу A перед B, а більшість віддає перевагу B перед C, то A має бути кращим за C".

Обробка нерівномірних порівнянь.
Якщо веб-сторінка P знаходиться в нижній половині приблизно 70% списків і посідає перше місце серед інших 30%, наскільки важлива якість сторінок, що з'являються в останніх 30% списків? Якщо всі ці сторінки знаходяться ближче до кінця першого набору з 70% списків, а переможці в цих списках не були відомі іншим 30% пошуковим системам, які поставили P на перше місце, то, можливо, нам не варто ставитися до P надто серйозно. Іншими словами, якщо ми розглядаємо кожен список як турнір у лізі, нам слід враховувати силу розкладу матчів, зіграних кожним гравцем. Розв'язки ланцюгів Маркова, які ми обговорюємо, за духом схожі на підходи, що розглядаються в математичній спільноті для цієї задачі (власні вектори лінійних відображень, нерухомі точки нелінійних відображень тощо).

Удосконалення інших евристик.
Евристики для об'єднання ранжування мотивовані певним основним принципом. Наприклад, метод Борди базується на ідеї «більше перемог – краще». Це дає певний показник якості для кожного кандидата. Природно розширити це і сказати «більше перемог проти хороших гравців – ще краще» тощо, та ітеративно уточнити впорядкування, отримане за допомогою евристики. У контексті веб-пошуку алгоритм HITS Кляйнберга [Kleinberg 1998, 1999] та алгоритм PageRank Бріна та Пейджа [Brin and Page 1998] мотивовані подібними міркуваннями. Як ми побачимо, деякі з запропонованих нами ланцюгів є природними розширеннями (у точному сенсі) методу Борди, сортування за геометричним середнім та сортування за більшістю.

Обчислювальна ефективність. Загалом
, налаштування одного з цих ланцюгів Маркова та визначення його стаціонарного розподілу ймовірностей займає приблизно q ( n²k + n³ ) . Однак на практиці, якщо ми явно обчислимо матрицю переходів за час O ( n²k ) , кілька ітерацій степеневого методу дозволять нам обчислити стаціонарний розподіл. Фактично, ми пропонуємо ще швидший метод для практичних цілей. Для всіх ланцюгів, які ми пропонуємо, з часом попередньої обробки приблизно O ( nk ) (лінійний за розміром вхідних даних), зазвичай можна змоделювати один крок ланцюга за час O ( k ); таким чином, моделюючи ланцюг Маркова протягом приблизно O ( n ) кроків, ми повинні мати змогу досить ефективно вибірково вибирати зі стаціонарного розподілу. Цього зазвичай достатньо, щоб ідентифікувати кілька найкращих кандидатів у стаціонарному розподілі за час O ( nk ), можливо, значно швидше на практиці.

Тепер ми пропонуємо деякі специфічні ланцюги Маркова, позначені MC1 , MC2 , MC4 та MC4 . Для кожного з цих ланцюгів ми визначаємо матрицю переходів та даємо деяке пояснення щодо того, чому таке визначення є доцільним. У всіх випадках простір станів – це об'єднання множин сторінок, ранжованих різними пошуковими системами.

MC1
Якщо поточний стан – сторінка P , то наступний стан вибирається рівномірно з мультимножини всіх сторінок, які були ранжовані вище (або дорівнюють) P деякою пошуковою системою, яка ранжувала P , тобто з мультимножини всіх сторінок Q таких, що t i ( Q ) не більше t i ( P ). Основна ідея полягає в тому, що на кожному кроці ми переходимо від поточної сторінки до кращої, допускаючи ймовірність залишатися на тій самій сторінці приблизно 1/ j , де j – це приблизно середній рейтинг поточної сторінки.
MC2
Якщо поточний стан – сторінка P , то наступний стан вибирається шляхом спочатку рівномірного вибору ранжування t з усіх часткових списків t1 , ..., tk , що містять P , а потім рівномірного вибору сторінки Q з множини всіх сторінок Q таким чином, що t ( Q ) не перевищує t ( P ). Цей ланцюг враховує той факт, що ми маємо кілька списків ранжування, а не просто набір попарних порівнянь між сторінками. Як наслідок, MC2, можливо, є найбільш репрезентативним для точок зору меншості, що має достатню статистичну значущість; він також захищає погляди спеціалістів. Фактично, MC2 узагальнює аналог геометричного середнього методу Борди. Для повних списків, якщо початковий стан вибирається рівномірно випадковим чином, після одного кроку MC2 розподіл, індукований на його станах, створює ранжування сторінок таким чином, що P має вищий ранг (бажаний) Q тоді і тільки тоді, коли геометричне середнє рангів P нижче за геометричне середнє рангів Q.
MC3
Якщо поточний стан – сторінка P , то наступний стан вибирається таким чином: спочатку рівномірно вибирається ранжування t з усіх часткових списків t1 , ..., tk , що містять P , потім рівномірно вибирається сторінка Q , ранжована за t . Якщо t ( Q ) < t ( P ) , то перехід до Q , інакше залишаються в P. Цей ланцюг є узагальненням методу Борда . Для повних списків, якщо початковий стан вибирається рівномірно випадковим чином, після одного кроку MC3 розподіл, індукований на його станах, створює ранжування сторінок таким чином, що P має вищий ранг, ніж Q , якщо і тільки тоді, коли оцінка Борда P вища, ніж оцінка Борда Q. Це природно, враховуючи, що в будь-якому стані P ймовірність залишатися в P приблизно дорівнює частці парних змагань (з усіма іншими сторінками), які P виграв, що є дуже подібною до міри Борда.
MC4
Якщо поточний стан – сторінка P , то наступний стан вибирається таким чином: спочатку рівномірно вибирається сторінка Q з об'єднання всіх сторінок, ранжованих пошуковими системами. Якщо t ( Q ) < t ( P ) для більшості списків t , які ранжували як P , так і Q , то перехід до Q , інакше залишається в P. Цей ланцюг узагальнює пропозицію Коупленда щодо сортування кандидатів за кількістю виграних ними попарних мажоритарних змагань [Коупленд, 1951 ] .
Існують приклади, які відрізняють поведінку цих ланцюгів. Можна також показати, що марківське впорядкування, яке мається на увазі під цими ланцюгами, не обов'язково задовольняє розширений принцип Кондорсе.
5 застосувань
Ми розглядаємо кілька застосувань наших методів агрегації рангів у контексті пошуку та вилучення даних загалом, і в Інтернеті зокрема. У наступних розділах ми представляємо п'ять основних застосувань наших методів.
5.1 Мета-пошук
Метапошук — це проблема побудови метапошукової системи, яка використовує результати кількох пошукових систем для створення зібраної відповіді. Існує кілька метапошукових систем (наприклад, [Metacrawler] ), і багато користувачів Інтернету створюють власні метапошукові системи. Як ми зазначали раніше, проблема побудови хорошої метапошукової системи рівнозначна отриманню хорошої функції агрегації рангів для часткових та перших d- списків. Враховуючи різні стратегії сканування, політики індексації та функції ранжування, що використовуються різними пошуковими системами, метапошукові системи корисні в багатьох ситуаціях.
Фактичний успіх метапошукової системи безпосередньо залежить від методу агрегації, що лежить в її основі. Оскільки методи, запропоновані в розділі 4, працюють з частковими списками та списками top -d , їх можна застосувати для побудови метапошукової системи. Ідея проста: для запиту отримати (скажімо) 100 найкращих результатів з багатьох пошукових систем, застосувати функцію агрегації рангів, де універсальним елементом є об'єднання сторінок, повернутих пошуковими системами, та повернути (скажімо) 100 найкращих результатів агрегації. Ми ілюструємо цю схему в розділі 6.2.1 та досліджуємо ефективність наших методів.

5.2 Агрегація функцій ранжування
Враховуючи колекцію документів, проблема індексації полягає в наступному: зберігати документи таким чином, щоб за заданим пошуковим терміном можна було легко знайти ті, що найбільш релевантні йому. Це класична проблема пошуку інформації, яка досить добре зрозуміла для статичних документів (див. [Salton 1989] ). Однак, коли документи є гіпертекстовими документами, алгоритми індексації можуть використовувати прихований зв'язок між документами, що мається на увазі під гіперпосиланнями. В Інтернеті такий підхід вже виявився надзвичайно успішним [Kleinberg 1998, 1999] , [Chakrabarti et al. 1998] , [Brin and Page 1998] .
Один поширений метод індексації полягає у побудові функції ранжування . Стосовно запиту, функція ранжування може працювати двома способами: (i) вона може надати документу абсолютну оцінку, що вказує на релевантність документа запиту (на основі оцінки), або (ii) вона може взяти два документи та ранжувати їх відносно запиту (на основі порівняння). На основі використаної базової методології можна отримати багато конкуруючих функцій ранжування. Наприклад, підрахунок термінів дає просту функцію ранжування. Інша функція ранжування може бути наслідком застосування моделі векторного простору та відповідної міри відстані до колекції документів. Іншими функціями ранжування можуть бути ті, що маються на увазі в PageRank [Brin and Page 1998] та Clever [Kleinberg 1998, 1999] , [Chakrabarti et al. 1998] . Важливо зазначити, що якщо функція ранжування базується на оцінці, то впорядкування, яке мається на увазі під оцінками, має більше сенсу, ніж самі фактичні оцінки, які часто є або безглуздими, або неточними. І для певної функції ранжування та запиту часто простіше повернути кілька найрелевантніших документів, ніж ранжувати всю базу документів.

Враховуючи багато функцій ранжування для однієї бази документів, ми маємо випадок d найкращих списків, де d – кількість документів, повернутих кожною з функцій ранжування. Наші методи можна застосувати для отримання гарної агрегації цих функцій ранжування. Зверніть увагу, що ми надаємо однакову вагу всім функціям ранжування, але це можна легко змінити за потреби.

Таке агрегування рангів може бути корисним і в інших сферах: багато систем бронювання авіаквитків страждають від відсутності можливості висловлювати вподобання. Якщо система достатньо гнучка, щоб дозволити користувачеві вказувати різні критерії уподобань (дати/час подорожі, місця біля вікна/проходу, кількість зупинок, вподобання для часто літаючих пасажирів, повернення/неповернення коштів за придбаний квиток і, звичайно, ціна), вона може ранжувати доступні плани перельотів на основі кожного з критеріїв та застосовувати методи агрегації рангів, щоб надати користувачеві результати кращої якості. Аналогічно, під час вибору ресторанів з бази даних ресторанів користувачі можуть ранжувати ресторани на основі кількох різних критеріїв (кухня, відстань для поїздки, атмосфера, зірковий рейтинг, рейтинг у доларах тощо). В обох прикладах користувачі можуть бути готові піти на компроміс з одним або кількома з цих критеріїв, за умови, що є явна перевага порівняно з іншими. Насправді, дуже часто навіть немає чіткого порядку важливості серед критеріїв. Гарна функція агрегації є дуже ефективним способом зробити вибір у таких випадках.

5.3 Зменшення спаму
Як ми обговорювали раніше, розширений принцип Кондорсе є розумним засобом від спаму. Використовуючи техніку локальної кеменізації, легко взяти будь-який метод агрегації рангів та налаштувати його результат, щоб він відповідав розширеному принципу Кондорсе. Фактично, ми пропонуємо це як загальний метод зменшення спаму в пошукових системах або метапошукових системах: застосуйте улюблену агрегацію рангів, щоб отримати початковий рейтинг, а потім застосуйте локальну кеменізацію. Цей додатковий крок є недорогим з точки зору обчислювальних витрат, але має перевагу зменшення спаму шляхом ранжування переможців Кондорсе нижче переможців Кондорсе. Знову ж таки, ми ілюструємо це застосування в розділі 6.2.2 на прикладах.
5.4 Методи асоціацій слів
Різні пошукові системи та портали мають різну (за замовчуванням) семантику обробки багатослівного запиту. Наприклад, Altavista, здається, використовує семантику АБО (достатньо, щоб документ містив один із заданих термінів запиту, щоб його було розглянуто), тоді як Google, здається, використовує семантику І (обов'язково, щоб усі слова запиту були присутні в документі, щоб його було розглянуто). Як обговорювалося в розділі 1.2 , обидва ці сценарії є незручними в багатьох ситуаціях.
Багато з цих завдань можна виконати за допомогою складного логічного запиту (через розширений запит), але ми вважаємо нерозумним очікувати, що пересічний користувач Інтернету підпишеться на це. Зауважте також, що простий запит на документи, які містять якомога більше ключових слів, не обов'язково є гарним рішенням: найкращий документ на тему може містити лише три ключові слова, тоді як спам-документ цілком може містити чотири ключові слова. Як конкретний мотивуючий приклад розглянемо пошук вакансії інженера-програміста в онлайн-базі даних вакансій. Користувач перераховує низку навичок та низку потенційних ключових слів в описі вакансії, наприклад, «Алгоритми Кремнієвої долини C++ Java CORBA TCP-IP запуск опціонів на акції перед IPO» . Зрозуміло, що правило «І» може не призвести до жодного документа, а правило «АБО» є таким же катастрофічним.

Ми пропонуємо схему асоціації слів для обробки таких ситуацій. Маючи набір слів запиту w1 , ..., wl , ми пропонуємо побудувати кілька (скажімо, k ) підзапитів, які є підмножинами вихідних слів запиту. Ми запитуємо пошукову систему з цими k підзапитами (використовуючи семантику AND) та отримуємо k перших d (скажімо, d = 100) результатів для кожного з підзапитів. Потім ми можемо використовувати методи з розділів 3 та 4, щоб отримати локально кеменізовану агрегацію перших d списків та вивести її як остаточну відповідь, що відповідає багатословному запиту. На прикладах ми ілюструємо це застосування в розділі 6.2.3 .

Звідки беруться ці слова?
Один із способів отримати такий набір слів запиту – це запропонувати користувачеві пов’язати якомога більше термінів із бажаною відповіддю. Це може бути занадто обтяжливо для типового користувача. Менш вимогливий спосіб – дозволити користувачеві виділити деякі слова в поточному документі; пошуковий термін потім витягується з «якірного тексту», тобто слів навколо вибраних слів.

5.5 Порівняння пошукових систем
Наші методи також передбачають природний спосіб порівняння продуктивності різних пошукових систем. Основна ідея полягає в тому, що пошукову систему можна назвати хорошою, коли вона поводиться як найменш шумний експерт для запиту. Іншими словами, хороша пошукова система – це та, яка близька до агрегованого рейтингу. Це узгоджується з нашим попереднім уявленням про те, що таке експерт і як поводитися з шумними експертами. Таким чином, процедура ранжування самих пошукових систем (щодо запиту) така: отримати агрегацію рангів результатів з різних пошукових систем і ранжувати пошукові системи на основі їхньої відстані (за Кендаллом або футрулом) до агрегованого рейтингу.
6 Експерименти та результати
6.1 Інфраструктура
Ми провели три типи експериментів. Перший експеримент полягає у створенні метапошукової системи з використанням різних методів агрегації ( Розділ 4 ) та порівнянні їхньої ефективності. Другий експеримент має проілюструвати вплив наших методів у боротьбі зі спамом. Третій експеримент має проілюструвати метод асоціації слів для багатослівних запитів. Хоча ми надаємо числові значення для першого експерименту, ми наводимо фактичні приклади для другого та третього експериментів.
Ми використовуємо такі сім пошукових систем: Altavista (AV), Alltheweb (AW), Excite (EX), Google (GG), Hotbot (HB), Lycos (LY) та Northernlight (NL). Для кожної пошукової системи ми зосередилися лише на 100 найпопулярніших запитах. Наші вимірювання відстані стосуються об'єднання 100 найпопулярніших результатів з цих пошукових систем.

Для вимірювання ефективності наших методів (перший експеримент) ми вибрали наступні 38 загальних запитів (ці запити є надмножиною 28 запитів, що використовувалися в кількох попередніх статтях [Bharat and Henzinger 1998] , [Chakrabarti et al. 1998] ). Для другого експерименту ми вибрали деякі запити, які були засипані популярними пошуковими системами. Для третього експерименту ми вибрали багатослівні запити, які погано працюють в існуючих пошукових системах. Наше уявлення про те, що два URL-адреси є ідентичними, є суто синтаксичним (до певної канонічної форми); ми не використовуємо вміст сторінки, щоб визначити, чи є два URL-адреси ідентичними.

6.2 Результати
6.2.1 Метапошук
Запити, які ми обрали для нашого експерименту:
позитивна дискримінація, алкоголізм, парки розваг, архітектура, їзда на велосипеді, блюз, сир, цитрусові гаї, класична гітара, комп'ютерний зір, круїзи, Долина Смерті, хокей на траві, садівництво, графічний дизайн, війна в Перській затоці, ВІЛ, Ява, Ліпарі, хвороба Лайма, взаємні фонди, національні парки, паралельна архітектура, Пенелопа Фіцджеральд, переробка банок, скелелазіння, Сан-Франциско, Шекспір, колекціонування марок, суші, настільний теніс, дистанційна робота, туризм у Таїланді, вінтажні автомобілі, вулкан, дзен-буддизм та Зенер.
Середнє значення перетину у першій сотні для будь-якої пари пошукових систем наведено в Таблиці 1 , яка показує кількість сторінок як функцію кількості пошукових систем, у яких вони присутні. Наприклад, четвертий стовпець у таблиці означає, що 27 231 сторінок (в середньому) були присутні рівно у трьох результатах пошукової системи. Другий стовпець вказує на те, що близько 284 сторінок були присутні лише в одній пошуковій системі, тоді як останній стовпець вказує на те, що менше 2 сторінок було присутніх у всіх пошукових системах.
 
 
Таблиця 1: 
Перекриття результатів 7 пошукових систем.
 
# двигуни	1	2	3	4	5	6	7
# сторінок	284,5	84,0	27.2	12.9	8.1	4.7	1.8
 
 Результати нашого першого експерименту представлені в таблиці 2. Продуктивність розраховується з точки зору трьох показників відстані, описаних у розділі 2.1.1 . Кожен рядок відповідає методу, представленому в розділі 4. До результату кожного з цих методів було застосовано локальну кеменізацію (LK).
 
 
Таблиця 2: 
Продуктивність різних методів агрегації рангів для метапошуку. 
LK позначає локальну кеменізацію. 
 
 	
Рік Кендалла 	
Рік Кендалла 	Індуковане 
правило ніг	Індуковане 
правило ніг	Масштабована 
футрула	Масштабована 
футрула
 	Ні, ЛК	З ЛК	Ні, ЛК	З ЛК	Ні, ЛК	З ЛК
Край	0,221	0,214	0,353	0,345	0,440	0,438
СФО	0,112	0,111	0,168	0,167	0,137	0,137
МС1 	0,133	0,130	0,216	0,213	0,292	0,291
МС2 	0,131	0,128	0,213	0,210	0,287	0,286
МС3 	0,116	0,114	0,186	0,183	0,239	0,239
МС4 	0,105	0,104	0,151	0,149	0,181	0,181
 
 
6.2.2 Зменшення спаму
Далі ми наводимо окремі докази зменшення спаму за допомогою наших методів. Ми використовуємо такі запити: фен-шуй, органічні овочі, садівництво . Для кожного з цих запитів ми розглядаємо (найкращі) сторінки, які вважаємо спамом. Зверніть увагу, що наше визначення спаму не означає зло! --- просто, на нашу думку, ці сторінки отримали незаслужено високий рейтинг від однієї або кількох пошукових систем . Легко знайти URL-адреси, які заспамлювали одну пошукову систему. З іншого боку, нас цікавили URL-адреси, які заспамлювали щонайменше дві пошукові системи --- враховуючи, що перекриття між пошуковими системами було не дуже високим, це виявилося складним завданням. У таблиці 3 представлені наші приклади: записи – це рейтинг у списках окремих пошукових систем. Порожній запис у таблиці вказує на те, що URL-адреса не була повернута пошуковою системою як одна з 100 найкращих. На основі результатів розділу 6.2.1 ми обмежуємо нашу увагу SFO та MC4 з локальною кеменізацією.
 
 
Таблиця 3: 
Рейтинги «спам-»-сторінок за запитами: 
фен-шуй, органічні овочі та садівництво .
 
URL-адреса	З	AW	ГГ	ГБ	ЛІ	Нідерланди	СФО	МС4 
www.lucky-bamboo.com 	4	43	 	 	41	 	144	63
www.cambriumcrystals.com 	 	9	51	 	5	 	31	59
www.luckycat.com 	11	14	26	 	13	 	49	36
www.davesorganics.com 	84	19 років	1	 	17 років	 	77	93
www.frozen.ch 	 	9	 	63	11	 	49	121
www.eonseed.com 	 	18 років	 	6	16	 	23	66
www.augusthome.com 	26	16	 	27	12	16	57	54
www.taunton.com 	 	25	 	 	21 рік	 	78	67
www.egroups.com 	 	34	 	 	29	 	108	101
 
 
6.2.3 Асоціації слів
Ми використовуємо Google для проведення наших експериментів з асоціаціями слів. Як зазначалося раніше, Google використовує семантику AND, і тому для багатьох цікавих багатослівних запитів кількість або якість повернутих сторінок не дуже висока. З іншого боку, той факт, що він використовує семантику AND, зручний для роботи, коли ми надаємо невеликі підмножини багатослівного запиту відповідно до правила асоціації слів, описаного раніше. Запити, 5 найкращих результатів від Google та деякі з найкращих результатів від SFO та MC4 (після локальної кеменізації) наведено в Таблиці 4 , Таблиці 5 та Таблиці 6. Ми вибрали кожну пару термінів у багатослівному запиті для створення кількох списків та застосування до цих списків агрегації рангів (SFO та MC4).
 
 
Таблиця 4: 
Результати для запиту: Ріман, Гольдбах, Ферма, Пуанкаре ( 
математики, пов'язані з відомими гіпотезами) 
 
Google 
raphael.math.uic.edu/jeremy/poetry.htm  
www-groups.dcs.st-and.ac.uk/history/Search/historysearch.cgi?  
www.galstar.com/ichudov/ppl/ap/File1993_11-12.html  
www.mathe.tu-freiberg.de/hebisch/cafe/lebensdaten.html  
www.math.snu.ac.kr/mhkim/a-fermat2.html 
СФО з ЛК 
www.ams.org/bookstore  
www.mathsoft.com/asolve/constant/hrdyltl/goldbach.html  
www.omega23.com/mathematics_physics_papers/Riemann.html  
www.omega23.com/mathematics_physics_papers/Poincaré.html  
www.informatik.uni-giessen.de/staff/richstein/ca/Goldbach.html 
MC4 з LK 
www.omega23.com/mathematics_physics_papers/Poincare.html  
www.ams.org/bookstore  
www.mbay.net/cgd/flt/flt01.htm  
mathpuzzle.com/riemann.html  
rendezvous.com/tangledweb/conferences/fermat/romance.html 
 
 
 
Таблиця 5: 
Результати для: мадрас, мадурай, коїмбатор, веллор ( 
міста штату Тамілнад, Індія) 
 
Google 
www.mssrf.org/Fris9809/location-tamilnadu.html  
www.indiaplus.com/Info/schools.html  
www.focustamilnadu.com/tamilnadu/Policy%20Note ...Ліси.html  
www.tn.gov.in/policy/environ.htm  
www.indiacolleges.com/Tamil_Nadu.htm 
СФО з ЛК 
www.madurai.com  
www.ozemail.com.au/clday/locations.htm  
www.utoledo.edu/homepages/speelam/coimbatore.html  
www.ozemail.com.au/clday/madras.htm  
www.madurai.com/around.htm  
www.indiatraveltimes.com/tamilnadu/tamil1.html 
MC4 з LK 
www.madurai.com  
www.surfindia.com/omsakthi/tourism.htm  
www.indiatraveltimes.com/tamilnadu/tamil1.html  
www.indiatraveltimes.com/tamilnadu/tamil2.html  
www.indiatravels.com/forts/vellore_fort.htm  
www.india-tourism.de/english/south/tamil_nadu.html 
 
 
 
Таблиця 6: 
Результати для: еолійські пороми Ліпарі Стромболі судна на підводних крилах ( 
пов'язані з подорожами італійськими/грецькими островами) 
 
Google 
www.nautica.it/charter/eolie__e.htm  
rozzo.tripod.com/filicudi1.htm  
www.corfu1.com/b33.htm  
circle.kenyon.edu/publications/bulletin/19_4/kcabmill.htm  
www.netnet.it/english/Salina/index  
www.initaly.com/regions/seaside/diving.htm 
СФО з ЛК 
www.cs.brown.edu/people/sml/lipari.scenes.html  
www.gogreece.about.com/cs/hydrofoilsferries  
pharma.unime.it/rdpa/Link/HowReachlipar.htm  
www.travel-italy.com/library/feature_articles/aeolian_islands_lipari.html  
www.travel-italy.com/library/feature_articles/aeolian_islands_stromboli.html  
www.gardenroute.co.za/strombolis  
www.travel-italy.com/library/feature_articles/aeolian_island_an_intro.html 
MC4 з LK 
www.cs.brown.edu/people/sml/lipari.scenes.html  
www.gogreece.about.com/cs/hydrofoilsferries  
www.travel-italy.com/library/feature_articles/aeolian_islands_stromboli.html  
www.gate1travel.com/Destinations/Greece/Misc/gre_ferry.htm  
www.travel-italy.com/library/feature_articles/aeolian_islands_lipari.html  
www.participez.com/reports/recits/vulcano.htm  
www.travel-italy.com/library/feature_articles 
 
 
6.3 Обговорення
З усіх методів MC4 перевершує всі інші. Фактично, він значно перевершує метод Борди. Це дуже цікаво, оскільки метод Борди є звичайним вибором агрегації і, мабуть, найприроднішим. Масштабоване правило футрула та MC3 (узагальнення Борди) здаються нарівні. Нагадаємо, що процедура правила футрула для часткових списків була лише евристичною модифікацією процедури правила футрула для повних списків. Наведені вище експериментальні дані свідчать про те, що ця евристика дуже хороша. MC1 та MC2 завжди гірші за інші ланцюги Маркова, але вони однозначно кращі за метод Борди.
Загалом, локальна кеменізація, здається, покращує приблизно на 1-3% з точки зору вимірювань відстані. Можна формально показати, що локальна кеменізація ніколи не погіршується в тому сенсі, що відстань Кендалла ніколи не погіршується після локальної кеменізації. Цікаво, що це, здається, вірно навіть для відстаней за правилом футів та масштабованих відстаней за правилом футів (хоча ми не знаємо, чи це завжди так). Ми робимо висновок, що процедуру локальної кеменізації завжди варто застосовувати: або покращення велике, а якщо ні, то витрачений час невеликий.

Розглядаючи результати в розділі 6.2.2 , ми бачимо, що SFO та MC4 досить ефективні в боротьбі зі спамом. Хоча ми не стверджуємо, що наші методи повністю усувають спам, наше дослідження показує, що вони зменшують спам загалом.

Результати, наведені в розділі 6.2.3, показують, що наша техніка асоціації слів у поєднанні з методами агрегації рангів може покращити якість результатів пошуку для багатослівних запитів. У кожному з трьох представлених прикладів Google зазвичай видавав загалом лише близько 10-15 сторінок, а 5 перших результатів часто були дуже поганими (прямий наслідок семантики AND, що використовувалася для довгого списку). Натомість URL-адреси, отримані за допомогою методів агрегації рангів, виявилися багатими на інформацію про тему запиту.

7 Висновки та подальша робота
Ми розробили теоретичну основу для опису та оцінки методів агрегації рангів. Ми запропонували та протестували кілька методів агрегації рангів. Наші методи мають перевагу в тому, що вони застосовні в різних контекстах, і ми намагаємося використовувати якомога більше доступної інформації. Методи також виявляються простими в реалізації, не мають обчислювальних витрат і перевершують популярні класичні методи, такі як метод Борди. Ми встановили значення розширеного критерію Кондорсе в контексті метапошуку та описали простий процес, локальну кеменізацію, для забезпечення задоволення цього критерію.
Подальша робота передбачає спробу отримати якісне розуміння того, чому методи ланцюгів Маркова працюють так добре. Також буде цікаво виміряти ефективність наших методів на основі документів з кількома конкуруючими функціями ранжування. Зрештою, ця робота виникла в результаті розмов з Хелен Ніссенбаум про упередженість у пошуку. Формальне трактування упередженості здається складним, але привабливим.

Посилання
1.
Спостереження за пошуковою системою

www.searchenginewatch.com

2.
Стаття про перевірку пошукової системи

www.searchenginewatch.com/sereport/00/11-inclusion.html

3.
Метакраулер

www.metacrawler.com

4.
К. Бхарат та М. Хензінгер.

Покращені алгоритми для дистиляції тем у гіперпосилальному середовищі.
ACM SIGIR , сторінки 104-111, 1998.

5.
Дж. Дж. Бартольді, К. А. Тові та М. А. Трік.

Схеми голосування, за якими важко сказати, хто переміг на виборах.
Соціальний вибір і добробут , 6(2):157--165, 1989.

6.
Джей Едж.

Меморандум про вибори шляхом бюлетенів.
Історія Королівської академії наук , 1781.

7.
С. Брін та Л. Пейдж.

Анатомія великомасштабної гіпертекстової пошукової системи в Інтернеті.
Комп'ютерні мережі , 30(1-7):107--117, 1998.

8.
С. Чакрабарті, Б. Дом, Д. Гібсон, Р. Кумар, П. Рагхаван, С. Раджагопалан та А. Томкінс.

Експерименти з тематичної дистиляції.
Матеріали семінару ACM SIGIR з пошуку гіпертекстової інформації в Інтернеті , 1998.

9.
М.-Ж. Кондорсе.

Есе про застосування аналізу до ймовірності рішень, прийнятих більшістю голосів , 1785.

10.
А. Г. Коупленд.

A reasonable social welfare function.
Mimeo, University of Michigan, 1951.

11.
D. E. Critchlow.

Metric Methods for Analyzing Partially Ranked Data,
Lecture Notes in Statistics 34, Springer-Verlag, 1985.

12.
P. Diaconis.

Group Representation in Probability and Statistics.
IMS Lecture Series 11, Institute of Mathematical Statistics, 1988.

13.
P. Diaconis and R. Graham.

Spearman's footrule as a measure of disarray.
Journal of the Royal Statistical Society, Series B, 39(2):262--268, 1977.

14.
G. Even, J. Naor, B. Schieber, and M. Sudan.

Approximating minimum feedback sets and multicuts in directed graphs.
Algorithmica, 20(2):151--174, 1998.

15.
R. Fagin.

Combining Fuzzy information from multiple systems.
Journal of Computer and System Sciences, 58(1):83--99, 1999.

16.
J. Kleinberg.

Authoritative sources in a hyperlinked environment.
Journal of the ACM, 46(5):604--632, 1999.
A preliminary version appeared in Proc. ACM-SIAM Symposium on Discrete Algorithms, 1998.

17.
J. I. Marden.

Analyzing and Modeling Rank Data.
Monographs on Statistics and Applied Probability, No 64, Chapman & Hall, 1995.

18.
Media Metrix search engine ratings.

www.searchenginewatch.com/reports/mediametrix.html

19.
D. G. Saari.

The mathematics of voting: Democratic symmetry.
The Economist, pp. 83, March 4, 2000.
Article available at jmvidal.ece.sc.edu/822/papers/econ-voting.html

20.
G. Salton.

Automatic Text Processing---the Transformation, Analysis, and Retrieval of Information by Computer.
Addison-Wesley, 1989.

21.
J. H. Smith.

Aggregation of Preferences with Variable Electorate.
SIAM Journal on Applied Mathematics, 41:1027--1041, 1973.

22.
M. Truchon.

An extension of the Condorcet criterion and Kemeny orders.
cahier 98-15 du Centre de Recherche en Economie et Finance Appliquees, 1998.

23.
H. P. Young.

An axiomatization of Borda's rule.
Journal of Economic Theory, 9:43--52, 1974.

24.
H. P. Young.

Condorcet's theory of Voting.
American Political Science Review, 82:1231--1244, 1988.

25.
H. P. Young and A. Levenglick.

A consistent extension of Condorcet's election principle.
SIAM Journal on Applied Mathematics, 35(2):285--300, 1978.
 
Appendix A: Local Kemenization
We begin with a formal definition:
Definition 5
A permutation p is a locally Kemeny optimal aggregation of partial lists t1, t2, ..., tk, if there is no permutation p' that can be obtained from p by performing a single transposition of an adjacent pair of elements and for which    K(p', t1, t2, ..., tk) < K(p, t1, t2, ..., tk). In other words, it is impossible to reduce the total distance to the t's by flipping an adjacent pair.
Note that the above definition is not equivalent to requiring that no flipping of any (not necessarily adjacent) pair will decrease the sum of the distances to the t's.
Example 1 p = (1,2,3), t1 = (1,2), t2 = (2,3), t3 = t4 = t5 = (3,1).
We have that p satisfies Definition 5, K(p, t1, t2, ..., t5)= 3, but transposing 1 and 3 decreases the sum to 2.

Every Kemeny optimal permutation is also locally Kemeny optimal, but the converse does not hold (cf. Example 1). Furthermore, a locally Kemeny optimal permutation is not necessarily a good approximation for the optimal. For example, if the t's are as in Example 1, the number of (3,1) partial lists is very large, and there is only one occurrence of each of the partial lists (1,2) and (2,3), then (1,2,3) is still locally Kemeny optimal, but the ratio (of the K-distances) to the optimal may be arbitrarily large. Nevertheless, the important observations, proved next, are that a locally Kemeny optimal aggregation satisfies the extended Condorcet property and can be computed efficiently.

Convention. Recall our convention that p ranks x above y (i.e., prefers x to y) whenever p(x) < p(y).

Lemma 6
Let p, a permutation on alternatives {1, ..., n}, be a locally Kemeny optimal aggregation for partial lists t1, t2, ..., tk. Then p satisfies the extended Condorcet criterion with respect to t1, t2, ..., tk.
Proof
If the lemma is false then there exist partial lists t1, t2, ..., tk, a locally Kemeny optimal aggregation p, and a partition (T,U) of the alternatives where for all a in T and b in U the majority among t1, t2, ..., tk prefers a to b, but there are c in T and d in U such that p(d) < p(c). Let (d,c) be a closest (in p) such pair. Consider the immediate successor of d in p, call it e. If e=c then c is adjacent to d in p and transposing this adjacent pair of alternatives produces a p' such that K(p', t1, t2, ..., tk) < K(p, t1, t2, ..., tk), contradicting the assumption that p is a locally Kemeny optimal aggregation of the t's. If e does not equal c, then either e is in T, in which case the pair (d,e) is a closer pair in p than (d,c) and also violates the extended Condorcet condition, or e is in U, in which case (e,c) is a closer pair than (d,c) that violates the extended Condorcet condition. Both cases contradict the choice of (d,c).
The set t1, t2, ..., tk of partial lists defines a directed majority graph G on the n alternatives, with an edge (x,y) from x to y if a majority of the t's that contain both x and y rank x above y.
Lemma 7
Locally Kemeny optimal aggregations of k lists can be computed in O( kn log n) time.
Proof
It is not surprising that locally Kemeny optimal aggregations can be found in polynomial time because they are only local minima. A straightforward approach requires O(n2) time; we describe a technique requiring only O( kn log n) time (generally, we are interested in the case in which k is much smaller than n).
Consider the majority graph T for t1, t2, ..., tk with anti-parallel edges in the case of a tie. The problem of finding a locally Kemeny optimal aggregation of t1, t2, ..., tk is now equivalent to finding a Hamiltonian path in this graph. Due to the density of the edges it is possible to find such a path in T in O( n log n) probes to the edges of T using, for instance, a mergesort-like algorithm (the advantage of using mergesort is that the issue of inconsistent answers never arises, which simplifies the execution of the algorithm). Note that T need not be constructed explicitly. The cost of each probe is k accesses to the partial lists (to find out whether there is a majority), so the resulting complexity is O( kn log n).

We next turn to the details of the local Kemenization procedure. Recall that the value of local Kemenization is that, given an aggregation m of several rankings, it produces a ranking p that achieves the best of both worlds: p satisfies the extended Condorcet criterion, and p is maximally consistent with m. We begin by formalizing our notion of consistency.
Definition 8
Given partial lists t1, t2, ..., tk, and a total order m we say that p is consistent with m and t1, t2, ..., tk if p(i) < p(j) implies that either
      (a) m(i) < m(j)
or
      (b) a majority of t1, t2, ..., tk prefer i to j (more prefer i over j than j over i, but not necessarily an absolute majority).
In other words, the order of two elements differs between m and p only if a majority of the t's support the change (however, consistency does not mandate a switch).
Note that if p is consistent with m and t1, t2, ..., tk, then

K(p, t1, t2, ..., tk) < K(m, t1, t2, ..., tk),
since the only allowed changes decrease the distance to the t's.
The proof of the next lemma is straightforward from Definition 8.

Lemma 9
If p is consistent with m and t1, t2, ..., tk, then for any 1 < l < n, if S is the set of l alternatives ranked most highly by m, the projection of p onto S is consistent with the projections of m and t1, t2, ..., tk onto S.
As we will see, for any partial lists t1, t2, ..., tk, and order m there is a permutation p that is (i) locally Kemeny optimal and (ii) consistent with m. (Such a p is not necessarily unique.) We will focus particularly on m-consistent locally Kemeny optimal aggregations that, when restricted to subsets S of the most highly ranked elements in m, retain their local Kemeny optimality (Definition 10 below). This is desirable whenever we are more sure of the significance of the top results in m than the bottom ones. In this case the solution is unique (Theorem 11).
Definition 10
Given partial lists t1, t2, ..., tk and a total order m on alternatives {1,2, ..., n}, we say that p is a local Kemenization of m with respect to t1, t2, ..., tk, if (1) p is consistent with m and (2) if we restrict attention to the set S consisting of the 1 < l < n most highly ranked alternatives in m, then the projection of p onto S is a locally Kemeny optimal aggregation of the projections of t1, t2, ..., tk onto S.
Theorem 12
For any partial lists t1, t2, ..., tk and order m on alternatives {1, ..., n}, there exists a unique local Kemenization of m with respect to t1, t2, ..., tk.
Proof
We prove the theorem by induction on n, the number of alternatives. The base case n=1 is trivial. Assume the statement inductively for n-1. We will prove it for n. Let x be the last (lowest-ranked) element in m and let S = {1, ..., n}-{x}. Since S is of size n-1, we have by induction that there is a unique permutation pn-1 on the elements in S satisfying the conditions of the theorem. Now insert the removed element x into the lowest-ranked "permissible" position in pn-1: just below the lowest-ranked element y such that such that (a) no majority among the (original) t's prefers x to y and (b) for all successors z of y (i.e., pn-1(y) < pn-1(z)) there is a majority that prefers x to z. Clearly no two elements of m were switched unnecessarily and the solution, p, is locally Kemeny optimal from the local Kemeny optimality of pn-1 and the majority properties. Note that the consistency condition requires that x be as low in p as local Kemeny optimality permits, so given pn-1 there is only one place in which to insert x.
Suppose now that m and t1, t2, ..., tk contradict uniqueness: there are two different local Kemenizations of m with respect to t1, t2, ..., tk; call them p and p'. If we drop the last element x in m and let S be as above, then (by property (ii) of local Kemenization) the resulting permutations pn-1 and p'n-1 must each be local Kemenizations of the restrictions of the t's to S and (by property (i) and Lemma 9) they must be consistent with the restriction of m to S. By the induction hypothesis pn-1 = p'n-1 As argued above, there is only one place to insert x into this list.

The algorithm suggested by this proof may take O(n2 k) time in the worst case (say a transitive tournament where m is the anti-transitive order). However, in general it requires time proportional to the Kendall distance between m and the solution. We do not expect m to be uncorrelated with the solution and therefore anticipate better performance in practice.
Appendix B: Complexity of Kemeny optima
In this section, we study the complexity of finding a Kemeny optimal permutation. We show that computing a Kemeny optimal permutation is NP-hard, even when the input consists of four full lists t1, t2, t3, t4. ..., For partial lists of length 2 finding a Kemeny optimal solution is exactly the same problem as finding a minimum feedback arc set, and hence is NP-hard (see [Even et al. 1998] for approximation results). The problem is also known to be NP-hard for an unbounded number of complete lists [Bartholdi et al. 1989].
We remark that computing a Kemeny optimal permutation for two lists is trivial --- simply output one of the input lists. The complexity of computing a Kemeny optimal permutation for three full lists is open; we show later in this section that this problem is reducible to the problem of finding minimum feedback edge sets on tournament graphs, which, as far as we know, is open as well.

Computing a Kemeny optimal permutation for an unbounded number of partial lists is easily seen to be NP-hard by a straightforward encoding of the feedback edge set problem: for each edge (i,j), create a partial list of two elements: i followed by j.

Theorem 11
The problem of computing a Kemeny optimal permutation for a given collection of k full lists, for even integers k >= 4, is NP-hard. The corresponding decision problem is NP-complete.
Proof
The reduction is from the feedback edge set problem. Given a directed graph G = (V,E), and an integer L >= 0, the question is whether there exists a subset F of E such that |F| < L and (V, E-F) is acyclic. Let n = |V| and m = |E|. Given G, we first produce a graph G' = (V', E') by "splitting" each edge of G into two edges; formally, let V' denote the union of V and the set {ve : e is in E} and E' = {(i, vi,j), (vi,j, j) : (i,j) in E}. The easy fact that we will use later is that G has a feedback edge set of size L if and only if G' does.
Arbitrarily order all the vertices of G' so that the vertices in V receive the numbers 1, ..., n (and the vertices of the form ve receive numbers n+1, ..., n+m). Whenever we wish to refer to this ordering, we will denote it by Z. For a vertex i in V, let out(i) denote a listing of the out-neighbors of i in G' in the order prescribed by Z; similarly let in(i) denote the in-neighbors of i in G' in the order prescribed by Z. Note that none of the lists out(i) or in(i) contains any vertex from the original graph G. We now define four full lists on the set V'. For a list L, the notation Lr denotes the reversal of the list.

t1 = 1, out(1), 2, out(2), ..., n, out(n)
t2 = n, out(n)r, n-1, out(n-1)r, ..., 1, out(1)r
t3 = 1, in(1), 2, in(2), ..., n, in(n)
t4 = n, in(n)r, n-1, in(n-1)r, ..., 1, in(1)r
The idea is that in t1, each vertex in V precedes all its out-neighbors in G', but the ordering of the out-neighbors of a vertex, as well as the ordering of the vertex-neighbor groups are arbitrary (according to Z). The list t2 "cancels" the effect of this arbitrariness in ordering the neighbors of a vertex and the vertex-neighbor groups, while "reinforcing" the ordering of each vertex in V above its out-neighbors in G'. Similarly, in t3 and t4, each vertex of the original vertex set V is preceded by its in-neighbors in G', with suitably arranged cancellations of the artificial ordering among the other pairs.
The main claim is that G has a feedback edge set of size L if and only if there is a permutation p such that Sr  K(p, tr) < L', where L' = 2L + 2(n(n-1)/2 + m(m-1)/2 + m).

First suppose that G has a feedback edge set F of size L. It is easy to see that the set F' = {(i, vi,j) : (i,j) in F} is a feedback edge set of G', and |F'| = L. The graph (V', E'-F') is acyclic, so by topologically sorting the vertices of this graph, we obtain an ordering p of the vertices in V' such that for every (i,j) in E'-F', i is placed before j in p. We claim that p is an ordering that satisfies K(p, tr) < L'.

Note that regardless of how p was obtained, the last three terms are inevitable:

(1) for each pair i,j in V, exactly one of t1 and t2 places i above j and the other places j above i, so there is a contribution of 1 to K(p, t1) + K(p, t2); similarly, there is a contribution of 1 to K(p, t3) + K(p, t4). This accounts for the term 2n(n-1)/2.

(2) a similar argument holds for pairs ve, ve', and there are m(m-1)/2 such pairs, accounting for the term 2m(m-1)/2.

(3) a similar argument holds for pairs vi,j, j with respect to t1 and t2, and for pairs i, vi,j, with respect to t3 and t4. The total number of such pairs is 2m.

The only remaining contribution to the total distance of p from the t's comes from the i, vi,j pairs with respect to t1 and t2 (where i precedes vi,j in both lists), and the vi,j, j pairs with respect to t3 and t4 (where vi,j precedes j in both lists). Of these, a pair contributes 2 to the total Kemeny distance Sr  K(p, tr) precisely if it occurs as a "back edge" with respect to the topological ordering p of the vertices of G'; since (V', E'-F') is acyclic, the total number of such back edges is at most |F'| = L.

Conversely, suppose that there exists a permutation p that achieves a total Kemeny distance of at most L' = 2L + 2(n(n-1)/2 + m(m-1)/2 + m). We have already argued (in items (1), (2), and (3) above) that p must incur a distance of 2(n(n-1)/2 + m(m-1)/2 + m). with respect to the t's, the so the only extra distance between p and the t's comes from pairs of the form i, vi,j in t1 and t2, and of the form vi,j, j in t3 and t4. Once again, each such pair contributes either 0 or 2 to the total distance. Consider the pairs that contribute 2 to the distance, and let the corresponding set of edges in E' be denoted by F'. Now, (V', E'-F') is acyclic since every edge that remains in E'-F', by definition, respects the ordering in p. Thus F' is a feedback edge set of G' of size at most L', and the set F = {(i,j) : (i, vi,j) in F' OR (vi,j, j) in F'} is a feedback edge set of G of size at most L'.

This completes the proof that computing a Kemeny optimal permutation is NP-hard even when the input consists of four full lists. The proof for the case of even k, k > 4, is a simple extension: first produce four lists as above, then add (k-4)/2 pairs of lists s, sr, where s is an arbitrary permutation. This addition clearly preserves Kemeny optimal solutions; the distance parameter is increased by an additive (k-4) (n+m)(n+m-1)/4 term.