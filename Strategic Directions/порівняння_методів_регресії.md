# Звіт з порівняльного аналізу методів побудови лінійної регресії

## 1. Мета дослідження

Метою цього дослідження є:
- Побудова лінійної регресійної моделі методом найменших квадратів
- Порівняльний аналіз двох підходів до реалізації цього методу:
  - Сучасний підхід з використанням готових статистичних функцій (підхід 1)
  - Класичний підхід з безпосереднім обчисленням за формулами, як у MathCad (підхід 2)
- Оцінка якості отриманих моделей за різними характеристиками
- Виявлення переваг та недоліків обох підходів

## 2. Опис вихідних даних для побудови лінійних регресійних моделей

Для побудови лінійних регресійних моделей використано дані, що відповідають варіанту 4 завдання. Справжнє рівняння моделі має вигляд:

$y(x) = a_0 + a_1 \cdot x + rnd(b)$

де:
- $a_0 = 3.4$ - вільний член рівняння
- $a_1 = 2.7$ - коефіцієнт при незалежній змінній
- $rnd(b) = 1.10$ - максимальне значення випадкового шуму

В обох підходах було згенеровано однаковий набір даних, що складається з 20 точок у діапазоні значень $x$ від 0 до 10, з додаванням випадкового шуму в діапазоні $[-1.10, 1.10]$ до теоретичних значень $y_{теор} = 3.4 + 2.7 \cdot x$.

## 3. Порівняння методологій побудови лінійних регресійних моделей

### 3.1. Математичні формули та підходи

#### Підхід 1: Сучасний підхід з використанням готових функцій

У цьому підході використовуються готові функції з бібліотеки SciPy:

```python
from scipy import stats
slope, intercept, r_value, p_value, std_err = stats.linregress(x, y)
```

Функція `stats.linregress()` внутрішньо використовує формули методу найменших квадратів:

$$b_1 = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^n (x_i - \bar{x})^2}$$

$$b_0 = \bar{y} - b_1 \bar{x}$$

Довірчі інтервали обчислюються з використанням матриці коваріації параметрів, що дає більш точні, але вужчі інтервали.

#### Підхід 2: Класичний підхід за формулами MathCad

У цьому підході безпосередньо обчислюються всі проміжні значення:

```python
# Середні значення
x_mean = np.mean(x)
y_mean = np.mean(y)
x2_mean = np.mean(x**2)
xy_mean = np.mean(x * y)

# Коефіцієнти регресії
a1 = (xy_mean - x_mean * y_mean) / (x2_mean - x_mean**2)
a0 = y_mean - a1 * x_mean
```

Довірчі інтервали обчислюються за формулами:

$$S_{a0} = \sqrt{\frac{\sum_{i=0}^{n-1} X_i^2 \cdot \sum_{i=0}^{n-1} (Y_i - y_{ср})^2}{n \cdot (n-2) \cdot \sum_{i=0}^{n-1} (X_i - x_{ср})^2}}$$

$$S_{a1} = \sqrt{\frac{\sum_{i=0}^{n-1} (Y_i - y_{ср})^2}{(n-2) \cdot \sum_{i=0}^{n-1} (X_i - x_{ср})^2}}$$

Довірчі інтервали: $a_j \pm S_{aj} \cdot t_{крит}$, де $t_{крит}$ - критичне значення t-розподілу.

### 3.2. Статистичні показники та перевірки

#### Підхід 1
- Коефіцієнт кореляції (r)
- Коефіцієнт детермінації (R²)
- p-значення для статистичної значущості
- Стандартна похибка регресії
- Аналіз залишків (графіки та тести на нормальність)

#### Підхід 2
- Коефіцієнт кореляції (r)
- Перевірка значущості r за t-критерієм
- Коефіцієнт детермінації (R²)
- Стандартна похибка регресії
- Перевірка значущості регресії за F-критерієм Фішера

### 3.3. Візуалізація та діагностика

Обидва підходи використовують набір графіків для візуалізації та діагностики моделі:
1. Лінія регресії з фактичними даними
2. Графік залишків
3. Гістограма розподілу залишків
4. QQ-графік для перевірки нормальності розподілу

## 4. Результати регресійного аналізу та їх порівняння

### 4.1. Оцінка параметрів моделі

| Параметр | Справжнє значення | Підхід 1 | Підхід 2 |
|---|---|---|---|
| a₀ (вільний член) | 3.4 | 3.5501 | 3.5501 |
| a₁ (коефіцієнт при x) | 2.7 | 2.6514 | 2.6514 |

Обидва підходи дали ідентичні оцінки параметрів, що підтверджує математичну еквівалентність методів.

### 4.2. Статистичні показники якості моделей

| Показник | Підхід 1 | Підхід 2 |
|---|---|---|
| Коефіцієнт кореляції (r) | 0.9968 | 0.9968 |
| Коефіцієнт детермінації (R²) | 0.9937 | 0.9937 |
| Стандартна похибка регресії | 0.6778 | 0.6778 |
| p-значення | < 0.001 | - |
| t-статистика | - | 53.0889 > 2.1009 (критичне) |
| F-статистика | - | 2818.4273 > 4.4139 (критичне) |

Статистичні показники якості також ідентичні в обох підходах, хоча підхід 2 явно використовує t-критерій і F-критерій для перевірки статистичної значущості.

### 4.3. Довірчі інтервали

| Параметр | Підхід 1 | Підхід 2 |
|---|---|---|
| Довірчий інтервал a₀ | [3.5049, 3.5953] | [-4.1537, 11.2539] |
| Довірчий інтервал a₁ | [2.6436, 2.6591] | [1.3342, 3.9685] |
| Включає справжнє значення a₀ | Ні | Так |
| Включає справжнє значення a₁ | Ні | Так |

Тут спостерігається найбільша відмінність між підходами. Довірчі інтервали, обчислені за підходом 2 (MathCad), значно ширші і включають справжні значення параметрів, тоді як довірчі інтервали за підходом 1 вужчі і не включають справжні значення.

### 4.4. Візуальне порівняння моделей

Візуально обидві моделі схожі, з аналогічними лініями регресії та розподілами залишків. Основні відмінності:

1. **Підхід 1**: Включає додаткову візуалізацію довірчих інтервалів та інтервалів передбачення на графіку регресії.

2. **Підхід 2**: Пропонує більш консервативну (з ширшими інтервалами) оцінку невизначеності параметрів.

## 5. Аналіз відмінностей і пояснення результатів

### 5.1. Чому відрізняються довірчі інтервали?

Основна відмінність полягає в способі розрахунку стандартних похибок коефіцієнтів:

1. **Підхід 1** використовує матрицю коваріації параметрів, яка враховує корельованість похибок оцінок параметрів, що призводить до вужчих довірчих інтервалів.

2. **Підхід 2** (MathCad) використовує спрощені формули, які дають більш консервативні (широкі) оцінки, що з більшою ймовірністю включають справжні значення параметрів, але є менш точними.

Стандартні похибки в підході 2:
- Стандартна похибка a₀: 3.6669 (дуже велика)
- Стандартна похибка a₁: 0.6269 (також велика)

Це пояснює, чому довірчі інтервали в підході 2 настільки широкі.

### 5.2. Інтерпретація коефіцієнтів моделі

В обох підходах інтерпретація коефіцієнтів ідентична:

- Вільний член a₀ = 3.5501 показує очікуване значення y при x = 0.
- Коефіцієнт a₁ = 2.6514 показує, що при збільшенні x на 1 одиницю, y збільшується в середньому на 2.6514 одиниць.

### 5.3. Усереднений коефіцієнт еластичності

Обидва підходи дають однаковий коефіцієнт еластичності: 0.7888.

Це означає, що при збільшенні x на 1%, y в середньому збільшується на 0.79%.

## 6. Оцінка адекватності моделей

### 6.1. Критерії адекватності

Обидві моделі оцінюються як адекватні за наступними критеріями:

1. **Статистична значущість**: Обидві моделі статистично значущі (p < 0.001 у підході 1, t і F критерії підтверджують значущість у підході 2).

2. **Коефіцієнт детермінації**: R² = 0.9937 в обох підходах, що свідчить про дуже високу якість моделей.

3. **Аналіз залишків**: Залишки розподілені випадково навколо нуля без явних патернів, що підтверджує лінійність зв'язку.

4. **Нормальність розподілу залишків**: QQ-графіки показують, що розподіл залишків близький до нормального.

### 6.2. Прогностична здатність

Обидві моделі мають високу прогностичну здатність в межах діапазону даних, на яких вони були побудовані. Проте, важливо враховувати різну ширину довірчих інтервалів при інтерпретації прогнозів:

- **Підхід 1**: Дає більш точні, але потенційно оптимістичні (вузькі) оцінки невизначеності прогнозів.
- **Підхід 2**: Дає менш точні, але більш консервативні (широкі) оцінки невизначеності прогнозів.

## 7. Висновки та рекомендації щодо вибору підходу

### 7.1. Загальні висновки

1. Обидва підходи дають ідентичні оцінки параметрів регресійної моделі та статистичних показників якості.

2. Основна відмінність полягає в розрахунку довірчих інтервалів, де підхід MathCad дає значно ширші інтервали.

3. Моделі, побудовані обома підходами, є статистично значущими та адекватними, з дуже високим коефіцієнтом детермінації R² = 0.9937.

4. Важливим результатом є те, що довірчі інтервали в підході MathCad включають справжні значення параметрів, тоді як у сучасному підході - ні.

### 7.2. Практичні рекомендації

1. **Для навчальних цілей**: Підхід MathCad є більш наочним, оскільки демонструє всі проміжні розрахунки і дає більш консервативні оцінки невизначеності, які з більшою ймовірністю включають справжні значення параметрів.

2. **Для наукових досліджень**: Сучасний підхід забезпечує більш точні оцінки невизначеності за рахунок використання матриці коваріації параметрів, але може давати занадто вузькі довірчі інтервали.

3. **Для практичного прогнозування**: Рекомендується використовувати обидва підходи:
   - Сучасний підхід для точкових прогнозів
   - Підхід MathCad для оцінки невизначеності прогнозів (особливо якщо важливо не недооцінити невизначеність)

### 7.3. Заключні зауваження

Порівняльний аналіз показав, що різні підходи до реалізації методу найменших квадратів можуть давати різні оцінки невизначеності параметрів, навіть якщо точкові оцінки ідентичні. Це підкреслює важливість розуміння методології розрахунку довірчих інтервалів і правильного вибору підходу залежно від цілей аналізу.

Обидва підходи мають свої переваги, і вибір між ними повинен ґрунтуватися на конкретних потребах аналізу та важливості різних аспектів (точність vs. консервативність) для конкретного завдання.
