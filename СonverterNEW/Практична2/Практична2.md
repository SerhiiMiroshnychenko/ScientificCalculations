# Практична робота №2. Кисневий баланс плавки та розрахунок режиму продувки (статична модель)

## 1) Постановка задачі
Потрібно виконати статичний розрахунок **теоретичної** та **фактичної** витрати технічного кисню для киснево-конвертерної плавки, а також визначити базові режимні параметри продувки.

Розрахунок ведеться в розрахунку на **1000 кг металевої шихти** ($m_{charge}=1000\ \text{кг}$) та виконується в логічному зв’язку з **Практичною роботою №1**.

Необхідно:

- визначити теоретичні об’єми кисню на окиснення $Si$, $Mn$, $P$, $C$ та заліза, що перейшло у шлак;
- урахувати ступінь допалювання $CO$ до $CO_2$ через параметр $PCR$;
- перейти від теоретичної потреби $V_{O_2}^{theor}$ до фактичної витрати технічного кисню $V_{O_2}^{actual}$ з урахуванням чистоти та коефіцієнта засвоєння;
- за заданою питомою інтенсивністю дуття визначити хвилинну витрату кисню та тривалість продувки;
- виконати контроль адекватності результатів (питомі витрати та часові межі).

### Вхідні дані (для кожного варіанта)
**З Практичної роботи №1:**

- $\Delta m_{Si}$, $\Delta m_{Mn}$, $\Delta m_P$, $\Delta m_C$, кг — маси елементів, що окиснилися (інтегрально за плавку) на базі $m_{charge}=1000\ \text{кг}$;
- $m_{Fe\to slag}$, кг — маса заліза, що перейшла в шлак (приймаємо, що кисень витрачено на утворення $FeO$);
- $m_{steel}$, кг — маса рідкої сталі після плавки (для нормування витрати кисню на 1 т сталі).

**З умов варіанта (Практична №2):**

- $PCR$ — ступінь допалювання (частка вуглецю, що відповідає повному окисненню до $CO_2$), частка одиниці;
- $i_{sp}$ — питома інтенсивність продувки, $\text{Нм}^3/(\text{т}\cdot\text{хв})$.

### Прийняті типові параметри моделі (якщо не задані окремо)
- $\varphi$ — чистота технічного кисню: $0.995$.
- $\eta_{O_2}$ — коефіцієнт засвоєння кисню ванною: $0.95$.

### Потрібно визначити
- $V_{Si}$, $V_{Mn}$, $V_P$, $V_C$, $V_{Fe}$, $\text{Нм}^3$ — об’єми кисню на окиснення окремих компонентів;
- $V_{O_2}^{theor}$, $\text{Нм}^3$ — сумарна теоретична потреба в кисні;
- $V_{O_2}^{actual}$, $\text{Нм}^3$ — фактичний об’єм технічного кисню для продувки;
- $Q_{O_2}$, $\text{Нм}^3/\text{хв}$ — хвилинна витрата кисню;
- $\tau$, хв — тривалість продувки;
- $v_{O_2,sp}^{sh}$, $\text{Нм}^3/\text{т}_{sh}$ — питома витрата кисню, нормована на 1 т металевої шихти;
- $v_{O_2,sp}^{st}$, $\text{Нм}^3/\text{т}_{st}$ — питома витрата кисню, нормована на 1 т рідкої сталі.

### Таблиця позначень

| Позначення | Опис | Одиниця вимірювання | Прийняте значення |
|:---|:---|:---:|:---:|
| $m_{charge}$ | маса металевої шихти (база розрахунку) | кг | 1000 |
| $\Delta m_{Si},\ \Delta m_{Mn},\ \Delta m_P,\ \Delta m_C$ | маси елементів, що окиснилися (результати ПР №1) | кг | з ПР №1 |
| $m_{Fe\to slag}$ | маса заліза, що перейшла у шлак (приймаємо утворення $FeO$) | кг | з ПР №1 |
| $m_{steel}$ | маса рідкої сталі після плавки (результат ПР №1) | кг | з ПР №1 |
| $PCR$ | ступінь допалювання (частка вуглецю, що відповідає повному окисненню до $CO_2$) | частка одиниці | за варіантом |
| $i_{sp}$ | питома інтенсивність продувки | $\text{Нм}^3/(\text{т}\cdot\text{хв})$ | за варіантом |
| $q_v^{Si}$ | стехіометричний коефіцієнт витрати кисню на $Si$ | $\text{Нм}^3/\text{кг}$ | 0.798 |
| $q_v^{Mn}$ | стехіометричний коефіцієнт витрати кисню на $Mn$ | $\text{Нм}^3/\text{кг}$ | 0.204 |
| $q_v^{P}$ | стехіометричний коефіцієнт витрати кисню на $P$ | $\text{Нм}^3/\text{кг}$ | 0.905 |
| $q_v^{Fe}$ | стехіометричний коефіцієнт витрати кисню на $Fe$ (через $FeO$) | $\text{Нм}^3/\text{кг}$ | 0.201 |
| $q_v^{C\to CO}$ | коефіцієнт витрати кисню на $C$ для утворення $CO$ | $\text{Нм}^3/\text{кг}$ | 0.933 |
| $q_v^{C\to CO_2}$ | коефіцієнт витрати кисню на $C$ для утворення $CO_2$ | $\text{Нм}^3/\text{кг}$ | 1.866 |
| $q_v^{C,avg}$ | середній (ефективний) коефіцієнт витрати кисню на вуглець | $\text{Нм}^3/\text{кг}$ | залежить від $PCR$ |
| $V_i$ | об’єм кисню на окиснення компонента $i$ | $\text{Нм}^3$ | обчислюється |
| $V_{O_2}^{theor}$ | сумарний теоретичний об’єм хімічно чистого кисню | $\text{Нм}^3$ | обчислюється |
| $V_{O_2}^{actual}$ | фактичний об’єм технічного кисню з урахуванням втрат/домішок | $\text{Нм}^3$ | обчислюється |
| $\eta_{O_2}$ | коефіцієнт засвоєння кисню ванною | частка одиниці | 0.95 |
| $\varphi$ | чистота технічного кисню | частка одиниці | 0.995 |
| $Q_{O_2}$ | хвилинна витрата кисню | $\text{Нм}^3/\text{хв}$ | обчислюється |
| $\tau$ | тривалість продувки | хв | обчислюється |
| $v_{O_2,sp}^{sh}$ | питома витрата кисню (на 1 т металевої шихти) | $\text{Нм}^3/\text{т}_{sh}$ | обчислюється |
| $v_{O_2,sp}^{st}$ | питома витрата кисню (на 1 т рідкої сталі) | $\text{Нм}^3/\text{т}_{st}$ | обчислюється |

## 2) Теоретичні пояснення та обґрунтування для курсу
### Фізико-хімічний зміст кисневого балансу
Кисень у киснево-конвертерній плавці є одночасно:

- хімічним реагентом (окисник), який забезпечує рафінування металу;
- фактором формування шлаку (через утворення оксидів та підтримання окиснювальної здатності шлаку);
- чинником теплового режиму (екзотермія окиснення, у т.ч. додаткова екзотермія допалювання $CO$).

У статичній постановці ми використовуємо **інтегральні** маси окиснених елементів з ПР №1. Це означає, що кінетика (зміна швидкості реакцій у часі) тут не моделюється; натомість оцінюється сумарна потреба у кисні.

### Нормальні умови та одиниці
Об’єми газів у металургійних розрахунках зазвичай задають у **нормальних кубічних метрах** ($\text{Нм}^3$), тобто за умов $0^\circ C$ та $101.325\ \text{кПа}$. Саме до цих умов прив’язані стехіометричні коефіцієнти $q_v$.

### Узгодженість одиниць і контроль адекватності
Щоб уникнути помилок на порядок величини, у цій роботі фіксуємо правила та контрольні співвідношення:

- $\Delta m_i$ задаються в **кг**, а $q_v$ — у $\text{Нм}^3/\text{кг}$, тому $V_i$ та $V_{O_2}$ автоматично виходять у **$\text{Нм}^3$**.
- Для бази $m_{charge}=1000\ \text{кг}$ справедливо $v_{O_2,sp}^{sh}=V_{O_2}^{actual}$ (бо нормування на $m_{charge}/1000=1\ \text{т}$).
- Нормування на сталь виконується як $v_{O_2,sp}^{st}=V_{O_2}^{actual}/(m_{steel}/1000)$, тому завжди має виконуватися $v_{O_2,sp}^{st} > v_{O_2,sp}^{sh}$ (оскільки $m_{steel} < m_{charge}$).
- Тривалість продувки визначається з рівняння витрати $\tau=V_{O_2}^{actual}/Q_{O_2}$, де $Q_{O_2}=i_{sp}\cdot(m_{charge}/1000)$.

У навчальних розрахунках контроль доцільно виконувати за порядком величин: питомі витрати кисню повинні бути десятки $\text{Нм}^3/\text{т}$, а тривалість продувки — одиниці або десятки хвилин (для заданих $i_{sp}$).

## 3) Покроковий аналітичний розв'язок

### Крок 1. Стехіометричні коефіцієнти витрати кисню
Для переходу від маси окисненого елемента (кг) до об’єму кисню (Нм³) використовуємо коефіцієнти виду:

$$
V_i = \Delta m_i\,q_v^i.
$$

У цій роботі приймаємо такі значення (Нм³ $O_2$ на 1 кг елемента):

- $q_v^{Si} = 0.798$ для $Si + O_2 \to SiO_2$,
- $q_v^{Mn} = 0.204$ для $Mn + 0.5O_2 \to MnO$,
- $q_v^{P} = 0.905$ для $2P + 2.5O_2 \to P_2O_5$,
- $q_v^{Fe} = 0.201$ для $Fe + 0.5O_2 \to FeO$,
- $q_v^{C\to CO} = 0.933$ для $C + 0.5O_2 \to CO$,
- $q_v^{C\to CO_2} = 1.866$ для $C + O_2 \to CO_2$.

де:

- $q_v^i$ — теоретичний коефіцієнт, $\text{Нм}^3/\text{кг}$;
- $\Delta m_i$ — маса окисненого елемента (за ПР №1), кг.

### Крок 2. Кисень на окиснення $Si$, $Mn$, $P$, $Fe$
$$
V_{Si} = \Delta m_{Si}\,q_v^{Si},\quad
V_{Mn} = \Delta m_{Mn}\,q_v^{Mn},\quad
V_P = \Delta m_P\,q_v^{P},\quad
V_{Fe} = m_{Fe\to slag}\,q_v^{Fe}.
$$

### Крок 3. Кисень на окиснення вуглецю з урахуванням допалювання
Параметр $PCR$ інтерпретуємо як **частку вуглецю**, якій відповідає повне окиснення до $CO_2$.

Фізичний зміст параметра $PCR$ полягає в тому, що при збільшенні частки допалювання $CO$ до $CO_2$ зростає потреба в кисні на 1 кг вуглецю (бо для реакції $C + O_2 \to CO_2$ потрібно вдвічі більше кисню, ніж для $C + 0.5O_2 \to CO$). У статичній моделі це враховується через зміну ефективного коефіцієнта $q_v^{C,avg}$.

Середній коефіцієнт витрати кисню на вуглець:

$$
q_v^{C,avg} = q_v^{C\to CO}(1 - PCR) + q_v^{C\to CO_2}\,PCR.
$$

Тоді:

$$
V_C = \Delta m_C\,q_v^{C,avg}.
$$

### Крок 4. Сумарна теоретична потреба в кисні
$$
V_{O_2}^{theor} = V_{Si} + V_{Mn} + V_P + V_{Fe} + V_C.
$$

### Крок 5. Перехід до фактичного об’єму технічного кисню
$$
V_{O_2}^{actual} = \frac{V_{O_2}^{theor}}{\eta_{O_2}\,\varphi}.
$$

де:

- $\eta_{O_2}$ — коефіцієнт засвоєння кисню ванною (частка одиниці);
- $\varphi$ — чистота технічного кисню (частка одиниці).

### Крок 6. Розрахунок параметрів продувки
Оскільки база розрахунку $m_{charge}=1000\ \text{кг} = 1\ \text{т}$, хвилинна витрата кисню дорівнює:

$$
Q_{O_2} = i_{sp}\cdot\left(\frac{m_{charge}}{1000}\right) = i_{sp}.
$$

Тривалість продувки:

$$
\tau = \frac{V_{O_2}^{actual}}{Q_{O_2}}.
$$

Питома витрата кисню (для контролю адекватності):

$$
v_{O_2,sp}^{sh} = \frac{V_{O_2}^{actual}}{m_{charge}/1000} \quad [\text{Нм}^3/\text{т}_{sh}].
$$

$$
v_{O_2,sp}^{st} = \frac{V_{O_2}^{actual}}{m_{steel}/1000} \quad [\text{Нм}^3/\text{т}_{st}].
$$

Нормування $v_{O_2,sp}^{sh}$ зручне для порівняння розрахунків при фіксованій базі $m_{charge}=1\ \text{т}$. Нормування $v_{O_2,sp}^{st}$ є технологічно змістовнішим, бо показує фактичну витрату кисню на одиницю отриманої сталі (з урахуванням втрат металу у шлак і пил).

### Числовий розрахунок (варіант 20)
Використовуємо дані (база $m_{charge}=1000\ \text{кг}$):

- $\Delta m_{Si}=10.504\ \text{кг}$, $\Delta m_{Mn}=5.179\ \text{кг}$, $\Delta m_P=0.202\ \text{кг}$, $\Delta m_C=31.879\ \text{кг}$, $m_{Fe\to slag}=16.631\ \text{кг}$ (з ПР №1);
- $PCR=0.150$, $i_{sp}=4.00\ \text{Нм}^3/(\text{т}\cdot\text{хв})$ (за варіантом ПР №2);
- $\eta_{O_2}=0.95$, $\varphi=0.995$.

1) Кисень на $Si$, $Mn$, $P$, $Fe$

Загальні формули:

$$
V_{Si}=\Delta m_{Si}\,q_v^{Si},\quad
V_{Mn}=\Delta m_{Mn}\,q_v^{Mn},\quad
V_P=\Delta m_P\,q_v^{P},\quad
V_{Fe}=m_{Fe\to slag}\,q_v^{Fe}.
$$

Підстановка:

$$
\begin{aligned}
V_{Si} &= 10.504\cdot 0.798 = 8.382\ \text{Нм}^3,\\
V_{Mn} &= 5.179\cdot 0.204 = 1.057\ \text{Нм}^3,\\
V_P &= 0.202\cdot 0.905 = 0.183\ \text{Нм}^3,\\
V_{Fe} &= 16.631\cdot 0.201 = 3.343\ \text{Нм}^3.
\end{aligned}
$$

2) Кисень на вуглець з урахуванням $PCR$

Загальні формули:

$$
q_v^{C,avg}=q_v^{C\to CO}(1-PCR)+q_v^{C\to CO_2}\,PCR,
\quad
V_C=\Delta m_C\,q_v^{C,avg}.
$$

Підстановка:

$$
q_v^{C,avg}=0.933(1-0.150)+1.866\cdot 0.150=1.07295\ \text{Нм}^3/\text{кг}.
$$

$$
V_C = 31.879\cdot 1.07295 = 34.205\ \text{Нм}^3.
$$

3) Сумарна теоретична потреба в кисні

Загальна формула:

$$
V_{O_2}^{theor}=V_{Si}+V_{Mn}+V_P+V_{Fe}+V_C.
$$

Підстановка:

$$
V_{O_2}^{theor}=8.382+1.057+0.183+3.343+34.205=47.169\ \text{Нм}^3.
$$

4) Фактична витрата технічного кисню

Загальна формула:

$$
V_{O_2}^{actual}=\frac{V_{O_2}^{theor}}{\eta_{O_2}\,\varphi}.
$$

Підстановка:

$$
V_{O_2}^{actual}=\frac{47.169}{0.95\cdot 0.995}=49.901\ \text{Нм}^3.
$$

5) Режим продувки ($Q_{O_2}$ і $\tau$)

Загальні формули:

$$
Q_{O_2}=i_{sp}\cdot\left(\frac{m_{charge}}{1000}\right),
\quad
\tau=\frac{V_{O_2}^{actual}}{Q_{O_2}}.
$$

Підстановка:

$$
Q_{O_2}=4.00\cdot\left(\frac{1000}{1000}\right)=4.00\ \text{Нм}^3/\text{хв},
\quad
\tau=\frac{49.901}{4.00}=12.48\ \text{хв}.
$$

6) Питомі витрати кисню

Загальні формули:

$$
v_{O_2,sp}^{sh}=\frac{V_{O_2}^{actual}}{m_{charge}/1000},
\quad
v_{O_2,sp}^{st}=\frac{V_{O_2}^{actual}}{m_{steel}/1000}.
$$

Підстановка:

$$
v_{O_2,sp}^{sh}=\frac{49.901}{1000/1000}=49.90\ \text{Нм}^3/\text{т}_{sh}.
$$

За даними ПР №1 для варіанта 20: $m_{steel}=920.60\ \text{кг}$, тоді:

$$
v_{O_2,sp}^{st}=\frac{49.901}{920.60/1000}=54.21\ \text{Нм}^3/\text{т}_{st}.
$$

## 4) Розв'язок за допомогою python скрипта



```python
"""Практична робота №2 (Python).
Кисневий баланс плавки та розрахунок режиму продувки (статична модель).
"""

# =========================================================
# ВХІДНІ ДАНІ (ВАРІАНТ 20 — демонстраційний приклад)
# =========================================================

variant_no = 20

# База розрахунку
m_charge = 1000.0  # кг

# Дані з Практичної роботи №1 (маси окиснених елементів на 1 т шихти)
# Вхідні величини взято з підсумкових результатів Практичної роботи №1 для варіанта 20
dSi = 10.504
dMn = 5.179
dP = 0.202
dC = 31.879
m_Fe_to_slag = 16.631

# Дані варіанта для Практичної №2
PCR = 0.150  # частка повного окиснення C до CO2
i_sp = 4.00  # Нм3/(т*хв)

# Типові параметри
eta_O2 = 0.95
phi_O2 = 0.995

# =========================================================
# КОНСТАНТИ — СТЕХІОМЕТРИЧНІ КОЕФІЦІЄНТИ (Нм3/кг)
# =========================================================

q_v_Si = 0.798
q_v_Mn = 0.204
q_v_P = 0.905
q_v_Fe = 0.201

q_v_C_CO = 0.933
q_v_C_CO2 = 1.866

# =========================================================
# РОЗРАХУНОК
# =========================================================

# 1) Кисень на Si, Mn, P, Fe
V_Si = dSi * q_v_Si
V_Mn = dMn * q_v_Mn
V_P = dP * q_v_P
V_Fe = m_Fe_to_slag * q_v_Fe

# 2) Кисень на вуглець з урахуванням PCR
q_v_C_avg = q_v_C_CO * (1.0 - PCR) + q_v_C_CO2 * PCR
V_C = dC * q_v_C_avg

# 3) Теоретичний об’єм
V_O2_theor = V_Si + V_Mn + V_P + V_Fe + V_C

# 4) Фактичний об’єм
V_O2_actual = V_O2_theor / (eta_O2 * phi_O2)

# 5) Параметри продувки
Q_O2 = i_sp * (m_charge / 1000.0)  # Нм3/хв
blow_time = V_O2_actual / Q_O2     # хв

# =========================================================
# ВИВІД
# =========================================================

print("=" * 72)
print(f"Практична робота №2 (Python). Варіант {variant_no}")
print("=" * 72)
print("1) Складові теоретичної потреби в кисні (Нм3):")
print(f"   V(Si) = {V_Si:.3f}")
print(f"   V(Mn) = {V_Mn:.3f}")
print(f"   V(P)  = {V_P:.3f}")
print(f"   V(Fe) = {V_Fe:.3f}")
print(f"   q_v(C,avg) = {q_v_C_avg:.5f} Нм3/кг")
print(f"   V(C)  = {V_C:.3f}")
print("-" * 72)
print("2) Підсумок:")
print(f"   V_theor   = {V_O2_theor:.3f} Нм3")
print(f"   V_actual  = {V_O2_actual:.3f} Нм3")
print("-" * 72)
print("3) Режим продувки:")
print(f"   Q_O2      = {Q_O2:.2f} Нм3/хв")
print(f"   blow_time = {blow_time:.2f} хв")
print("=" * 72)
```

    ========================================================================
    Практична робота №2 (Python). Варіант 20
    ========================================================================
    1) Складові теоретичної потреби в кисні (Нм3):
       V(Si) = 8.382
       V(Mn) = 1.057
       V(P)  = 0.183
       V(Fe) = 3.343
       q_v(C,avg) = 1.07295 Нм3/кг
       V(C)  = 34.205
    ------------------------------------------------------------------------
    2) Підсумок:
       V_theor   = 47.169 Нм3
       V_actual  = 49.901 Нм3
    ------------------------------------------------------------------------
    3) Режим продувки:
       Q_O2      = 4.00 Нм3/хв
       blow_time = 12.48 хв
    ========================================================================
    

## Порівняння аналітичного розв'язку та Python-скрипта (варіант 20)
Python-скрипт реалізує ті самі формули, що й аналітичний розрахунок. Для варіанта 20 числові результати повинні співпадати (з точністю округлення) для ключових контрольних величин:

| Контрольна величина | Аналітичний розрахунок (варіант 20) | Python-скрипт (варіант 20) | Різниця |
|---|---:|---:|---:|
| $q_v^{C,avg}$, Нм³/кг | 1.07295 | 1.07295 | 0.00000 |
| $V_C$, Нм³ | 34.205 | 34.205 | 0.000 |
| $V_{O_2}^{theor}$, Нм³ | 47.169 | 47.169 | 0.000 |
| $V_{O_2}^{actual}$, Нм³ | 49.901 | 49.901 | 0.000 |
| $\tau$, хв | 12.48 | 12.48 | 0.00 |

## 5) Висновки
1. Статичний кисневий баланс безпосередньо залежить від інтегральних мас окиснених елементів, отриманих у матеріальному балансі. Тому якість ПР №2 визначається коректністю ПР №1.
2. Вуглець формує основну частку витрати кисню, а параметр $PCR$ суттєво впливає на підсумкову потребу в кисні через збільшення частки повного окиснення.
3. Коефіцієнти $\eta_{O_2}$ та $\varphi$ узагальнюють реальні втрати та домішки в технічному кисні. Навіть за помірних значень втрат (5–7%) фактична витрата помітно перевищує теоретичну.
4. Параметри продувки ($i_{sp}$, $\tau$) у статичній моделі розглядаються як середні. У реальному процесі інтенсивність може змінюватися в часі (перехід від «м’якої» до «жорсткої» продувки).

## 6) 20 варіантів завдань для самостійного вирішення
У всіх варіантах базу розрахунку прийняти $m_{charge}=1000\ \text{кг}$.

Для кожного варіанта:

- $PCR$ та $i_{sp}$ беруться з таблиці нижче.
- $\Delta m_{Si}$, $\Delta m_{Mn}$, $\Delta m_P$, $\Delta m_C$, $m_{Fe\to slag}$ та $m_{steel}$ беруться з підсумкових таблиць результатів **Практичної роботи №1** для того самого номера варіанта.

| Варіант | $PCR$ | $i_{sp}$, Нм³/(т·хв) |
|---:|---:|---:|
| 1 | 0.100 | 3.10 |
| 2 | 0.103 | 3.15 |
| 3 | 0.106 | 3.20 |
| 4 | 0.109 | 3.25 |
| 5 | 0.112 | 3.30 |
| 6 | 0.115 | 3.35 |
| 7 | 0.118 | 3.40 |
| 8 | 0.121 | 3.45 |
| 9 | 0.124 | 3.50 |
| 10 | 0.127 | 3.55 |
| 11 | 0.130 | 3.60 |
| 12 | 0.133 | 3.65 |
| 13 | 0.136 | 3.70 |
| 14 | 0.139 | 3.75 |
| 15 | 0.142 | 3.80 |
| 16 | 0.145 | 3.85 |
| 17 | 0.148 | 3.90 |
| 18 | 0.150 | 3.95 |
| 19 | 0.150 | 4.00 |
| 20 | 0.150 | 4.00 |

### Розрахунок усіх 20 варіантів (Python)

У цьому блоці `PCR` та `i_sp` беруться з таблиці варіантів ПР №2. Значення $\Delta m_{Si}$, $\Delta m_{Mn}$, $\Delta m_P$, $\Delta m_C$, $m_{Fe\to slag}$ та $m_{steel}$ для кожного варіанта взято з підсумкових таблиць результатів **Практичної роботи №1** (база $m_{charge}=1000\ \text{кг}$).



```python
"""Практична робота №2 (Python).
Пакетний розрахунок для всіх 20 варіантів.
"""

from rich.console import Console
from rich.table import Table
from rich import box

phi_O2 = 0.995
eta_O2 = 0.95

q_v_Si = 0.798
q_v_Mn = 0.204
q_v_P = 0.905
q_v_Fe = 0.201
q_v_C_CO = 0.933
q_v_C_CO2 = 1.866

m_charge = 1000.0  # кг

variants = [
    {"no": 1,  "PCR": 0.100, "i_sp": 3.10, "dSi": 4.0430, "dMn": 2.4241, "dP": 0.6950, "dC": 31.5086, "mFe": 6.3881, "mSteel": 939.94},
    {"no": 2,  "PCR": 0.103, "i_sp": 3.15, "dSi": 4.4281, "dMn": 2.5876, "dP": 0.6912, "dC": 31.5556, "mFe": 7.2892, "mSteel": 938.45},
    {"no": 3,  "PCR": 0.106, "i_sp": 3.20, "dSi": 4.8081, "dMn": 2.7479, "dP": 0.6088, "dC": 31.5984, "mFe": 7.1454, "mSteel": 938.09},
    {"no": 4,  "PCR": 0.109, "i_sp": 3.25, "dSi": 5.1832, "dMn": 2.9074, "dP": 0.6055, "dC": 31.6394, "mFe": 8.0566, "mSteel": 936.61},
    {"no": 5,  "PCR": 0.112, "i_sp": 3.30, "dSi": 5.5532, "dMn": 3.0649, "dP": 0.6022, "dC": 31.6774, "mFe": 9.0192, "mSteel": 935.08},
    {"no": 6,  "PCR": 0.115, "i_sp": 3.35, "dSi": 5.9183, "dMn": 3.2191, "dP": 0.5218, "dC": 31.7111, "mFe": 8.6885, "mSteel": 934.94},
    {"no": 7,  "PCR": 0.118, "i_sp": 3.40, "dSi": 6.2783, "dMn": 3.3726, "dP": 0.5190, "dC": 31.7431, "mFe": 9.6592, "mSteel": 933.43},
    {"no": 8,  "PCR": 0.121, "i_sp": 3.45, "dSi": 6.6334, "dMn": 3.5241, "dP": 0.5162, "dC": 31.7721, "mFe": 10.6798, "mSteel": 931.87},
    {"no": 9,  "PCR": 0.124, "i_sp": 3.50, "dSi": 6.9834, "dMn": 3.6721, "dP": 0.4377, "dC": 31.7966, "mFe": 10.1690, "mSteel": 931.94},
    {"no": 10, "PCR": 0.127, "i_sp": 3.55, "dSi": 7.3285, "dMn": 3.8196, "dP": 0.4354, "dC": 31.8196, "mFe": 11.1960, "mSteel": 930.40},
    {"no": 11, "PCR": 0.130, "i_sp": 3.60, "dSi": 7.6686, "dMn": 3.9652, "dP": 0.4332, "dC": 31.8397, "mFe": 12.2713, "mSteel": 928.82},
    {"no": 12, "PCR": 0.133, "i_sp": 3.65, "dSi": 8.0035, "dMn": 4.1069, "dP": 0.3566, "dC": 31.8549, "mFe": 11.5870, "mSteel": 929.09},
    {"no": 13, "PCR": 0.136, "i_sp": 3.70, "dSi": 8.3336, "dMn": 4.2485, "dP": 0.3549, "dC": 31.8690, "mFe": 12.6668, "mSteel": 927.53},
    {"no": 14, "PCR": 0.139, "i_sp": 3.75, "dSi": 8.6587, "dMn": 4.3881, "dP": 0.3531, "dC": 31.8801, "mFe": 13.7936, "mSteel": 925.93},
    {"no": 15, "PCR": 0.142, "i_sp": 3.80, "dSi": 8.9787, "dMn": 4.5236, "dP": 0.2785, "dC": 31.8861, "mFe": 12.9423, "mSteel": 926.39},
    {"no": 16, "PCR": 0.145, "i_sp": 3.85, "dSi": 9.2938, "dMn": 4.6592, "dP": 0.2773, "dC": 31.8912, "mFe": 14.0718, "mSteel": 924.81},
    {"no": 17, "PCR": 0.148, "i_sp": 3.90, "dSi": 9.6038, "dMn": 4.7928, "dP": 0.2760, "dC": 31.8933, "mFe": 15.2466, "mSteel": 923.19},
    {"no": 18, "PCR": 0.150, "i_sp": 3.95, "dSi": 9.9088, "dMn": 4.9222, "dP": 0.2034, "dC": 31.8902, "mFe": 14.2352, "mSteel": 923.84},
    {"no": 19, "PCR": 0.150, "i_sp": 4.00, "dSi": 10.2089, "dMn": 5.0518, "dP": 0.2027, "dC": 31.8863, "mFe": 15.4109, "mSteel": 922.24},
    {"no": 20, "PCR": 0.150, "i_sp": 4.00, "dSi": 10.5040, "dMn": 5.1794, "dP": 0.2019, "dC": 31.8794, "mFe": 16.6305, "mSteel": 920.60},
]


def compute_variant(v):
    dSi = v["dSi"]
    dMn = v["dMn"]
    dP = v["dP"]
    dC = v["dC"]
    mFe = v["mFe"]
    mSteel = v["mSteel"]
    PCR = v["PCR"]
    i_sp = v["i_sp"]

    V_Si = dSi * q_v_Si
    V_Mn = dMn * q_v_Mn
    V_P = dP * q_v_P
    V_Fe = mFe * q_v_Fe

    q_v_C_avg = q_v_C_CO * (1.0 - PCR) + q_v_C_CO2 * PCR
    V_C = dC * q_v_C_avg

    V_O2_theor = V_Si + V_Mn + V_P + V_Fe + V_C
    V_O2_actual = V_O2_theor / (eta_O2 * phi_O2)

    Q_O2 = i_sp * (m_charge / 1000.0)
    tau = V_O2_actual / Q_O2

    v_sh = V_O2_actual / (m_charge / 1000.0)
    v_st = V_O2_actual / (mSteel / 1000.0)

    return {
        "V_theor": V_O2_theor,
        "V_actual": V_O2_actual,
        "Q_O2": Q_O2,
        "tau": tau,
        "v_sh": v_sh,
        "v_st": v_st,
    }


console = Console()

table = Table(
    title="[i]Кисневий баланс і режим продувки (всі варіанти)[/i]",
    box=box.SIMPLE,
    header_style="italic",
)

table.add_column("Вар", justify="right", no_wrap=True)
table.add_column("PCR", justify="right")
table.add_column("i_sp", justify="right")
table.add_column("V_theor", justify="right")
table.add_column("V_actual", justify="right")
table.add_column("Q_O2", justify="right")
table.add_column("τ", justify="right")
table.add_column("v_sh", justify="right")
table.add_column("v_st", justify="right")

for v in variants:
    res = compute_variant(v)
    table.add_row(
        str(v["no"]),
        f"{v['PCR']:.3f}",
        f"{v['i_sp']:.2f}",
        f"{res['V_theor']:.3f}",
        f"{res['V_actual']:.3f}",
        f"{res['Q_O2']:.2f}",
        f"{res['tau']:.2f}",
        f"{res['v_sh']:.2f}",
        f"{res['v_st']:.2f}",
    )

console.print(table)
```


<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-style: italic">             Кисневий баланс і режим продувки (всі варіанти)              </span>

 <span style="font-style: italic"> Вар </span> <span style="font-style: italic">   PCR </span> <span style="font-style: italic"> i_sp </span> <span style="font-style: italic"> V_theor </span> <span style="font-style: italic"> V_actual </span> <span style="font-style: italic"> Q_O2 </span> <span style="font-style: italic">     τ </span> <span style="font-style: italic">  v_sh </span> <span style="font-style: italic">  v_st </span> 
 ──────────────────────────────────────────────────────────────────────── 
    1   0.100   3.10    37.971     40.170   3.10   12.96   40.17   42.74  
    2   0.103   3.15    38.626     40.863   3.15   12.97   40.86   43.54  
    3   0.106   3.20    38.991     41.249   3.20   12.89   41.25   43.97  
    4   0.109   3.25    39.634     41.929   3.25   12.90   41.93   44.77  
    5   0.112   3.30    40.280     42.613   3.30   12.91   42.61   45.57  
    6   0.115   3.35    40.587     42.938   3.35   12.82   42.94   45.93  
    7   0.118   3.40    41.220     43.608   3.40   12.83   43.61   46.72  
    8   0.121   3.45    41.856     44.281   3.45   12.84   44.28   47.52  
    9   0.124   3.50    42.107     44.546   3.50   12.73   44.55   47.80  
   10   0.127   3.55    42.730     45.205   3.55   12.73   45.20   48.59  
   11   0.130   3.60    43.355     45.866   3.60   12.74   45.87   49.38  
   12   0.133   3.65    43.550     46.072   3.65   12.62   46.07   49.59  
   13   0.136   3.70    44.162     46.720   3.70   12.63   46.72   50.37  
   14   0.139   3.75    44.775     47.369   3.75   12.63   47.37   51.16  
   15   0.142   3.80    44.915     47.517   3.80   12.50   47.52   51.29  
   16   0.145   3.85    45.515     48.152   3.85   12.51   48.15   52.07  
   17   0.148   3.90    46.116     48.787   3.90   12.51   48.79   52.85  
   18   0.150   3.95    46.173     48.848   3.95   12.37   48.85   52.87  
   19   0.150   4.00    46.671     49.374   4.00   12.34   49.37   53.54  
   20   0.150   4.00    47.169     49.901   4.00   12.48   49.90   54.21  

</pre>




```python

```
