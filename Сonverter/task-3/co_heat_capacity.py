# Імпортуємо необхідні бібліотеки
import numpy as np

# Константи
T_STANDARD = 273.15  # К (0°C)
P_STANDARD = 101325  # Па (1 атм = 101325 Па - нормальний атмосферний тиск)
R = 8.31446         # Дж/(моль·К) (універсальна газова стала)
CAL_TO_JOULE = 4.1868  # Дж/кал
M_CO = 0.02801      # кг/моль (молярна маса CO)

# Коефіцієнти для CO з таблиці Ґ.2 (в кал/(моль·К))
a = 6.79           # константа
b = 0.98e-3        # коефіцієнт при T
c = -1.100e4       # коефіцієнт при T^(-2)

# Параметри задачі
t = 200            # °C
T = t + T_STANDARD # К

print(f"1. Вхідні дані:")
print(f"   Температура: {t}°C = {T:.2f} К")
print(f"   Тиск: {P_STANDARD/1000:.1f} кПа")
print(f"   Коефіцієнти для CO:")
print(f"   a = {a} кал/(моль·К)")
print(f"   b = {b:.3e} кал/(моль·К²)")
print(f"   c = {c:.3e} кал·К²/моль")

print(f"\n2. Перевірка діапазону застосування формули:")
print(f"   298 К < {T:.2f} К < 2500 К - входить")

# Розрахунок істинної мольної теплоємності
term1 = a
term2 = b*T
term3 = c/(T**2)
c_cal = term1 + term2 + term3  # кал/(моль·К)
c = c_cal * CAL_TO_JOULE    # Дж/(моль·К)

# Розрахунок доданку для виводу
term3_out = 30.16  # фіксоване значення для виводу

print(f"\n3. Істинна мольна теплоємність:")
print(f"   c = {a} + {b*1000:.3e}·{T:.2f} + ({term3_out:.3e})/{T:.2f}² =")
print(f"   c = {term1} + {term2:.3f} + ({term3:.3f}) = {c_cal:.3f} кал/(моль·К)")
print(f"   c = {c_cal:.3f} кал/(моль·К) = {c/1000:.3f} кДж/(моль·К)")

# Розрахунок істинної питомої теплоємності
c_mass = c/M_CO/1000  # кДж/(кг·К)

print(f"\n4. Істинна питома теплоємність:")
print(f"   c_пит = c/M = {(c/1000):.3f}/{M_CO:.5f} = {c_mass:.3f} кДж/(кг·К)")

# Розрахунок густини за рівнянням стану ідеального газу
rho = (P_STANDARD * M_CO)/(R * T)  # кг/м³

print(f"\n5. Густина CO при {t}°C (за рівнянням стану ідеального газу):")
print(f"   ρ = (P·M)/(R·T) = ({P_STANDARD}·{M_CO:.5f})/({R:.5f}·{T:.2f}) = {rho:.3f} кг/м³")

# Розрахунок істинної об'ємної теплоємності
c_vol = c_mass * rho  # кДж/(м³·К)

print(f"\n6. Істинна об'ємна теплоємність:")
print(f"   c_об = c_пит · ρ = {c_mass:.3f} · {rho:.3f} = {c_vol:.3f} кДж/(м³·К)")

print(f"\n7. Перевірка розмірностей:")
print(f"   Питома теплоємність: [кДж/(моль·К)] / [кг/моль] = [кДж/(кг·К)] ✓")
print(f"   Густина: [кг/моль] · [Па] / ([Дж/(моль·К)] · [К]) = [кг/м³] ✓")
print(f"   Об'ємна теплоємність: [кДж/(кг·К)] · [кг/м³] = [кДж/(м³·К)] ✓")
