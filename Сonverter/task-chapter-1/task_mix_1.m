% Розрахунок теплоємності газової суміші та теплоти нагрівання.
% Суміш: CO (87.4%), CO₂ (10.1%), O₂ (1.6%), N₂ (0.9%)

% Константи
R = 8.31446261815;  % Дж/(моль·К)
CAL_TO_JOULE = 4.1868;  % Дж/кал
P_STANDARD = 101325;  % Па (1 атм)
T_STANDARD = 273.15;  % К (0°C)

% Коефіцієнти для газів (в кал/(моль·К))
% CO
a_co = 6.79;
b_co = 0.98/1e3;  % Ділимо на 1e3 згідно з таблицею
c_co = -0.11*1e5;  % Множимо на 1e5 згідно з таблицею

% CO₂
a_co2 = 10.55;
b_co2 = 2.16/1e3;
c_co2 = -2.04*1e5;

% O₂
a_o2 = 7.16;
b_o2 = 1.0/1e3;
c_o2 = -0.4*1e5;

% N₂
a_n2 = 6.66;
b_n2 = 1.02/1e3;
c_n2 = 0;  % для N₂ немає коефіцієнта c

% Об'ємні частки компонентів
r_co = 0.874;   % CO
r_co2 = 0.101;  % CO₂
r_o2 = 0.016;   % O₂
r_n2 = 0.009;   % N₂

% Параметри процесу
volume = 100;  % м³
t1 = 25;       % °C
t2 = 1000;     % °C
T1 = t1 + T_STANDARD;  % K
T2 = t2 + T_STANDARD;  % K

% Перевірка діапазону температур
T_MIN = 298;  % К
T_MAX = 2500;  % К

if ~(T_MIN <= T1 && T1 <= T_MAX)
    fprintf('\nУВАГА: Температура %.2f К виходить за межі діапазону %d-%d К\n', T1, T_MIN, T_MAX);
    fprintf('Результати можуть бути неточними!\n');
end

if ~(T_MIN <= T2 && T2 <= T_MAX)
    fprintf('\nУВАГА: Температура %.2f К виходить за межі діапазону %d-%d К\n', T2, T_MIN, T_MAX);
    fprintf('Результати можуть бути неточними!\n');
end

% Розрахунок кількості речовини
n = (P_STANDARD * volume) / (R * T1);

% Розрахунок кількості речовини для кожного компонента
n_co = n * r_co;
n_co2 = n * r_co2;
n_o2 = n * r_o2;
n_n2 = n * r_n2;

% Переведення R в кал/(моль·К)
R_cal = R / CAL_TO_JOULE;

% Розрахунок коефіцієнтів для cv
% CO
a_v_co = (a_co - R_cal) * CAL_TO_JOULE;
b_v_co = b_co * CAL_TO_JOULE;
c_v_co = c_co * CAL_TO_JOULE;

% CO₂
a_v_co2 = (a_co2 - R_cal) * CAL_TO_JOULE;
b_v_co2 = b_co2 * CAL_TO_JOULE;
c_v_co2 = c_co2 * CAL_TO_JOULE;

% O₂
a_v_o2 = (a_o2 - R_cal) * CAL_TO_JOULE;
b_v_o2 = b_o2 * CAL_TO_JOULE;
c_v_o2 = c_o2 * CAL_TO_JOULE;

% N₂
a_v_n2 = (a_n2 - R_cal) * CAL_TO_JOULE;
b_v_n2 = b_n2 * CAL_TO_JOULE;
c_v_n2 = 0;

% Функції теплоємності для кожного компонента
cv_co = @(T) a_v_co + b_v_co*T + c_v_co./(T.*T);
cv_co2 = @(T) a_v_co2 + b_v_co2*T + c_v_co2./(T.*T);
cv_o2 = @(T) a_v_o2 + b_v_o2*T + c_v_o2./(T.*T);
cv_n2 = @(T) a_v_n2 + b_v_n2*T + c_v_n2./(T.*T);

% Аналітичний розрахунок для кожного компонента
Q_co = n_co * (...
    a_v_co * (T2 - T1) + ...
    b_v_co * (T2^2 - T1^2) / 2 + ...
    c_v_co * (-1/T2 + 1/T1) ...
);

Q_co2 = n_co2 * (...
    a_v_co2 * (T2 - T1) + ...
    b_v_co2 * (T2^2 - T1^2) / 2 + ...
    c_v_co2 * (-1/T2 + 1/T1) ...
);

Q_o2 = n_o2 * (...
    a_v_o2 * (T2 - T1) + ...
    b_v_o2 * (T2^2 - T1^2) / 2 + ...
    c_v_o2 * (-1/T2 + 1/T1) ...
);

Q_n2 = n_n2 * (...
    a_v_n2 * (T2 - T1) + ...
    b_v_n2 * (T2^2 - T1^2) / 2 + ...
    c_v_n2 * (-1/T2 + 1/T1) ...
);

% Загальна теплота (аналітично)
Q = Q_co + Q_co2 + Q_o2 + Q_n2;

fprintf('Загальна теплота: %.2f кДж\n', Q/1000); 