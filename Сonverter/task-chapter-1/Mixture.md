# Розрахунок теплоємності та теплоти нагрівання газової суміші

## 1) *Теоретичні основи*

### Теплоємність газів

Теплоємність - це кількість теплоти, яку необхідно надати речовині для збільшення її температури на 1 °С (1 K). Для газів розрізняють два типи теплоємності:

1. Теплоємність при постійному об'ємі ($c_v$) - кількість теплоти, необхідна для підвищення температури речовини на 1 K при постійному об'ємі.
2. Теплоємність при постійному тиску ($c_p$) - кількість теплоти, необхідна для підвищення температури речовини на 1 K при постійному тиску.

Для ідеального газу зв'язок між цими теплоємностями визначається рівнянням Майєра:

$$ c_p - c_v = R \qquad (1.1) $$

де R - універсальна газова стала (8.31446261815 Дж/(моль·К)).

### Залежність теплоємності від температури

Для багатьох газів теплоємність при постійному тиску можна виразити формулою:

$$ c_p = a + bT + cT^{-2}, \text{ Дж/(моль}\cdot\text{К)} \qquad (1.2) $$

де $a$, $b$, $c$ – експериментально визначені коефіцієнти.

### Теплоємність газових сумішей

Для газових сумішей використовується правило адитивності:

$$ c_{сум} = \sum_{i=1}^{n} r_i c_i \qquad (1.3) $$

де $r_i$ - об'ємна частка і-го компонента (в долях одиниці), $c_i$ - мольна теплоємність і-го компонента.

Для ідеальних газів при однакових температурі та тиску, згідно із законом Авогадро, в рівних об'ємах різних газів міститься однакова кількість молекул. Тому для суміші ідеальних газів об'ємні частки компонентів чисельно дорівнюють їх мольним часткам.

### Розрахунок кількості речовини

Кількість речовини газу можна розрахувати за рівнянням стану ідеального газу:

$$ n = \frac{PV}{RT} \qquad (1.4) $$

де:
- P - тиск газу, Па
- V - об'єм газу, м³
- R - універсальна газова стала, Дж/(моль·К)
- T - температура газу, К

### Розрахунок теплоти нагрівання

Кількість теплоти, необхідна для нагрівання газу при сталому об'ємі від температури $T_1$ до температури $T_2$:

$$ Q_v = \int_{T_1}^{T_2} c_v dT = \int_{T_1}^{T_2} (c_p - R) dT \qquad (1.5) $$

Підставляючи вираз для $c_p$ (1.2), отримуємо:

$$ Q_v = (a-R)(T_2 - T_1) + \frac{b}{2}(T_2^2 - T_1^2) - c(\frac{1}{T_2} - \frac{1}{T_1}), \text{ кал/моль} \qquad (1.6) $$

Для газової суміші загальна теплота нагрівання:

$$ Q_{v,сум} = \sum_{i=1}^{n} r_i Q_{v,i} \qquad (1.7) $$

де $r_i$ - об'ємна частка і-го компонента, $Q_{v,i}$ - теплота нагрівання і-го компонента.

## 2) *Постановка задачі*

### Вихідні дані

Розглядається газова суміш наступного складу (об'ємні частки):
- CO: 87.4%
- CO₂: 10.1%
- O₂: 1.6%
- N₂: 0.9%

### *Умова задачі*
За коефіцієнтами з таблиці 3.1 визначити теплоту, що поглинає суміш газів при нагріванні 100 м³ від 25 до 1000 °С за сталого об'єму.

#### Таблиця 3.1

Теплоємності деяких газів $c_p = a + bT + cT^{-2}$

| Газ | a | b·10³ | c·10⁻⁵ | ΔT, К |
|-----|-----|--------|---------|--------|
| CO | 6.79 | 0.98 | -0.11 | 298-2500 |
| CO₂ | 10.55 | 2.16 | -2.04 | 298-2500 |
| CH₄ | 5.65 | 11.44 | -0.46 | 298-1500 |
| H₂ | 27.30 | 3.27 | 0.50 | 298-3000 |
| N₂ | 6.66 | 1.02 | - | 298-2500 |
| O₂ | 7.16 | 1.0 | -0.40 | 298-3000 |

*Примітка: Коефіцієнти наведені в кал/(моль·К)*

## 3) *Методика розв'язання*

Для розв'язання задачі необхідно виконати наступні кроки:

1. Розрахувати кількість молів газу в 100 м³ суміші за законом ідеального газу:
   $$ n = \frac{PV}{RT} $$
   де:
   - P = 101325 Па - атмосферний тиск
   - V = 100 м³ - об'єм суміші
   - R = 8.31446261815 Дж/(моль·К) - універсальна газова стала
   - T = 298.15 К - початкова температура (25°C)

2. Розрахувати кількість молів кожного компонента суміші за їх об'ємними частками.
3. Для кожного компонента розрахувати теплоємність $c_p$ за формулою $c_p = a + bT + cT^{-2}$ з використанням коефіцієнтів з таблиці.
4. Перевести теплоємність $c_p$ в $c_v$ за формулою $c_v = c_p - R$.
5. Розрахувати теплоту нагрівання для кожного компонента за формулою (2.5).
6. Розрахувати загальну теплоту нагрівання суміші за формулою (2.6).

## 4) *Приклад розв'язання*

### Фізичний зміст задачі
Ця задача має важливе практичне значення в металургійних процесах, особливо в конвертерних агрегатах, де відбувається інтенсивне нагрівання газових сумішей. Розуміння теплових властивостей газових сумішей дозволяє точніше розраховувати теплові баланси конвертерних процесів та оптимізувати їх енергоефективність.

### Аналітичний розв'язок

#### Крок 1: Розрахунок кількості молів газу
Для розрахунку кількості молів газу використовується рівняння стану ідеального газу:
$$ PV = nRT $$

звідки:
$$ n = \frac{PV}{RT} $$

Фізичний зміст: це рівняння описує зв'язок між макроскопічними параметрами газу (тиском, об'ємом, температурою) та кількістю речовини. Воно базується на кінетичній теорії газів і є фундаментальним законом термодинаміки.

Приймаємо стандартні умови для початкового стану газу:
- *P* = 101325 Па (нормальний атмосферний тиск)
- *V* = 100 м³ (задано в умові)
- *R* = 8,31446261815 Дж/(моль·К) (універсальна газова стала)
- *T* = 298,15 К (початкова температура, 25°C)

Розрахунок:
$$ n = \frac{101325 \cdot 100}{8,31446261815 \cdot 298,15} = 4087,40\text{ моль} $$

Ця кількість молів залишається незмінною протягом усього процесу нагрівання згідно із законом збереження маси.

#### Крок 2: Розрахунок кількості молів кожного компонента
Оскільки в умовах задачі маємо справу з сумішшю ідеальних газів при однакових умовах (температурі та тиску), об'ємні частки компонентів чисельно дорівнюють їх мольним часткам. Це дозволяє розрахувати кількість молів кожного компонента:

- CO (87,4%): $n_{CO} = 0,874 \cdot 4087,40 = 3572,39 \text{ моль}$
- CO₂ (10,1%): $n_{CO_2} = 0,101 \cdot 4087,40 = 412,83 \text{ моль}$
- O₂ (1,6%): $n_{O_2} = 0,016 \cdot 4087,40 = 65,40 \text{ моль}$
- N₂ (0,9%): $n_{N_2} = 0,009 \cdot 4087,40 = 36,79 \text{ моль}$

Фізичний зміст: при однакових умовах (температурі та тиску) в рівних об'ємах різних газів міститься однакова кількість молекул, тому об'ємні частки пропорційні кількості молів.

#### Крок 3: Розрахунок теплоємності при сталому тиску
Для кожного компонента теплоємність при сталому тиску виражається формулою:
$$ c_p = a + bT + cT^{-2} \text{ кал/(моль·К)} $$

Спочатку підставляємо коефіцієнти з таблиці для кожного газу:

Для CO (a = 6.79, b = 0.98·10⁻³, c = -0.11·10⁵):
$$ c_p^{CO} = 6.79 + 0.98 \cdot 10^{-3}T - 0.11 \cdot 10^{5}T^{-2} \text{ кал/(моль·К)} $$

Для CO₂ (a = 10.55, b = 2.16·10⁻³, c = -2.04·10⁵):
$$ c_p^{CO_2} = 10.55 + 2.16 \cdot 10^{-3}T - 2.04 \cdot 10^{5}T^{-2} \text{ кал/(моль·К)} $$

Для O₂ (a = 7.16, b = 1.0·10⁻³, c = -0.40·10⁵):
$$ c_p^{O_2} = 7.16 + 1.0 \cdot 10^{-3}T - 0.40 \cdot 10^{5}T^{-2} \text{ кал/(моль·К)} $$

Для N₂ (a = 6.66, b = 1.02·10⁻³, c = 0):
$$ c_p^{N_2} = 6.66 + 1.02 \cdot 10^{-3}T \text{ кал/(моль·К)} $$

Переводимо коефіцієнти в Дж/(моль·К), помноживши на 4.1868:

Для CO:
$$ c_p^{CO} = 28.41 + 4.10 \cdot 10^{-3}T - 0.46 \cdot 10^{5}T^{-2} \text{ Дж/(моль·К)} $$

Для CO₂:
$$ c_p^{CO_2} = 44.14 + 9.04 \cdot 10^{-3}T - 8.54 \cdot 10^{5}T^{-2} \text{ Дж/(моль·К)} $$

Для O₂:
$$ c_p^{O_2} = 29.96 + 4.18 \cdot 10^{-3}T - 1.67 \cdot 10^{5}T^{-2} \text{ Дж/(моль·К)} $$

Для N₂:
$$ c_p^{N_2} = 27.87 + 4.27 \cdot 10^{-3}T \text{ Дж/(моль·К)} $$

#### Крок 4: Перетворення теплоємності $c_p$ в $c_v$
Для переходу від $c_p$ до $c_v$ використовуємо рівняння Майєра:
$$ c_v = c_p - R $$

де $R = 8.31446261815 \text{ Дж/(моль·К)}$

Тоді для кожного компонента:
$$ c_v^{CO} = (28.41 + 4.10 \cdot 10^{-3}T - 0.46 \cdot 10^{5}T^{-2}) - 8.31446261815 = 20.096 + 4.10 \cdot 10^{-3}T - 0.46 \cdot 10^{5}T^{-2} $$
$$ c_v^{CO_2} = (44.14 + 9.04 \cdot 10^{-3}T - 8.54 \cdot 10^{5}T^{-2}) - 8.31446261815 = 35.826 + 9.04 \cdot 10^{-3}T - 8.54 \cdot 10^{5}T^{-2} $$
$$ c_v^{O_2} = (29.96 + 4.18 \cdot 10^{-3}T - 1.67 \cdot 10^{5}T^{-2}) - 8.31446261815 = 21.646 + 4.18 \cdot 10^{-3}T - 1.67 \cdot 10^{5}T^{-2} $$
$$ c_v^{N_2} = (27.87 + 4.27 \cdot 10^{-3}T) - 8.31446261815 = 19.556 + 4.27 \cdot 10^{-3}T $$

#### Крок 5: Розрахунок теплоти нагрівання
Кількість теплоти для нагрівання кожного компонента від T₁ = 298,15 K до T₂ = 1273,15 K:
$$ Q_v = n\int_{T_1}^{T_2} c_v dT = n[(a-R)(T_2 - T_1) + \frac{b}{2}(T_2^2 - T_1^2) - c(\frac{1}{T_2} - \frac{1}{T_1})] $$

Для CO:
$$ Q_v^{CO} = 3572.39[(28.41 - 8.31446261815)(1273.15 - 298.15) + \frac{4.10 \cdot 10^{-3}}{2}(1273.15^2 - 298.15^2) - (-0.46 \cdot 10^{5})(\frac{1}{1273.15} - \frac{1}{298.15})] $$
$$ Q_v^{CO} = 80863.76 \text{ кДж} $$

Для CO₂:
$$ Q_v^{CO_2} = 412.83[(44.14 - 8.31446261815)(1273.15 - 298.15) + \frac{9.04 \cdot 10^{-3}}{2}(1273.15^2 - 298.15^2) - (-8.54 \cdot 10^{5})(\frac{1}{1273.15} - \frac{1}{298.15})] $$
$$ Q_v^{CO_2} = 16386.55 \text{ кДж} $$

Для O₂:
$$ Q_v^{O_2} = 65.40[(29.96 - 8.31446261815)(1273.15 - 298.15) + \frac{4.18 \cdot 10^{-3}}{2}(1273.15^2 - 298.15^2) - (-1.67 \cdot 10^{5})(\frac{1}{1273.15} - \frac{1}{298.15})] $$
$$ Q_v^{O_2} = 1562.92 \text{ кДж} $$

Для N₂:
$$ Q_v^{N_2} = 36.79[(27.87 - 8.31446261815)(1273.15 - 298.15) + \frac{4.27 \cdot 10^{-3}}{2}(1273.15^2 - 298.15^2)] $$
$$ Q_v^{N_2} = 822.24 \text{ кДж} $$

#### Крок 6: Розрахунок загальної теплоти нагрівання суміші
За правилом адитивності:
$$ Q_{v,сум} = Q_v^{CO} + Q_v^{CO_2} + Q_v^{O_2} + Q_v^{N_2} $$
$$ Q_{v,сум} = 80863.76 + 16386.55 + 1562.92 + 822.24 = 99635.48 \text{ кДж} $$


```python
"""
Розрахунок теплоємності газової суміші та теплоти нагрівання.
Суміш: CO (87.4%), CO₂ (10.1%), O₂ (1.6%), N₂ (0.9%)
"""

import numpy as np
from scipy import integrate
import matplotlib.pyplot as plt

# Константи
R = 8.31446261815  # Дж/(моль·К)
CAL_TO_JOULE = 4.1868  # Дж/кал
P_STANDARD = 101325  # Па (1 атм)
T_STANDARD = 273.15  # К (0°C)

# Коефіцієнти для газів (в кал/(моль·К))
# CO
a_co = 6.79
b_co = 0.98/1e3  # Ділимо на 1e3 згідно з таблицею
c_co = -0.11*1e5  # Множимо на 1e5 згідно з таблицею

# CO₂
a_co2 = 10.55
b_co2 = 2.16/1e3
c_co2 = -2.04*1e5

# O₂
a_o2 = 7.16
b_o2 = 1.0/1e3
c_o2 = -0.4*1e5

# N₂
a_n2 = 6.66
b_n2 = 1.02/1e3
c_n2 = 0  # для N₂ немає коефіцієнта c

# Об'ємні частки компонентів
r_co = 0.874   # CO
r_co2 = 0.101  # CO₂
r_o2 = 0.016   # O₂
r_n2 = 0.009   # N₂

# Параметри процесу
volume = 100  # м³
t1 = 25       # °C
t2 = 1000     # °C
T1 = t1 + T_STANDARD  # K
T2 = t2 + T_STANDARD  # K

print("1. Температури:")
print(f"   T1 = {t1}°C = {T1:.2f} К")
print(f"   T2 = {t2}°C = {T2:.2f} К")
```

    1. Температури:
       T1 = 25°C = 298.15 К
       T2 = 1000°C = 1273.15 К
    


```python
# Перевірка діапазону температур
T_MIN = 298  # К
T_MAX = 2500  # К

for T in [T1, T2]:
    if not (T_MIN <= T <= T_MAX):
        print(f"\nУВАГА: Температура {T:.2f} К виходить за межі діапазону {T_MIN}-{T_MAX} К")
        print("Результати можуть бути неточними!")
```


```python
print("\n2. Склад газової суміші:")
print(f"   CO:  {r_co*100:.1f}%")
print(f"   CO₂: {r_co2*100:.1f}%")
print(f"   O₂:  {r_o2*100:.1f}%")
print(f"   N₂:  {r_n2*100:.1f}%")
```

    
    2. Склад газової суміші:
       CO:  87.4%
       CO₂: 10.1%
       O₂:  1.6%
       N₂:  0.9%
    


```python
# Розрахунок кількості речовини
n = (P_STANDARD * volume) / (R * T1)
print(f"\n3. Кількість речовини:")
print(f"   n = {n:.2f} моль")
```

    
    3. Кількість речовини:
       n = 4087.40 моль
    


```python
# Розрахунок кількості речовини для кожного компонента
n_co = n * r_co
n_co2 = n * r_co2
n_o2 = n * r_o2
n_n2 = n * r_n2

print("\n   Кількість речовини кожного компонента:")
print(f"   CO:  {n_co:.2f} моль")
print(f"   CO₂: {n_co2:.2f} моль")
print(f"   O₂:  {n_o2:.2f} моль")
print(f"   N₂:  {n_n2:.2f} моль")
```

    
       Кількість речовини кожного компонента:
       CO:  3572.39 моль
       CO₂: 412.83 моль
       O₂:  65.40 моль
       N₂:  36.79 моль
    


```python
# Переведення R в кал/(моль·К)
R_cal = R / CAL_TO_JOULE
```


```python
# Розрахунок коефіцієнтів для cv
# CO
a_v_co = (a_co - R_cal) * CAL_TO_JOULE
b_v_co = b_co * CAL_TO_JOULE
c_v_co = c_co * CAL_TO_JOULE
```


```python
# CO₂
a_v_co2 = (a_co2 - R_cal) * CAL_TO_JOULE
b_v_co2 = b_co2 * CAL_TO_JOULE
c_v_co2 = c_co2 * CAL_TO_JOULE
```


```python
# O₂
a_v_o2 = (a_o2 - R_cal) * CAL_TO_JOULE
b_v_o2 = b_o2 * CAL_TO_JOULE
c_v_o2 = c_o2 * CAL_TO_JOULE
```


```python
# N₂
a_v_n2 = (a_n2 - R_cal) * CAL_TO_JOULE
b_v_n2 = b_n2 * CAL_TO_JOULE
c_v_n2 = 0
```


```python
# Функції теплоємності для кожного компонента
cv_co = lambda T: a_v_co + b_v_co*T + c_v_co/(T*T)
cv_co2 = lambda T: a_v_co2 + b_v_co2*T + c_v_co2/(T*T)
cv_o2 = lambda T: a_v_o2 + b_v_o2*T + c_v_o2/(T*T)
cv_n2 = lambda T: a_v_n2 + b_v_n2*T + c_v_n2/(T*T)
```


```python
# Аналітичний розрахунок для кожного компонента
Q_co_analytical = n_co * (
        a_v_co * (T2 - T1) +
        b_v_co * (T2**2 - T1**2) / 2 +
        c_v_co * (-1/T2 + 1/T1)
)
```


```python
Q_co2_analytical = n_co2 * (
        a_v_co2 * (T2 - T1) +
        b_v_co2 * (T2**2 - T1**2) / 2 +
        c_v_co2 * (-1/T2 + 1/T1)
)
```


```python
Q_o2_analytical = n_o2 * (
        a_v_o2 * (T2 - T1) +
        b_v_o2 * (T2**2 - T1**2) / 2 +
        c_v_o2 * (-1/T2 + 1/T1)
)
```


```python
Q_n2_analytical = n_n2 * (
        a_v_n2 * (T2 - T1) +
        b_v_n2 * (T2**2 - T1**2) / 2 +
        c_v_n2 * (-1/T2 + 1/T1)
)
```


```python
# Загальна теплота (аналітично)
Q_analytical = Q_co_analytical + Q_co2_analytical + Q_o2_analytical + Q_n2_analytical
```


```python
# Числові розрахунки
steps = 1000
T = np.linspace(T1, T2, steps)
```


```python
# Метод трапецій для кожного компонента
Q_co = n_co * np.trapezoid([cv_co(t) for t in T], T)
```


```python
Q_co2 = n_co2 * np.trapezoid([cv_co2(t) for t in T], T)
```


```python
Q_o2 = n_o2 * np.trapezoid([cv_o2(t) for t in T], T)
```


```python
Q_n2 = n_n2 * np.trapezoid([cv_n2(t) for t in T], T)
```


```python
# Загальна теплота (метод трапецій)
Q_trapz = Q_co + Q_co2 + Q_o2 + Q_n2
```


```python
# Метод Сімпсона для кожного компонента
Q_co_simpson = n_co * integrate.simpson(y=[cv_co(t) for t in T], x=T)
```


```python
Q_co2_simpson = n_co2 * integrate.simpson(y=[cv_co2(t) for t in T], x=T)
```


```python
Q_o2_simpson = n_o2 * integrate.simpson(y=[cv_o2(t) for t in T], x=T)
```


```python
Q_n2_simpson = n_n2 * integrate.simpson(y=[cv_n2(t) for t in T], x=T)
```


```python
# Загальна теплота (метод Сімпсона)
Q_simpson = Q_co_simpson + Q_co2_simpson + Q_o2_simpson + Q_n2_simpson
```


```python
# Різниця між методами
diff_trapz = abs(Q_analytical - Q_trapz)/1000
diff_simpson = abs(Q_analytical - Q_simpson)/1000
print(f"\tРізниця між аналітичним та трапецій: {diff_trapz:.4f} кДж")
print(f"\tРізниця між аналітичним та Сімпсона: {diff_simpson:.4f} кДж")
```

    	Різниця між аналітичним та трапецій: 0.0031 кДж
    	Різниця між аналітичним та Сімпсона: 0.0000 кДж
    


```python
# Відносні похибки
error_trapz = diff_trapz/(Q_analytical/1000)*100
error_simpson = diff_simpson/(Q_analytical/1000)*100
print(f"\tВідносна похибка (трапеції): {error_trapz:.6f}%")
print(f"\tВідносна похибка (Сімпсон): {error_simpson:.6f}%")
```

    	Відносна похибка (трапеції): 0.000003%
    	Відносна похибка (Сімпсон): 0.000000%
    


```python
print("\n6. Внесок кожного компонента в теплоту нагрівання:")
print(f"   CO:  {Q_co/1000:.2f} кДж ({Q_co/Q_trapz*100:.1f}%)")
print(f"   CO₂: {Q_co2/1000:.2f} кДж ({Q_co2/Q_trapz*100:.1f}%)")
print(f"   O₂:  {Q_o2/1000:.2f} кДж ({Q_o2/Q_trapz*100:.1f}%)")
print(f"   N₂:  {Q_n2/1000:.2f} кДж ({Q_n2/Q_trapz*100:.1f}%)")
```

    
    6. Внесок кожного компонента в теплоту нагрівання:
       CO:  80863.76 кДж (81.2%)
       CO₂: 16386.55 кДж (16.4%)
       O₂:  1562.92 кДж (1.6%)
       N₂:  822.24 кДж (0.8%)
    


```python
print("\n7. Перевірка розмірностей:")
print(f"   Теплоємність: [Дж/(моль·К)]")
print(f"   Кількість речовини: [моль]")
print(f"   Температура: [К]")
print(f"   Теплота: [Дж/(моль·К)] · [моль] · [К] = [Дж] ✓")
```

    
    7. Перевірка розмірностей:
       Теплоємність: [Дж/(моль·К)]
       Кількість речовини: [моль]
       Температура: [К]
       Теплота: [Дж/(моль·К)] · [моль] · [К] = [Дж] ✓
    


```python
# Функція для розрахунку cv суміші в залежності від температури
def cv_mix(T, composition={"co": r_co, "co2": r_co2, "o2": r_o2, "n2": r_n2}):
    return (composition["co"] * cv_co(T) +
            composition["co2"] * cv_co2(T) +
            composition["o2"] * cv_o2(T) +
            composition["n2"] * cv_n2(T))
```


```python
# Побудова графіка теплоємності для суміші та кожного компонента
plot_temperatures = np.linspace(T1, T2, 100)
plt.figure(figsize=(8, 6))

# Графік теплоємності для кожного компонента
plt.plot(plot_temperatures - 273.15, [cv_co(T) for T in plot_temperatures], 'r-', label='CO')
plt.plot(plot_temperatures - 273.15, [cv_co2(T) for T in plot_temperatures], 'b-', label='CO₂')
plt.plot(plot_temperatures - 273.15, [cv_o2(T) for T in plot_temperatures], 'g-', label='O₂')
plt.plot(plot_temperatures - 273.15, [cv_n2(T) for T in plot_temperatures], 'k-', label='N₂')

# Додаємо графік теплоємності суміші
plt.plot(plot_temperatures - 273.15, [cv_mix(T) for T in plot_temperatures], 'm--', linewidth=2, label='Суміш')
plt.xlabel('Температура, °C')
plt.ylabel('Теплоємність при сталому об\'ємі, Дж/(моль·К)')
plt.title('Теплоємність суміші та її компонентів при сталому об\'ємі')
plt.grid(True)
plt.legend(loc='best')

# Додаємо додаткові пояснення до графіка
plt.figtext(0.5, 0.01, 'Пунктирна лінія показує теплоємність суміші, яка є середньозваженою від теплоємностей компонентів',
            ha='center', fontsize=10, bbox={"facecolor":"white", "alpha":0.5, "pad":5})

plt.tight_layout(rect=[0, 0.05, 1, 1])
plt.savefig("mixture_and_components_cv.png", dpi=300)
plt.show()
```


    
![png](output_33_0.png)
    



```python
# Додатковий графік - зміна теплоємності суміші з температурою
plt.figure(figsize=(8, 6))
plt.plot(plot_temperatures - 273.15, [cv_mix(T) for T in plot_temperatures], 'r-', linewidth=2)
plt.xlabel('Температура, °C')
plt.ylabel('Теплоємність суміші, Дж/(моль·К)')
plt.title('Зміна теплоємності суміші з температурою')
plt.grid(True)
plt.tight_layout()
plt.savefig("mixture_cv.png", dpi=300)
plt.show()
```


    
![png](output_34_0.png)
    



```python
"""
Розрахунок теплоємності газової суміші та теплоти нагрівання з урахуванням зміни складу суміші.
Склад суміші змінюється на кожному кроці нагрівання.
"""
# Склад газової суміші на кожному кроці (у відсотках)
co_percentages = [87.4, 87.1, 82.7, 77.6, 73.5, 67.3, 55.5, 40.1, 25.9, 20.3, 12.5, 8.8]
co2_percentages = [10.1, 10.6, 15.2, 20.6, 25, 31.5, 43.5, 59.1, 73.4, 79.2, 87.1, 91.0]
o2_percentages = [1.6, 1.45, 1.3, 1.1, 0.9, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1]
n2_percentages = [0.9, 0.85, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.3, 0.2, 0.2, 0.1]

# co_percentages = [87.4]*12
# co2_percentages = [10.1]*12
# o2_percentages = [1.6]*12
# n2_percentages = [0.9]*12
```


```python
# Параметри для побудови графіка
time_per_step = 10  # Час на один крок, хв

# Список температур на кожному кроці (в градусах Цельсія)
temperatures = [25, 114, 202, 291, 380, 468, 557, 645, 734, 823, 911, 1000]
```


```python
# Перевірка на однакову довжину всіх списків
steps = len(temperatures)
if not (len(co_percentages) == steps and len(co2_percentages) == steps and
        len(o2_percentages) == steps and len(n2_percentages) == steps):
    raise ValueError("Усі списки повинні мати однакову довжину!")
```


```python
# Перетворення температур у Кельвіни
temperatures_K = [t + T_STANDARD for t in temperatures]
```


```python
# Переведення відсотків у долі одиниці
co_fractions = [p / 100 for p in co_percentages]
co2_fractions = [p / 100 for p in co2_percentages]
o2_fractions = [p / 100 for p in o2_percentages]
n2_fractions = [p / 100 for p in n2_percentages]
```


```python
# Переведення R в кал/(моль·К)
R_cal = R / CAL_TO_JOULE
```


```python
# Функція для розрахунку cv для компонентів
def get_cv_coefficients():
    # CO
    a_v_co = (a_co - R_cal) * CAL_TO_JOULE
    b_v_co = b_co * CAL_TO_JOULE
    c_v_co = c_co * CAL_TO_JOULE

    # CO₂
    a_v_co2 = (a_co2 - R_cal) * CAL_TO_JOULE
    b_v_co2 = b_co2 * CAL_TO_JOULE
    c_v_co2 = c_co2 * CAL_TO_JOULE

    # O₂
    a_v_o2 = (a_o2 - R_cal) * CAL_TO_JOULE
    b_v_o2 = b_o2 * CAL_TO_JOULE
    c_v_o2 = c_o2 * CAL_TO_JOULE

    # N₂
    a_v_n2 = (a_n2 - R_cal) * CAL_TO_JOULE
    b_v_n2 = b_n2 * CAL_TO_JOULE
    c_v_n2 = 0

    return (a_v_co, b_v_co, c_v_co,
            a_v_co2, b_v_co2, c_v_co2,
            a_v_o2, b_v_o2, c_v_o2,
            a_v_n2, b_v_n2, c_v_n2)
```


```python
# Отримання коефіцієнтів
a_v_co, b_v_co, c_v_co, a_v_co2, b_v_co2, c_v_co2, a_v_o2, b_v_o2, c_v_o2, a_v_n2, b_v_n2, c_v_n2 = get_cv_coefficients()
```


```python
# Функції теплоємності для кожного компонента
cv_co = lambda T: a_v_co + b_v_co*T + c_v_co/(T*T)
cv_co2 = lambda T: a_v_co2 + b_v_co2*T + c_v_co2/(T*T)
cv_o2 = lambda T: a_v_o2 + b_v_o2*T + c_v_o2/(T*T)
cv_n2 = lambda T: a_v_n2 + b_v_n2*T + c_v_n2/(T*T)
```


```python
# Вивід вхідних даних
print("=" * 60)
print("ВХІДНІ ДАНІ:")
print("=" * 60)
print(f"Об'єм газової суміші: {volume} м³")
print("\nСклад суміші на кожному кроці (відсотки):")
print("-" * 60)
print("Крок | Температура |    CO    |    CO₂   |    O₂    |    N₂    |")
print("-" * 60)
for i in range(steps):
    print(f"{i+1:4d} | {temperatures[i]:11d} | {co_percentages[i]:8.1f} | {co2_percentages[i]:8.1f} | {o2_percentages[i]:8.1f} | {n2_percentages[i]:8.1f} |")
print("-" * 60)
```

    ============================================================
    ВХІДНІ ДАНІ:
    ============================================================
    Об'єм газової суміші: 100 м³
    
    Склад суміші на кожному кроці (відсотки):
    ------------------------------------------------------------
    Крок | Температура |    CO    |    CO₂   |    O₂    |    N₂    |
    ------------------------------------------------------------
       1 |          25 |     87.4 |     10.1 |      1.6 |      0.9 |
       2 |         114 |     87.1 |     10.6 |      1.4 |      0.8 |
       3 |         202 |     82.7 |     15.2 |      1.3 |      0.8 |
       4 |         291 |     77.6 |     20.6 |      1.1 |      0.7 |
       5 |         380 |     73.5 |     25.0 |      0.9 |      0.6 |
       6 |         468 |     67.3 |     31.5 |      0.7 |      0.5 |
       7 |         557 |     55.5 |     43.5 |      0.6 |      0.4 |
       8 |         645 |     40.1 |     59.1 |      0.5 |      0.3 |
       9 |         734 |     25.9 |     73.4 |      0.4 |      0.3 |
      10 |         823 |     20.3 |     79.2 |      0.3 |      0.2 |
      11 |         911 |     12.5 |     87.1 |      0.2 |      0.2 |
      12 |        1000 |      8.8 |     91.0 |      0.1 |      0.1 |
    ------------------------------------------------------------
    


```python
# Початок розрахунків
q_values = []  # Зберігатимемо теплоту для кожного кроку
step_details = []  # Зберігатимемо деталі по кожному кроку
total_heat = 0  # Загальна теплота нагрівання
```


```python
print("\n" + "=" * 60)
print("РОЗРАХУНКИ:")
print("=" * 60)

# Розрахунок теплоти для кожного кроку
for i in range(steps - 1):
    T1 = temperatures_K[i]
    T2 = temperatures_K[i + 1]

    # Розрахунок кількості речовини на початку кроку
    n = (P_STANDARD * volume) / (R * T1)

    # Склад на поточному кроці
    r_co = co_fractions[i]
    r_co2 = co2_fractions[i]
    r_o2 = o2_fractions[i]
    r_n2 = n2_fractions[i]

    # Кількість речовини для кожного компонента
    n_co = n * r_co
    n_co2 = n * r_co2
    n_o2 = n * r_o2
    n_n2 = n * r_n2

    # Аналітичний розрахунок для кожного компонента
    Q_co = n_co * (
            a_v_co * (T2 - T1) +
            b_v_co * (T2**2 - T1**2) / 2 +
            c_v_co * (-1/T2 + 1/T1)
    )

    Q_co2 = n_co2 * (
            a_v_co2 * (T2 - T1) +
            b_v_co2 * (T2**2 - T1**2) / 2 +
            c_v_co2 * (-1/T2 + 1/T1)
    )

    Q_o2 = n_o2 * (
            a_v_o2 * (T2 - T1) +
            b_v_o2 * (T2**2 - T1**2) / 2 +
            c_v_o2 * (-1/T2 + 1/T1)
    )

    Q_n2 = n_n2 * (
            a_v_n2 * (T2 - T1) +
            b_v_n2 * (T2**2 - T1**2) / 2 +
            c_v_n2 * (-1/T2 + 1/T1)
    )

    # Загальна теплота для поточного кроку
    Q_step = Q_co + Q_co2 + Q_o2 + Q_n2

    # Додавання до списку значень
    q_values.append(Q_step)
    total_heat += Q_step

    # Зберігаємо деталі для кожного кроку
    step_details.append({
        "step": i + 1,
        "T1": T1 - T_STANDARD,
        "T2": T2 - T_STANDARD,
        "delta_T": T2 - T1,
        "n": n,
        "Q_co": Q_co,
        "Q_co2": Q_co2,
        "Q_o2": Q_o2,
        "Q_n2": Q_n2,
        "Q_step": Q_step,
        "co_percent": co_percentages[i],
        "co2_percent": co2_percentages[i],
        "o2_percent": o2_percentages[i],
        "n2_percent": n2_percentages[i]
    })

# Виведення результатів по кожному кроку
print("\nРезультати розрахунку по кожному кроку:")
print("-" * 90)
print("Крок | T1 (°C) | T2 (°C) | ΔT (K) |  n (моль) |  CO (%)  |  CO₂ (%) |  Q (кДж)  | % від загального")
print("-" * 90)

for detail in step_details:
    print(f"{detail['step']:4d} | {detail['T1']:7.1f} | {detail['T2']:7.1f} | {detail['delta_T']:6.1f} | {detail['n']:9.2f} | {detail['co_percent']:8.1f} | {detail['co2_percent']:8.1f} | {detail['Q_step']/1000:9.2f} | {detail['Q_step']/total_heat*100:8.2f}")

print("-" * 90)
print(f"Загальна теплота: {total_heat/1000:.2f} кДж")

print("\nВнесок компонентів у загальну теплоту:")
total_co = sum(detail["Q_co"] for detail in step_details)
total_co2 = sum(detail["Q_co2"] for detail in step_details)
total_o2 = sum(detail["Q_o2"] for detail in step_details)
total_n2 = sum(detail["Q_n2"] for detail in step_details)

print(f"CO:  {total_co/1000:.2f} кДж ({total_co/total_heat*100:.1f}%)")
print(f"CO₂: {total_co2/1000:.2f} кДж ({total_co2/total_heat*100:.1f}%)")
print(f"O₂:  {total_o2/1000:.2f} кДж ({total_o2/total_heat*100:.1f}%)")
print(f"N₂:  {total_n2/1000:.2f} кДж ({total_n2/total_heat*100:.1f}%)")
```

    
    ============================================================
    РОЗРАХУНКИ:
    ============================================================
    
    Результати розрахунку по кожному кроку:
    ------------------------------------------------------------------------------------------
    Крок | T1 (°C) | T2 (°C) | ΔT (K) |  n (моль) |  CO (%)  |  CO₂ (%) |  Q (кДж)  | % від загального
    ------------------------------------------------------------------------------------------
       1 |    25.0 |   114.0 |   89.0 |   4087.40 |     87.4 |     10.1 |   8069.48 |    14.85
       2 |   114.0 |   202.0 |   88.0 |   3147.77 |     87.1 |     10.6 |   6391.30 |    11.77
       3 |   202.0 |   291.0 |   89.0 |   2564.79 |     82.7 |     15.2 |   5572.36 |    10.26
       4 |   291.0 |   380.0 |   89.0 |   2160.17 |     77.6 |     20.6 |   4981.06 |     9.17
       5 |   380.0 |   468.0 |   88.0 |   1865.82 |     73.5 |     25.0 |   4477.32 |     8.24
       6 |   468.0 |   557.0 |   89.0 |   1644.28 |     67.3 |     31.5 |   4249.55 |     7.82
       7 |   557.0 |   645.0 |   88.0 |   1468.00 |     55.5 |     43.5 |   4122.65 |     7.59
       8 |   645.0 |   734.0 |   89.0 |   1327.30 |     40.1 |     59.1 |   4207.59 |     7.75
       9 |   734.0 |   823.0 |   89.0 |   1210.01 |     25.9 |     73.4 |   4224.01 |     7.78
      10 |   823.0 |   911.0 |   88.0 |   1111.76 |     20.3 |     79.2 |   4030.48 |     7.42
      11 |   911.0 |  1000.0 |   89.0 |   1029.14 |     12.5 |     87.1 |   3998.88 |     7.36
    ------------------------------------------------------------------------------------------
    Загальна теплота: 54324.68 кДж
    
    Внесок компонентів у загальну теплоту:
    CO:  28800.52 кДж (53.0%)
    CO₂: 24803.62 кДж (45.7%)
    O₂:  455.12 кДж (0.8%)
    N₂:  265.42 кДж (0.5%)
    


```python
# Створення списку часу на основі часу на один крок
times = [i * time_per_step for i in range(steps - 1)]
```


```python
# Побудова графіків окремо

# 1. Графік зміни складу суміші
plt.figure(figsize=(8, 6))
plt.plot(times, [detail["co_percent"] for detail in step_details], 'y-', label='CO')
plt.plot(times, [detail["co2_percent"] for detail in step_details], 'b-', label='CO₂')
plt.plot(times, [detail["o2_percent"] for detail in step_details], 'g-', label='O₂')
plt.plot(times, [detail["n2_percent"] for detail in step_details], 'k-', label='N₂')
plt.xlabel('Час, хв')
plt.ylabel('Склад, %')
plt.title('Зміна складу суміші під час процесу')
plt.grid(True)
plt.legend()
plt.tight_layout()
plt.show()
```


    
![png](output_48_0.png)
    



```python
# 2. Графік зміни температури
plt.figure(figsize=(8, 6))
t_values = [detail["T1"] for detail in step_details] + [step_details[-1]["T2"]]
time_values = [i * time_per_step for i in range(len(t_values))]
plt.plot(time_values, t_values, 'r-o')
plt.xlabel('Час, хв')
plt.ylabel('Температура, °C')
plt.title('Зміна температури під час процесу')
plt.grid(True)
plt.tight_layout()
plt.show()
```


    
![png](output_49_0.png)
    



```python
# 3. Графік теплоти на кожному кроці
plt.figure(figsize=(8, 6))
plt.bar(range(1, len(step_details) + 1), [detail["Q_step"]/1000 for detail in step_details])
plt.xlabel('Крок')
plt.ylabel('Теплота, кДж')
plt.title('Теплота, поглинута на кожному кроці')
plt.xticks(range(1, len(step_details) + 1))
plt.grid(True)
plt.tight_layout()
plt.show()
```


    
![png](output_50_0.png)
    



```python
# 4. Графік внеску компонентів на кожному кроці
plt.figure(figsize=(8, 6))
q_steps = np.array([detail["Q_step"] for detail in step_details])
q_co = np.array([detail["Q_co"] for detail in step_details])
q_co2 = np.array([detail["Q_co2"] for detail in step_details])
q_o2 = np.array([detail["Q_o2"] for detail in step_details])
q_n2 = np.array([detail["Q_n2"] for detail in step_details])

plt.stackplot(range(1, len(step_details) + 1),
              [q_co/1000, q_co2/1000, q_o2/1000, q_n2/1000],
              labels=['CO', 'CO₂', 'O₂', 'N₂'],
              colors=['gold', 'b', 'g', 'k'])
plt.xlabel('Крок')
plt.ylabel('Теплота, кДж')
plt.title('Внесок кожного компонента в теплоту на кожному кроці')
plt.xticks(range(1, len(step_details) + 1))
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.show()
```


    
![png](output_51_0.png)
    



```python
"""
Розрахунок теплоємності газової суміші та теплоти нагрівання з урахуванням зміни складу суміші.
Модель з постійною кількістю речовини (маси) та змінним тиском у замкненій системі.
"""
# Розрахунок початкової кількості речовини (при T1 і P_STANDARD)
n_initial = (P_STANDARD * volume) / (R * temperatures_K[0])

# Розрахунок тисків на кожному кроці (Закон ідеального газу: P = nRT/V)
pressures = [(n_initial * R * T) / volume for T in temperatures_K]
pressure_atm = [p / P_STANDARD for p in pressures]  # Тиск в атмосферах
```


```python
# Вивід вхідних даних
print("=" * 60)
print("ВХІДНІ ДАНІ:")
print("=" * 60)
print(f"Об'єм газової суміші: {volume} м³")
print(f"Початкова кількість речовини: {n_initial:.2f} моль")
print(f"Початковий тиск: {P_STANDARD/1000:.2f} кПа ({1.0:.2f} атм)")

print("\nСклад суміші на кожному кроці (відсотки):")
print("-" * 60)
print("Крок | Температура |    CO    |    CO₂   |    O₂    |    N₂    |")
print("-" * 60)
for i in range(steps):
    print(f"{i+1:4d} | {temperatures[i]:11d} | {co_percentages[i]:8.1f} | {co2_percentages[i]:8.1f} | {o2_percentages[i]:8.1f} | {n2_percentages[i]:8.1f} |")
print("-" * 60)
```

    ============================================================
    ВХІДНІ ДАНІ:
    ============================================================
    Об'єм газової суміші: 100 м³
    Початкова кількість речовини: 4087.40 моль
    Початковий тиск: 101.33 кПа (1.00 атм)
    
    Склад суміші на кожному кроці (відсотки):
    ------------------------------------------------------------
    Крок | Температура |    CO    |    CO₂   |    O₂    |    N₂    |
    ------------------------------------------------------------
       1 |          25 |     87.4 |     10.1 |      1.6 |      0.9 |
       2 |         114 |     87.1 |     10.6 |      1.4 |      0.8 |
       3 |         202 |     82.7 |     15.2 |      1.3 |      0.8 |
       4 |         291 |     77.6 |     20.6 |      1.1 |      0.7 |
       5 |         380 |     73.5 |     25.0 |      0.9 |      0.6 |
       6 |         468 |     67.3 |     31.5 |      0.7 |      0.5 |
       7 |         557 |     55.5 |     43.5 |      0.6 |      0.4 |
       8 |         645 |     40.1 |     59.1 |      0.5 |      0.3 |
       9 |         734 |     25.9 |     73.4 |      0.4 |      0.3 |
      10 |         823 |     20.3 |     79.2 |      0.3 |      0.2 |
      11 |         911 |     12.5 |     87.1 |      0.2 |      0.2 |
      12 |        1000 |      8.8 |     91.0 |      0.1 |      0.1 |
    ------------------------------------------------------------
    


```python
# Початок розрахунків
q_values = []  # Зберігатимемо теплоту для кожного кроку
step_details = []  # Зберігатимемо деталі по кожному кроку
total_heat = 0  # Загальна теплота нагрівання

print("\n" + "=" * 60)
print("РОЗРАХУНКИ:")
print("=" * 60)

# Розрахунок теплоти для кожного кроку
for i in range(steps - 1):
    T1 = temperatures_K[i]
    T2 = temperatures_K[i + 1]
    
    # Тиск на початку кроку (для інформації)
    P1 = pressures[i]
    
    # Склад на поточному кроці
    r_co = co_fractions[i]
    r_co2 = co2_fractions[i]
    r_o2 = o2_fractions[i]
    r_n2 = n2_fractions[i]
    
    # Кількість речовини для кожного компонента (незмінна загальна кількість)
    n_co = n_initial * r_co
    n_co2 = n_initial * r_co2
    n_o2 = n_initial * r_o2
    n_n2 = n_initial * r_n2
    
    # Аналітичний розрахунок для кожного компонента
    Q_co = n_co * (
            a_v_co * (T2 - T1) +
            b_v_co * (T2**2 - T1**2) / 2 +
            c_v_co * (-1/T2 + 1/T1)
    )
    
    Q_co2 = n_co2 * (
            a_v_co2 * (T2 - T1) +
            b_v_co2 * (T2**2 - T1**2) / 2 +
            c_v_co2 * (-1/T2 + 1/T1)
    )
    
    Q_o2 = n_o2 * (
            a_v_o2 * (T2 - T1) +
            b_v_o2 * (T2**2 - T1**2) / 2 +
            c_v_o2 * (-1/T2 + 1/T1)
    )
    
    Q_n2 = n_n2 * (
            a_v_n2 * (T2 - T1) +
            b_v_n2 * (T2**2 - T1**2) / 2 +
            c_v_n2 * (-1/T2 + 1/T1)
    )
    
    # Загальна теплота для поточного кроку
    Q_step = Q_co + Q_co2 + Q_o2 + Q_n2
    
    # Додавання до списку значень
    q_values.append(Q_step)
    total_heat += Q_step
    
    # Зберігаємо деталі для кожного кроку
    step_details.append({
        "step": i + 1,
        "T1": T1 - T_STANDARD,
        "T2": T2 - T_STANDARD,
        "delta_T": T2 - T1,
        "P1": P1/1000,  # кПа
        "P1_atm": pressure_atm[i],  # атм
        "Q_co": Q_co,
        "Q_co2": Q_co2,
        "Q_o2": Q_o2,
        "Q_n2": Q_n2,
        "Q_step": Q_step,
        "co_percent": co_percentages[i],
        "co2_percent": co2_percentages[i],
        "o2_percent": o2_percentages[i],
        "n2_percent": n2_percentages[i]
    })

# Виведення результатів по кожному кроку
print("\nРезультати розрахунку по кожному кроку:")
print("-" * 100)
print("Крок | T1 (°C) | T2 (°C) | ΔT (K) | P (кПа) | P (атм) |  CO (%)  |  CO₂ (%) |  Q (кДж)  | % від загального")
print("-" * 100)

for detail in step_details:
    print(f"{detail['step']:4d} | {detail['T1']:7.1f} | {detail['T2']:7.1f} | {detail['delta_T']:6.1f} | {detail['P1']:7.2f} | {detail['P1_atm']:7.2f} | {detail['co_percent']:8.1f} | {detail['co2_percent']:8.1f} | {detail['Q_step']/1000:9.2f} | {detail['Q_step']/total_heat*100:8.2f}")

print("-" * 100)
print(f"Загальна теплота: {total_heat/1000:.2f} кДж")

print("\nВнесок компонентів у загальну теплоту:")
total_co = sum(detail["Q_co"] for detail in step_details)
total_co2 = sum(detail["Q_co2"] for detail in step_details)
total_o2 = sum(detail["Q_o2"] for detail in step_details)
total_n2 = sum(detail["Q_n2"] for detail in step_details)

print(f"CO:  {total_co/1000:.2f} кДж ({total_co/total_heat*100:.1f}%)")
print(f"CO₂: {total_co2/1000:.2f} кДж ({total_co2/total_heat*100:.1f}%)")
print(f"O₂:  {total_o2/1000:.2f} кДж ({total_o2/total_heat*100:.1f}%)")
print(f"N₂:  {total_n2/1000:.2f} кДж ({total_n2/total_heat*100:.1f}%)")
```

    
    ============================================================
    РОЗРАХУНКИ:
    ============================================================
    
    Результати розрахунку по кожному кроку:
    ----------------------------------------------------------------------------------------------------
    Крок | T1 (°C) | T2 (°C) | ΔT (K) | P (кПа) | P (атм) |  CO (%)  |  CO₂ (%) |  Q (кДж)  | % від загального
    ----------------------------------------------------------------------------------------------------
       1 |    25.0 |   114.0 |   89.0 |  101.32 |    1.00 |     87.4 |     10.1 |   8069.48 |     6.48
       2 |   114.0 |   202.0 |   88.0 |  131.57 |    1.30 |     87.1 |     10.6 |   8299.15 |     6.67
       3 |   202.0 |   291.0 |   89.0 |  161.48 |    1.59 |     82.7 |     15.2 |   8880.45 |     7.14
       4 |   291.0 |   380.0 |   89.0 |  191.72 |    1.89 |     77.6 |     20.6 |   9425.01 |     7.57
       5 |   380.0 |   468.0 |   88.0 |  221.97 |    2.19 |     73.5 |     25.0 |   9808.35 |     7.88
       6 |   468.0 |   557.0 |   89.0 |  251.88 |    2.49 |     67.3 |     31.5 |  10563.65 |     8.49
       7 |   557.0 |   645.0 |   88.0 |  282.12 |    2.78 |     55.5 |     43.5 |  11478.84 |     9.22
       8 |   645.0 |   734.0 |   89.0 |  312.03 |    3.08 |     40.1 |     59.1 |  12957.24 |    10.41
       9 |   734.0 |   823.0 |   89.0 |  342.28 |    3.38 |     25.9 |     73.4 |  14268.70 |    11.47
      10 |   823.0 |   911.0 |   88.0 |  372.52 |    3.68 |     20.3 |     79.2 |  14818.09 |    11.91
      11 |   911.0 |  1000.0 |   89.0 |  402.43 |    3.97 |     12.5 |     87.1 |  15882.19 |    12.76
    ----------------------------------------------------------------------------------------------------
    Загальна теплота: 124451.15 кДж
    
    Внесок компонентів у загальну теплоту:
    CO:  51695.21 кДж (41.5%)
    CO₂: 71514.24 кДж (57.5%)
    O₂:  775.89 кДж (0.6%)
    N₂:  465.81 кДж (0.4%)
    


```python
# Створення списку часу на основі часу на один крок
times = [i * time_per_step for i in range(steps - 1)]
```


```python
# 1. Графік зміни складу суміші
plt.figure(figsize=(8, 6))
plt.plot(times, [detail["co_percent"] for detail in step_details], 'y-', label='CO')
plt.plot(times, [detail["co2_percent"] for detail in step_details], 'b-', label='CO₂')
plt.plot(times, [detail["o2_percent"] for detail in step_details], 'g-', label='O₂')
plt.plot(times, [detail["n2_percent"] for detail in step_details], 'k-', label='N₂')
plt.xlabel('Час, хв')
plt.ylabel('Склад, %')
plt.title('Зміна складу суміші під час процесу')
plt.grid(True)
plt.legend()
plt.tight_layout()
plt.show()
```


    
![png](output_56_0.png)
    



```python
# 2. Графік зміни температури
plt.figure(figsize=(8, 6))
t_values = [detail["T1"] for detail in step_details] + [step_details[-1]["T2"]]
time_values = [i * time_per_step for i in range(len(t_values))]
plt.plot(time_values, t_values, 'r-o')
plt.xlabel('Час, хв')
plt.ylabel('Температура, °C')
plt.title('Зміна температури під час процесу')
plt.grid(True)
plt.tight_layout()
plt.show()
```


    
![png](output_57_0.png)
    



```python
# 3. Графік теплоти на кожному кроці
plt.figure(figsize=(8, 6))
plt.bar(range(1, len(step_details) + 1), [detail["Q_step"]/1000 for detail in step_details])
plt.xlabel('Крок')
plt.ylabel('Теплота, кДж')
plt.title('Теплота, поглинута на кожному кроці')
plt.xticks(range(1, len(step_details) + 1))
plt.grid(True)
plt.tight_layout()
plt.show()
```


    
![png](output_58_0.png)
    



```python
# 4. Графік внеску компонентів на кожному кроці
plt.figure(figsize=(10, 6))
q_steps = np.array([detail["Q_step"] for detail in step_details])
q_co = np.array([detail["Q_co"] for detail in step_details])
q_co2 = np.array([detail["Q_co2"] for detail in step_details])
q_o2 = np.array([detail["Q_o2"] for detail in step_details])
q_n2 = np.array([detail["Q_n2"] for detail in step_details])

plt.stackplot(range(1, len(step_details) + 1), 
             [q_co/1000, q_co2/1000, q_o2/1000, q_n2/1000],
             labels=['CO', 'CO₂', 'O₂', 'N₂'],
             colors=['gold', 'b', 'g', 'k'])
plt.xlabel('Крок')
plt.ylabel('Теплота, кДж')
plt.title('Внесок кожного компонента в теплоту на кожному кроці')
plt.xticks(range(1, len(step_details) + 1))
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.show()
```


    
![png](output_59_0.png)
    



```python
# 5. Графік зміни тиску
plt.figure(figsize=(10, 6))
plt.plot(time_values, [p/1000 for p in pressures], 'b-o')
plt.xlabel('Час, хв')
plt.ylabel('Тиск, кПа')
plt.title('Зміна тиску під час нагрівання у замкненій системі')
plt.grid(True)
plt.tight_layout()
plt.show()
```


    
![png](output_60_0.png)
    



```python
# 6. Графік зміни тиску і температури
fig, ax1 = plt.subplots(figsize=(10, 6))

color = 'tab:red'
ax1.set_xlabel('Час, хв')
ax1.set_ylabel('Температура, °C', color=color)
ax1.plot(time_values, t_values, color=color, marker='o')
ax1.tick_params(axis='y', labelcolor=color)

ax2 = ax1.twinx()
color = 'tab:blue'
ax2.set_ylabel('Тиск, атм', color=color)
ax2.plot(time_values, pressure_atm, color=color, marker='s')
ax2.tick_params(axis='y', labelcolor=color)

plt.title('Зміна температури і тиску під час нагрівання')
fig.tight_layout()
plt.show()
```


    
![png](output_61_0.png)
    


# Аналіз моделювання термодинамічних процесів у газових сумішах: аналіз теплоємності та теплових ефектів при нагріванні

## Анотація

У даному дослідженні проведено комплексний аналіз термодинамічних властивостей газової суміші, що складається з CO, CO₂, O₂ та N₂, при нагріванні від 25°C до 1000°C. Розглянуто різні термодинамічні режими: ізобаричний процес зі змінною масою газу, ізохоричний процес зі змінним складом суміші та ізохоричний процес з постійною масою та змінним тиском. Для кожного режиму розраховано кількість теплоти, необхідної для нагрівання, та досліджено вплив зміни складу суміші на теплові ефекти. Результати демонструють значні відмінності між різними термодинамічними режимами та підтверджують важливість врахування зміни складу суміші при моделюванні реальних термодинамічних процесів.

Вивчення термодинамічних властивостей газових сумішей має велике значення для розуміння та оптимізації різноманітних технологічних процесів, зокрема в металургійній, хімічній та енергетичній галузях. Особливу увагу привертають процеси, пов'язані з нагріванням газових сумішей, оскільки вони супроводжуються значними тепловими ефектами та можуть включати зміну складу суміші.

Теплоємність газової суміші є ключовою характеристикою, що визначає кількість теплоти, необхідної для зміни її температури. Вона залежить від складу суміші, температури та термодинамічних умов процесу. Для багатьох газів теплоємність є нелінійною функцією температури та може бути виражена формулою:

$$c_p = a + bT + cT^{-2}$$

де $a$, $b$ та $c$ – емпіричні коефіцієнти, специфічні для кожного газу.

У реальних процесах склад газової суміші може змінюватися внаслідок хімічних реакцій, фазових переходів або змішування з іншими газами. Це призводить до зміни теплоємності суміші та впливає на теплові ефекти процесу. Крім того, термодинамічні умови (тиск, об'єм, кількість речовини) можуть змінюватися різними способами, що також впливає на кількість теплоти, необхідної для нагрівання.

У даному дослідженні проведено моделювання процесу нагрівання газової суміші в різних термодинамічних режимах з метою порівняння теплових ефектів та виявлення особливостей кожного режиму.

### Теплоємність ідеальних газів

Для ідеального газу розрізняють два типи теплоємності:

1. **Теплоємність при постійному тиску** ($c_p$) - кількість теплоти, необхідна для підвищення температури речовини на 1 К при постійному тиску.

2. **Теплоємність при постійному об'ємі** ($c_v$) - кількість теплоти, необхідна для підвищення температури речовини на 1 К при постійному об'ємі.

Зв'язок між цими величинами описується рівнянням Майєра:

$$c_p - c_v = R$$

де $R$ - універсальна газова стала (8,31446261815 Дж/(моль·К)).

Теплоємність багатьох газів залежить від температури. Експериментально встановлено, що ця залежність може бути апроксимована формулою:

$$c_p = a + bT + cT^{-2}$$

де коефіцієнти $a$, $b$ і $c$ визначаються експериментально для кожного газу.

### Теплоємність газових сумішей

Для сумішей ідеальних газів теплоємність розраховується як середньозважена величина теплоємностей компонентів:

$$c_{суміші} = \sum_{i=1}^n r_i c_i$$

де $r_i$ - мольна (об'ємна) частка $i$-го компонента, $c_i$ - його теплоємність, $n$ - кількість компонентів.

### Розрахунок кількості теплоти при нагріванні

Кількість теплоти, необхідна для нагрівання газу від температури $T_1$ до $T_2$, визначається як:

$$Q = \int_{T_1}^{T_2} nc_v dT$$

де $n$ - кількість молів газу, $c_v$ - теплоємність при постійному об'ємі.

При постійному тиску:

$$Q = \int_{T_1}^{T_2} nc_p dT$$

Для газової суміші з температурно-залежною теплоємністю інтеграл розраховується аналітично, якщо відома функціональна залежність $c_v(T)$ або $c_p(T)$, або чисельно, використовуючи методи чисельного інтегрування.

### Термодинамічні режими нагрівання

Розглянемо три термодинамічні режими нагрівання газової суміші:

1. **Ізобаричний процес зі сталою масою** - нагрівання при постійному тиску та змінному об'ємі.
2. **Ізохоричний процес зі змінною масою** - нагрівання при постійному об'ємі та постійному тиску з видаленням частини газу.
3. **Ізохоричний процес з постійною масою** - нагрівання при постійному об'ємі та змінному тиску.

Кожен з цих режимів характеризується своїми термодинамічними параметрами та вимагає різної кількості теплоти для нагрівання.

## Методологія дослідження

### Вихідні дані

Досліджувалась газова суміш наступного складу (початкові об'ємні частки):
- CO: 87,4%
- CO₂: 10,1%
- O₂: 1,6%
- N₂: 0,9%

Для першого випадку склад суміші залишався постійним, для другого та третього - змінювався за заданою залежністю.

Процес нагрівання розглядався в діапазоні температур від 25°C до 1000°C, розбитому на 11 кроків:
25, 114, 202, 291, 380, 468, 557, 645, 734, 823, 911, 1000 °C.

Об'єм суміші становив 100 м³, початковий тиск - 101325 Па (1 атм).

Для розрахунку теплоємності використовувались наступні коефіцієнти (в кал/(моль·К)):

| Газ | a | b·10³ | c·10⁵ |
|-----|-----|--------|---------|
| CO | 6,79 | 0,98 | -0,11 |
| CO₂ | 10,55 | 2,16 | -2,04 |
| O₂ | 7,16 | 1,0 | -0,40 |
| N₂ | 6,66 | 1,02 | - |

### 3.2. Методи розрахунку

Для проведення розрахунків було розроблено три комп'ютерні моделі, що відповідають різним термодинамічним режимам:

1. **Модель 1** - модель з постійним складом суміші, постійною масою та повним нагріванням від $T_1$ до $T_2$ в одному кроці.

2. **Модель 2** - модель зі змінним складом суміші, при якій нагрівання відбувається покроково, а на кожному кроці тиск підтримується постійним за рахунок зменшення кількості речовини.

3. **Модель 3** - модель зі змінним складом суміші, постійною масою та змінним тиском, при якій нагрівання відбувається покроково.

Для кожної моделі розраховувались:
- Кількість теплоти, необхідна для нагрівання (в аналітичній формі та чисельними методами)
- Зміна термодинамічних параметрів (температура, тиск, кількість речовини)
- Внесок кожного компонента в загальну теплоту нагрівання

Для чисельного інтегрування використовувались методи трапецій і Сімпсона.

## Результати та обговорення

### Модель 1: Нагрівання з постійним складом суміші

У першій моделі розглядався процес нагрівання газової суміші зі сталим складом від 25°C до 1000°C. Початкова кількість речовини становила 4087,40 моль.

Розрахунки показали, що для нагрівання даної кількості суміші необхідно 99635,48 кДж теплоти. Порівняння результатів аналітичного розрахунку та чисельних методів показало високу точність обчислень - відносна похибка становила менше 0,000003%.

Внесок компонентів у загальну теплоту нагрівання розподілився наступним чином:
- CO: 80863,76 кДж (81,2%)
- CO₂: 16386,55 кДж (16,4%)
- O₂: 1562,92 кДж (1,6%)
- N₂: 822,24 кДж (0,8%)

Такий розподіл відповідає початковому складу суміші та відносним теплоємностям компонентів. Монооксид вуглецю (CO) дає найбільший внесок через його високу частку в суміші (87,4%), незважаючи на порівняно низьку теплоємність.

### Модель 2: Нагрівання зі змінним складом при постійному тиску

У другій моделі розглядався процес покрокового нагрівання газової суміші зі змінним складом. На кожному кроці тиск підтримувався постійним (1 атм), що вимагало зменшення кількості речовини з підвищенням температури.

Початкова кількість речовини становила 4087,40 моль при 25°C, але зменшилась до 1029,14 моль при досягненні 1000°C. Загальна кількість теплоти, необхідна для нагрівання, склала 54324,68 кДж.

Аналіз поетапної зміни теплоти показав, що найбільша кількість теплоти (8069,48 кДж) поглинається на першому кроці (25-114°C), а потім поступово зменшується, досягаючи 3998,88 кДж на останньому кроці (911-1000°C). Це зменшення пов'язане з двома факторами:

1. Зменшення кількості речовини з підвищенням температури (від 4087,40 до 1029,14 моль)
2. Зміна складу суміші - поступове зменшення частки CO (від 87,4% до 8,8%) та збільшення частки CO₂ (від 10,1% до 91,0%)

Загальний внесок компонентів у теплоту нагрівання суттєво відрізняється від першої моделі:
- CO: 28800,52 кДж (53,0%)
- CO₂: 24803,62 кДж (45,7%)
- O₂: 455,12 кДж (0,8%)
- N₂: 265,42 кДж (0,5%)

Частка CO₂ суттєво збільшилась порівняно з першою моделлю через зміну складу суміші в процесі нагрівання.

### Модель 3: Нагрівання зі змінним складом при постійній масі

У третій моделі розглядався процес покрокового нагрівання газової суміші зі змінним складом, але з постійною кількістю речовини (4087,40 моль). При цьому тиск збільшувався з підвищенням температури від 1 атм при 25°C до 3,97 атм при 1000°C.

Загальна кількість теплоти, необхідна для нагрівання, склала 124451,15 кДж, що значно більше, ніж у попередніх моделях. Це пояснюється тим, що вся початкова кількість речовини нагрівається до кінцевої температури, без видалення частини газу.

Аналіз поетапної зміни теплоти показав протилежну тенденцію порівняно з другою моделлю: кількість теплоти, що поглинається на кожному кроці, збільшується від 8069,48 кДж на першому кроці до 15882,19 кДж на останньому. Це пов'язано з:

1. Постійною кількістю речовини протягом всього процесу
2. Збільшенням частки CO₂ (з вищою теплоємністю) в суміші
3. Загальним збільшенням теплоємності компонентів з підвищенням температури

Внесок компонентів у загальну теплоту нагрівання суттєво відрізняється від попередніх моделей:
- CO: 51695,21 кДж (41,5%)
- CO₂: 71514,24 кДж (57,5%)
- O₂: 775,89 кДж (0,6%)
- N₂: 465,81 кДж (0,4%)

Примітно, що в цій моделі CO₂ дає найбільший внесок у загальну теплоту, незважаючи на те, що його початкова частка становить лише 10,1%. Це пояснюється вищою теплоємністю CO₂ порівняно з іншими компонентами та збільшенням його частки в процесі нагрівання.

### Порівняльний аналіз моделей

Порівняння результатів трьох моделей виявляє суттєві відмінності у теплових ефектах різних термодинамічних режимів:

1. **Загальна кількість теплоти нагрівання**:
   - Модель 1 (постійний склад, повне нагрівання): 99635,48 кДж
   - Модель 2 (змінний склад, постійний тиск): 54324,68 кДж
   - Модель 3 (змінний склад, постійна маса): 124451,15 кДж

2. **Внесок CO₂ у загальну теплоту**:
   - Модель 1: 16,4%
   - Модель 2: 45,7%
   - Модель 3: 57,5%

3. **Тенденція зміни теплоти на кожному кроці**:
   - Модель 2: зменшення з підвищенням температури
   - Модель 3: збільшення з підвищенням температури

Ці відмінності підкреслюють важливість точного визначення термодинамічних умов процесу при моделюванні теплових ефектів.

## Висновки

На основі проведеного дослідження можна зробити наступні висновки:

1. Термодинамічний режим нагрівання газової суміші суттєво впливає на кількість теплоти, необхідної для підвищення температури. Найбільша кількість теплоти (124451,15 кДж) потрібна для нагрівання суміші при постійній масі та змінному тиску, а найменша (54324,68 кДж) - при постійному тиску зі зменшенням кількості речовини.

2. Зміна складу суміші в процесі нагрівання значно впливає на теплові ефекти. У випадку збільшення частки компонентів з вищою теплоємністю (CO₂) загальна теплота нагрівання збільшується порівняно з випадком постійного складу.

3. При постійному тиску та змінній масі теплота, що поглинається на кожному кроці нагрівання, зменшується з підвищенням температури через зменшення кількості речовини. Натомість, при постійній масі та змінному тиску спостерігається протилежна тенденція.

4. Теплоємність газів збільшується з ростом температури, що підтверджується розрахунками для всіх компонентів суміші. Найбільше зростання теплоємності спостерігається для CO₂.

5. Вплив зміни складу суміші на теплові ефекти може бути більш значущим, ніж вплив зміни теплоємності з температурою. Це підкреслює важливість врахування динаміки складу при моделюванні реальних термодинамічних процесів.

Проведене дослідження демонструє складність термодинамічних процесів у газових сумішах зі змінним складом та важливість точного визначення умов процесу для правильного розрахунку теплових ефектів. Отримані результати можуть бути використані для оптимізації енергоспоживання в технологічних процесах, пов'язаних з нагріванням газових сумішей, таких як металургійні процеси, спалювання палива та хімічні реакції.


```python

```
