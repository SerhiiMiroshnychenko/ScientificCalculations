"""
Завдання: Моделювання двовимірного розподілу температури в квадратній пластині
методом скінченних різниць з підвищеною температурою на нижній границі.

Граничні умови:
- Ліва сторона (x=0): T1 = 80°C
- Верхня сторона (y=max): T2 = 60°C 
- Права сторона (x=max): T3 = 45°C
- Нижня сторона (y=0): T4 = 120°C (підвищена температура)

Параметри моделювання:
- Розмір сітки: 10x10 точок
- Кількість ітерацій: 80
- Початкова температура всередині пластини: 35°C
"""

import numpy as np
import matplotlib.pyplot as plt

# Розміри сітки
xdim = 10
ydim = 10

# Граничні умови (температура на границях пластини)
T1 = 80  # ліва сторона
T2 = 60  # верхня сторона
T3 = 45  # права сторона
T4 = 120 # нижня сторона (підвищена температура)

# Початкова температура всередині пластини
T_guess = 35

# Створення масиву температур та встановлення початкових умов
T = np.zeros((xdim,ydim))
T.fill(T_guess)

# Встановлення граничних умов
T[0:xdim,0] = T1    # ліва сторона
T[0,1:ydim] = T2    # верхня сторона
T[0:xdim,ydim-1] = T3  # права сторона
T[xdim-1,1:ydim] = T4  # нижня сторона

# Ітераційний процес розрахунку методом скінченних різниць
# Збільшена кількість ітерацій для кращої збіжності
niter = 80
for n in range(0,niter):
    for i in range(1,xdim-1,1):
        for j in range(1,ydim-1,1):
            # Розрахунок нової температури в точці як середнє арифметичне
            # температур у сусідніх точках
            T[i,j] = 0.25*(T[i+1,j] + T[i-1,j] + T[i,j+1] + T[i,j-1])
print(T)

# Візуалізація результатів
plt.imshow(T, cmap='hot', interpolation='nearest')
plt.colorbar(label='Температура, °C')
plt.title('Розподіл температури в пластині\n(підвищена температура на нижній границі)')
plt.xlabel('X координата')
plt.ylabel('Y координата')
plt.show()

"""
Аналіз результатів:

1. У порівнянні з першою задачею, розподіл температури має більший градієнт
   через значно вищу температуру на нижній границі (120°C).
   
2. Найвища температура (120°C) спостерігається на нижній стороні пластини,
   що створює інтенсивний теплообмін з іншими частинами пластини.
   
3. Збільшення кількості ітерацій до 80 (порівняно з 25 у першій задачі)
   забезпечує кращу збіжність рішення при більших перепадах температури.

Висновки:
1. Метод скінченних різниць успішно справляється з моделюванням теплопередачі
   навіть при значних перепадах температури на границях.
   
2. Підвищена температура на нижній границі суттєво впливає на загальний
   розподіл температури в пластині, створюючи більш виражені градієнти.
   
3. Для задач з більшими перепадами температури потрібна більша кількість
   ітерацій для досягнення сталого стану.
"""
